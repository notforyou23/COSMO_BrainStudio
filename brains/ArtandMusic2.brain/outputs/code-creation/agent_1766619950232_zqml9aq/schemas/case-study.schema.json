{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.org/schemas/case-study.schema.json",
  "title": "Case Study",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_version", "id", "slug", "title", "summary", "created_at", "updated_at", "tags", "citations", "rights"],
  "properties": {
    "schema_version": {
      "type": "string",
      "description": "Schema version of this document.",
      "pattern": "^1\\.0\\.0$",
      "default": "1.0.0"
    },
    "id": {
      "type": "string",
      "description": "Stable identifier (opaque).",
      "pattern": "^[A-Za-z0-9][A-Za-z0-9._:-]{2,64}$"
    },
    "slug": {
      "type": "string",
      "description": "Human-readable identifier used in filenames/URLs.",
      "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$",
      "minLength": 3,
      "maxLength": 80
    },
    "title": { "type": "string", "minLength": 3, "maxLength": 200 },
    "subtitle": { "type": "string", "maxLength": 240 },
    "summary": { "type": "string", "minLength": 10, "maxLength": 2000 },
    "description": { "type": "string", "maxLength": 20000 },
    "status": {
      "type": "string",
      "enum": ["draft", "published", "archived"],
      "default": "draft"
    },
    "language": { "type": "string", "pattern": "^[a-z]{2}(-[A-Z]{2})?$", "default": "en" },
    "created_at": { "type": "string", "format": "date-time" },
    "updated_at": { "type": "string", "format": "date-time" },
    "published_at": { "type": "string", "format": "date-time" },
    "timeframe": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "start_date": { "type": "string", "format": "date" },
        "end_date": { "type": "string", "format": "date" },
        "notes": { "type": "string", "maxLength": 1000 }
      }
    },
    "organizations": {
      "type": "array",
      "description": "Organizations involved in the case study.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["name"],
        "properties": {
          "name": { "type": "string", "minLength": 2, "maxLength": 200 },
          "role": { "type": "string", "maxLength": 200 },
          "url": { "type": "string", "format": "uri" }
        }
      },
      "uniqueItems": false
    },
    "people": {
      "type": "array",
      "description": "People associated with the case study (authors, contributors, interviewees).",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["name", "role"],
        "properties": {
          "name": { "type": "string", "minLength": 2, "maxLength": 200 },
          "role": { "type": "string", "minLength": 2, "maxLength": 80 },
          "affiliation": { "type": "string", "maxLength": 200 },
          "email": { "type": "string", "format": "email" },
          "orcid": { "type": "string", "pattern": "^(?:https://orcid.org/)?\\d{4}-\\d{4}-\\d{4}-\\d{3}[\\dX]$" }
        }
      }
    },
    "tags": {
      "type": "array",
      "description": "Short, reusable keywords for search/filtering.",
      "minItems": 1,
      "maxItems": 64,
      "items": { "type": "string", "pattern": "^[a-z0-9]+(?:[-_./][a-z0-9]+)*$", "minLength": 2, "maxLength": 50 },
      "uniqueItems": true
    },
    "topics": {
      "type": "array",
      "description": "Higher-level topical categories.",
      "items": { "type": "string", "minLength": 2, "maxLength": 80 },
      "uniqueItems": true
    },
    "citations": {
      "type": "array",
      "description": "Sources referenced by this case study.",
      "items": { "$ref": "#/$defs/citation" },
      "default": []
    },
    "rights": { "$ref": "#/$defs/rights" },
    "links": {
      "type": "array",
      "description": "Relevant URLs (project pages, press, datasets, etc.).",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["url"],
        "properties": {
          "label": { "type": "string", "maxLength": 120 },
          "url": { "type": "string", "format": "uri" },
          "kind": { "type": "string", "enum": ["homepage", "paper", "dataset", "code", "press", "other"], "default": "other" }
        }
      }
    },
    "assets": {
      "type": "array",
      "description": "Associated local or remote assets (images, PDFs).",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["path", "kind"],
        "properties": {
          "kind": { "type": "string", "enum": ["image", "pdf", "data", "audio", "video", "other"] },
          "path": { "type": "string", "minLength": 1, "maxLength": 300 },
          "title": { "type": "string", "maxLength": 200 },
          "sha256": { "type": "string", "pattern": "^[a-f0-9]{64}$" }
        }
      }
    },
    "notes": { "type": "string", "maxLength": 20000 }
  },
  "$defs": {
    "citation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "title"],
      "properties": {
        "type": { "type": "string", "enum": ["web", "article", "book", "report", "dataset", "software", "interview", "other"], "default": "other" },
        "title": { "type": "string", "minLength": 2, "maxLength": 500 },
        "authors": { "type": "array", "items": { "type": "string", "minLength": 2, "maxLength": 200 }, "uniqueItems": false },
        "publisher": { "type": "string", "maxLength": 200 },
        "venue": { "type": "string", "maxLength": 200 },
        "year": { "type": "integer", "minimum": 1000, "maximum": 3000 },
        "date": { "type": "string", "format": "date" },
        "url": { "type": "string", "format": "uri" },
        "doi": { "type": "string", "pattern": "^10\\.\\d{4,9}/[-._;()/:A-Z0-9]+$", "description": "DOI (case-insensitive); consumers may upper-case for validation." },
        "isbn": { "type": "string", "pattern": "^(?:97[89])?\\d{9}[\\dX]$" },
        "accessed_at": { "type": "string", "format": "date" },
        "license": { "type": "string", "maxLength": 200 },
        "notes": { "type": "string", "maxLength": 2000 }
      }
    },
    "rights": {
      "type": "object",
      "additionalProperties": false,
      "required": ["copyright_holder", "license", "usage"],
      "properties": {
        "copyright_holder": { "type": "string", "minLength": 2, "maxLength": 200 },
        "license": { "type": "string", "minLength": 2, "maxLength": 100, "description": "SPDX identifier or human-readable license name." },
        "license_url": { "type": "string", "format": "uri" },
        "usage": { "type": "string", "enum": ["public-domain", "open", "restricted", "unknown"], "default": "unknown" },
        "permissions": { "type": "string", "maxLength": 2000 },
        "attribution": { "type": "string", "maxLength": 2000 }
      }
    }
  }
}
