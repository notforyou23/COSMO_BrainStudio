{
  "content": "FILE_EXPORT:{\"path\":\"scripts/issue_on_failure.py\",\"size\":6861,\"encoding\":\"base64\",\"sha256\":\"e72d4881c388a46b0f9cdbfcca96d399548712a874c8385fbc05f5d17b5f6d20\",\"content\":\"IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgYXJncGFyc2UKaW1wb3J0IGhhc2hsaWIKaW1wb3J0IGpzb24KaW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIERpY3QsIExpc3QsIE9wdGlvbmFsLCBUdXBsZQoKaW1wb3J0IHJlcXVlc3RzCgpMQUJFTCA9ICJlMmUtZmFpbHVyZSIKVUEgPSAiaXNzdWVfb25fZmFpbHVyZS5weSIKRklOR0VSUFJJTlRfUkUgPSByZS5jb21waWxlKHIiPCEtLVxzKmZpbmdlcnByaW50OihbYS1mMC05XXs4LDQwfSlccyotLT4iKQoKZGVmIF9qZ2V0KGQ6IEFueSwgKmtleXM6IHN0ciwgZGVmYXVsdD1Ob25lKToKICAgIGZvciBrIGluIGtleXM6CiAgICAgICAgaWYgaXNpbnN0YW5jZShkLCBkaWN0KSBhbmQgayBpbiBkOgogICAgICAgICAgICByZXR1cm4gZFtrXQogICAgcmV0dXJuIGRlZmF1bHQKCmRlZiBsb2FkX3N1bW1hcnkocGF0aDogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHAgPSBvcy5wYXRoLmFic3BhdGgocGF0aCkKICAgIHdpdGggb3BlbihwLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgZGF0YSA9IGpzb24ubG9hZChmKQogICAgaWYgaXNpbnN0YW5jZShkYXRhLCBsaXN0KToKICAgICAgICBkYXRhID0geyJmYWlsdXJlcyI6IGRhdGF9CiAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBkaWN0KToKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KCJmYWlsdXJlIHN1bW1hcnkgbXVzdCBiZSBhIEpTT04gb2JqZWN0IG9yIGxpc3QiKQogICAgZmFpbHVyZXMgPSBkYXRhLmdldCgiZmFpbHVyZXMiKQogICAgaWYgZmFpbHVyZXMgaXMgTm9uZSBhbmQgInN0YWdlcyIgaW4gZGF0YToKICAgICAgICBmYWlsdXJlcyA9IFtzIGZvciBzIGluIGRhdGEuZ2V0KCJzdGFnZXMiLCBbXSkgaWYgcy5nZXQoInN0YXR1cyIpID09ICJmYWlsZWQiXQogICAgICAgIGRhdGFbImZhaWx1cmVzIl0gPSBmYWlsdXJlcwogICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0YS5nZXQoImZhaWx1cmVzIiwgW10pLCBsaXN0KToKICAgICAgICBkYXRhWyJmYWlsdXJlcyJdID0gW10KICAgIGRhdGFbIl9wYXRoIl0gPSBwCiAgICByZXR1cm4gZGF0YQoKZGVmIG5vcm1hbGl6ZV9mYWlsdXJlKGY6IERpY3Rbc3RyLCBBbnldKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHN0YWdlID0gc3RyKF9qZ2V0KGYsICJzdGFnZSIsICJuYW1lIiwgZGVmYXVsdD0idW5rbm93biIpKQogICAgbXNnID0gc3RyKF9qZ2V0KGYsICJtZXNzYWdlIiwgImVycm9yIiwgInN1bW1hcnkiLCBkZWZhdWx0PSIobm8gbWVzc2FnZSkiKSkKICAgIGNtZCA9IF9qZ2V0KGYsICJjb21tYW5kIiwgImNtZCIsIGRlZmF1bHQ9Tm9uZSkKICAgIGxvZyA9IF9qZ2V0KGYsICJsb2dfcGF0aCIsICJsb2ciLCAic3RkZXJyX3BhdGgiLCBkZWZhdWx0PU5vbmUpCiAgICByZXR1cm4geyJzdGFnZSI6IHN0YWdlLCAibWVzc2FnZSI6IG1zZywgImNvbW1hbmQiOiBjbWQsICJsb2dfcGF0aCI6IGxvZ30KCmRlZiBmaW5nZXJwcmludChmOiBEaWN0W3N0ciwgQW55XSkgLT4gc3RyOgogICAgc3RhZ2UgPSBmLmdldCgic3RhZ2UiLCAidW5rbm93biIpCiAgICBmaXJzdCA9IChmLmdldCgibWVzc2FnZSIpIG9yICIiKS5zdHJpcCgpLnNwbGl0bGluZXMoKVs6MV0KICAgIHNpZyA9IGYie3N0YWdlfVxue2ZpcnN0WzBdIGlmIGZpcnN0IGVsc2UgJyd9Ii5lbmNvZGUoInV0Zi04IiwgImlnbm9yZSIpCiAgICByZXR1cm4gaGFzaGxpYi5zaGExKHNpZykuaGV4ZGlnZXN0KClbOjEyXQoKZGVmIHJlcHJvX3N0ZXBzKHN1bW1hcnk6IERpY3Rbc3RyLCBBbnldLCBmOiBEaWN0W3N0ciwgQW55XSkgLT4gc3RyOgogICAgc2hhID0gX2pnZXQoc3VtbWFyeSwgInNoYSIsICJnaXRfc2hhIiwgZGVmYXVsdD1vcy5nZXRlbnYoIkdJVEhVQl9TSEEiLCAiIikpCiAgICBydW5fdXJsID0gX2pnZXQoc3VtbWFyeSwgInJ1bl91cmwiLCBkZWZhdWx0PW9zLmdldGVudigiR0lUSFVCX1NFUlZFUl9VUkwiLCAiIikgKyAiLyIgKyBvcy5nZXRlbnYoIkdJVEhVQl9SRVBPU0lUT1JZIiwgIiIpICsgIi9hY3Rpb25zL3J1bnMvIiArIG9zLmdldGVudigiR0lUSFVCX1JVTl9JRCIsICIiKSkKICAgIGNtZCA9IGYuZ2V0KCJjb21tYW5kIikgb3IgIm1ha2UgZTJlIgogICAgbGluZXMgPSBbCiAgICAgICAgIiMjIyBNaW5pbWFsIHJlcHJvZHVjdGlvbiIsCiAgICAgICAgIjEuIENoZWNrIG91dCB0aGUgZmFpbGluZyBjb21taXQ6IiwKICAgICAgICBmIiAgIC0gYHtzaGF9YCIgaWYgc2hhIGVsc2UgIiAgIC0gKHVua25vd24gU0hBKSIsCiAgICAgICAgZiIyLiBSdW46IGB7Y21kfWAiLAogICAgXQogICAgaWYgZi5nZXQoImxvZ19wYXRoIik6CiAgICAgICAgbGluZXMuYXBwZW5kKGYiMy4gSW5zcGVjdCBsb2dzOiBge2ZbJ2xvZ19wYXRoJ119YCAoc2VlIENJIGFydGlmYWN0cyBpZiBhdmFpbGFibGUpIikKICAgIGlmIHJ1bl91cmwgYW5kIHJ1bl91cmwuc3RyaXAoIi8iKToKICAgICAgICBsaW5lcy5hcHBlbmQoIiIpCiAgICAgICAgbGluZXMuYXBwZW5kKGYiQ0kgcnVuOiB7cnVuX3VybH0iKQogICAgcmV0dXJuICJcbiIuam9pbihsaW5lcykKCmRlZiBnaF9yZXF1ZXN0KG1ldGhvZDogc3RyLCB1cmw6IHN0ciwgdG9rZW46IHN0ciwgKiprd2FyZ3MpOgogICAgaGVhZGVycyA9IGt3YXJncy5wb3AoImhlYWRlcnMiLCB7fSkKICAgIGhlYWRlcnMudXBkYXRlKHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGYidG9rZW4ge3Rva2VufSIsCiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi92bmQuZ2l0aHViK2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogVUEsCiAgICB9KQogICAgZm9yIF8gaW4gcmFuZ2UoMyk6CiAgICAgICAgciA9IHJlcXVlc3RzLnJlcXVlc3QobWV0aG9kLCB1cmwsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD0zMCwgKiprd2FyZ3MpCiAgICAgICAgaWYgci5zdGF0dXNfY29kZSBpbiAoNDI5LCA1MDAsIDUwMiwgNTAzLCA1MDQpOgogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmV0dXJuIHIKICAgIHJldHVybiByCgpkZWYgZmluZF9leGlzdGluZ19pc3N1ZShyZXBvOiBzdHIsIHRva2VuOiBzdHIsIGZwOiBzdHIpIC0+IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXToKICAgIHEgPSBmInJlcG86e3JlcG99IGlzOmlzc3VlIGlzOm9wZW4gbGFiZWw6e0xBQkVMfSBpbjpib2R5IGZpbmdlcnByaW50OntmcH0iCiAgICB1cmwgPSBmImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vc2VhcmNoL2lzc3Vlcz9xPXtyZXF1ZXN0cy51dGlscy5xdW90ZShxKX0iCiAgICByID0gZ2hfcmVxdWVzdCgiR0VUIiwgdXJsLCB0b2tlbikKICAgIGlmIHIuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgIHJldHVybiBOb25lCiAgICBpdGVtcyA9IHIuanNvbigpLmdldCgiaXRlbXMiLCBbXSkgb3IgW10KICAgIHJldHVybiBpdGVtc1swXSBpZiBpdGVtcyBlbHNlIE5vbmUKCmRlZiBjcmVhdGVfaXNzdWUocmVwbzogc3RyLCB0b2tlbjogc3RyLCB0aXRsZTogc3RyLCBib2R5OiBzdHIpIC0+IFR1cGxlW2ludCwgc3RyXToKICAgIHVybCA9IGYiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy97cmVwb30vaXNzdWVzIgogICAgcGF5bG9hZCA9IHsidGl0bGUiOiB0aXRsZSwgImJvZHkiOiBib2R5LCAibGFiZWxzIjogW0xBQkVMXX0KICAgIHIgPSBnaF9yZXF1ZXN0KCJQT1NUIiwgdXJsLCB0b2tlbiwganNvbj1wYXlsb2FkKQogICAgaWYgci5zdGF0dXNfY29kZSBub3QgaW4gKDIwMCwgMjAxKToKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KGYiZmFpbGVkIHRvIGNyZWF0ZSBpc3N1ZToge3Iuc3RhdHVzX2NvZGV9IHtyLnRleHRbOjIwMF19IikKICAgIGogPSByLmpzb24oKQogICAgcmV0dXJuIGludChqWyJudW1iZXIiXSksIGouZ2V0KCJodG1sX3VybCIsICIiKQoKZGVmIGNvbW1lbnRfaXNzdWUocmVwbzogc3RyLCB0b2tlbjogc3RyLCBudW1iZXI6IGludCwgYm9keTogc3RyKSAtPiBOb25lOgogICAgdXJsID0gZiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3tyZXBvfS9pc3N1ZXMve251bWJlcn0vY29tbWVudHMiCiAgICByID0gZ2hfcmVxdWVzdCgiUE9TVCIsIHVybCwgdG9rZW4sIGpzb249eyJib2R5IjogYm9keX0pCiAgICBpZiByLnN0YXR1c19jb2RlIG5vdCBpbiAoMjAwLCAyMDEpOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJmYWlsZWQgdG8gY29tbWVudDoge3Iuc3RhdHVzX2NvZGV9IHtyLnRleHRbOjIwMF19IikKZGVmIGJ1aWxkX2lzc3VlKHRpdGxlX3ByZWZpeDogc3RyLCBzdW1tYXJ5OiBEaWN0W3N0ciwgQW55XSwgZjogRGljdFtzdHIsIEFueV0pIC0+IFR1cGxlW3N0ciwgc3RyLCBzdHJdOgogICAgbmYgPSBub3JtYWxpemVfZmFpbHVyZShmKQogICAgZnAgPSBmaW5nZXJwcmludChuZikKICAgIG1zZyA9IChuZlsibWVzc2FnZSJdIG9yICIiKS5zdHJpcCgpCiAgICBzaG9ydCA9IChtc2cuc3BsaXRsaW5lcygpWzoxXSBvciBbIihubyBtZXNzYWdlKSJdKVswXQogICAgc2hvcnQgPSBzaG9ydFs6MTIwXQogICAgdGl0bGUgPSBmInt0aXRsZV9wcmVmaXh9e25mWydzdGFnZSddfToge3Nob3J0fSIKICAgIGJvZHkgPSAiXG4iLmpvaW4oWwogICAgICAgIGYiPCEtLSBmaW5nZXJwcmludDp7ZnB9IC0tPiIsCiAgICAgICAgIiMjIyBGYWlsdXJlIiwKICAgICAgICBmIi0gU3RhZ2U6IGB7bmZbJ3N0YWdlJ119YCIsCiAgICAgICAgZiItIE1lc3NhZ2U6XG5cbmBgYHRleHRcbnttc2cuc3RyaXAoKX1cbmBgYCIgaWYgbXNnIGVsc2UgIi0gTWVzc2FnZTogKG5vbmUpIiwKICAgICAgICAiIiwKICAgICAgICByZXByb19zdGVwcyhzdW1tYXJ5LCBuZiksCiAgICAgICAgIiIsCiAgICAgICAgIiMjIyBDb250ZXh0IiwKICAgICAgICBmIi0gU3VtbWFyeSBmaWxlOiBge3N1bW1hcnkuZ2V0KCdfcGF0aCcsJycpfWAiLAogICAgICAgIGYiLSBXb3JrZmxvdzogYHtvcy5nZXRlbnYoJ0dJVEhVQl9XT1JLRkxPVycsJycpfWAgUnVuIElEOiBge29zLmdldGVudignR0lUSFVCX1JVTl9JRCcsJycpfWAiLAogICAgXSkuc3RyaXAoKSArICJcbiIKICAgIHJldHVybiBmcCwgdGl0bGUsIGJvZHkKCmRlZiBtYWluKGFyZ3Y6IExpc3Rbc3RyXSkgLT4gaW50OgogICAgYXAgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0iT3BlbiBvciB1cGRhdGUgR2l0SHViIGlzc3VlcyBmb3IgZTJlIGZhaWx1cmVzLiIpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tc3VtbWFyeSIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJGQUlMVVJFX1NVTU1BUlkiLCAiYXJ0aWZhY3RzL2ZhaWx1cmVfc3VtbWFyeS5qc29uIikpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tcmVwbyIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJHSVRIVUJfUkVQT1NJVE9SWSIsICIiKSkKICAgIGFwLmFkZF9hcmd1bWVudCgiLS10b2tlbiIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJHSVRIVUJfVE9LRU4iLCAiIikpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tdGl0bGUtcHJlZml4IiwgZGVmYXVsdD0iW2UyZV0gIikKICAgIGFyZ3MgPSBhcC5wYXJzZV9hcmdzKGFyZ3YpCgogICAgaWYgbm90IGFyZ3MucmVwbzoKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KCJHSVRIVUJfUkVQT1NJVE9SWSBvciAtLXJlcG8gaXMgcmVxdWlyZWQgKGUuZy4gb3duZXIvcmVwbykiKQogICAgaWYgbm90IGFyZ3MudG9rZW46CiAgICAgICAgcmFpc2UgU3lzdGVtRXhpdCgiR0lUSFVCX1RPS0VOIG9yIC0tdG9rZW4gaXMgcmVxdWlyZWQiKQoKICAgIHN1bW1hcnkgPSBsb2FkX3N1bW1hcnkoYXJncy5zdW1tYXJ5KQogICAgZmFpbHVyZXMgPSBzdW1tYXJ5LmdldCgiZmFpbHVyZXMiLCBbXSkgb3IgW10KICAgIGlmIG5vdCBmYWlsdXJlczoKICAgICAgICBwcmludCgiTm8gZmFpbHVyZXMgZm91bmQ7IG5vdGhpbmcgdG8gZG8uIikKICAgICAgICByZXR1cm4gMAoKICAgIGNyZWF0ZWQgPSB1cGRhdGVkID0gMAogICAgZm9yIGYgaW4gZmFpbHVyZXM6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZiwgZGljdCk6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZnAsIHRpdGxlLCBib2R5ID0gYnVpbGRfaXNzdWUoYXJncy50aXRsZV9wcmVmaXgsIHN1bW1hcnksIGYpCiAgICAgICAgZXhpc3RpbmcgPSBmaW5kX2V4aXN0aW5nX2lzc3VlKGFyZ3MucmVwbywgYXJncy50b2tlbiwgZnApCiAgICAgICAgaWYgZXhpc3RpbmcgYW5kIGV4aXN0aW5nLmdldCgibnVtYmVyIik6CiAgICAgICAgICAgIG51bSA9IGludChleGlzdGluZ1sibnVtYmVyIl0pCiAgICAgICAgICAgIGNvbW1lbnQgPSAiXG4iLmpvaW4oWwogICAgICAgICAgICAgICAgZiJSZXByb2R1Y2VkIGluIGEgbmV3IENJIHJ1bi4iLAogICAgICAgICAgICAgICAgcmVwcm9fc3RlcHMoc3VtbWFyeSwgbm9ybWFsaXplX2ZhaWx1cmUoZikpLAogICAgICAgICAgICBdKQogICAgICAgICAgICBjb21tZW50X2lzc3VlKGFyZ3MucmVwbywgYXJncy50b2tlbiwgbnVtLCBjb21tZW50KQogICAgICAgICAgICB1cGRhdGVkICs9IDEKICAgICAgICAgICAgcHJpbnQoZiJVUERBVEVEX0lTU1VFOntudW19IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBudW0sIHVybCA9IGNyZWF0ZV9pc3N1ZShhcmdzLnJlcG8sIGFyZ3MudG9rZW4sIHRpdGxlLCBib2R5KQogICAgICAgICAgICBjcmVhdGVkICs9IDEKICAgICAgICAgICAgcHJpbnQoZiJDUkVBVEVEX0lTU1VFOntudW19Ont1cmx9IikKICAgIHByaW50KGYiU1RBVFM6Y3JlYXRlZD17Y3JlYXRlZH0gdXBkYXRlZD17dXBkYXRlZH0gdG90YWw9e2NyZWF0ZWQrdXBkYXRlZH0iKQogICAgcmV0dXJuIDAKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICByYWlzZSBTeXN0ZW1FeGl0KG1haW4oc3lzLmFyZ3ZbMTpdKSkK\"}\nDIR_STATE:[\"scripts/README_e2e.md\",\"scripts/artifacts.py\",\"scripts/e2e.py\",\"scripts/issue_on_failure.py\",\"scripts/repro_steps.py\",\"scripts/requirements-ci.txt\"]",
  "reasoning": "",
  "responseId": "resp_0bbb72ff98d44aa2006949c0781ec48197bc04c9e987d9fd4f",
  "model": "gpt-5.2-2025-12-11",
  "usage": {
    "input_tokens": 7092,
    "input_tokens_details": {
      "cached_tokens": 0
    },
    "output_tokens": 6055,
    "output_tokens_details": {
      "reasoning_tokens": 28
    },
    "total_tokens": 13147
  },
  "hadError": false,
  "errorType": null,
  "webSearchSources": [],
  "citations": [],
  "output": [
    {
      "id": "rs_0bbb72ff98d44aa2006949c078c0688197bf3db47cec554f8f",
      "type": "reasoning",
      "summary": []
    },
    {
      "id": "ci_0bbb72ff98d44aa2006949c0797a88819784da660a201d66ef",
      "type": "code_interpreter_call",
      "status": "completed",
      "code": "from pathlib import Path\nimport base64, json, hashlib, gzip\n\ntarget_path = Path('/mnt/data').joinpath('scripts/issue_on_failure.py')\nassert target_path.is_file(), 'Expected scripts/issue_on_failure.py to exist before export'\ndata = target_path.read_bytes()\npayload = {\n  'path': 'scripts/issue_on_failure.py',\n  'size': len(data),\n  'encoding': 'base64',\n  'sha256': hashlib.sha256(data).hexdigest(),\n  'content': None\n}\nif len(data) > 20000:\n    compressed = gzip.compress(data)\n    payload['encoding'] = 'gzip+base64'\n    payload['content'] = base64.b64encode(compressed).decode('ascii')\nelse:\n    payload['content'] = base64.b64encode(data).decode('ascii')\n\nprint('FILE_EXPORT:' + json.dumps(payload, separators=(',', ':')))\nprint('DIR_STATE:' + json.dumps(sorted(str(p.relative_to(Path(\"/mnt/data\"))) for p in target_path.parent.glob('*') if p.is_file())))",
      "container_id": "cntr_6949be2f5f848190a4b8106bfdfa0c4704094e1617bbf644",
      "outputs": [
        {
          "type": "logs",
          "logs": "FILE_EXPORT:{\"path\":\"scripts/issue_on_failure.py\",\"size\":6861,\"encoding\":\"base64\",\"sha256\":\"e72d4881c388a46b0f9cdbfcca96d399548712a874c8385fbc05f5d17b5f6d20\",\"content\":\"IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgYXJncGFyc2UKaW1wb3J0IGhhc2hsaWIKaW1wb3J0IGpzb24KaW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIERpY3QsIExpc3QsIE9wdGlvbmFsLCBUdXBsZQoKaW1wb3J0IHJlcXVlc3RzCgpMQUJFTCA9ICJlMmUtZmFpbHVyZSIKVUEgPSAiaXNzdWVfb25fZmFpbHVyZS5weSIKRklOR0VSUFJJTlRfUkUgPSByZS5jb21waWxlKHIiPCEtLVxzKmZpbmdlcnByaW50OihbYS1mMC05XXs4LDQwfSlccyotLT4iKQoKZGVmIF9qZ2V0KGQ6IEFueSwgKmtleXM6IHN0ciwgZGVmYXVsdD1Ob25lKToKICAgIGZvciBrIGluIGtleXM6CiAgICAgICAgaWYgaXNpbnN0YW5jZShkLCBkaWN0KSBhbmQgayBpbiBkOgogICAgICAgICAgICByZXR1cm4gZFtrXQogICAgcmV0dXJuIGRlZmF1bHQKCmRlZiBsb2FkX3N1bW1hcnkocGF0aDogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHAgPSBvcy5wYXRoLmFic3BhdGgocGF0aCkKICAgIHdpdGggb3BlbihwLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgZGF0YSA9IGpzb24ubG9hZChmKQogICAgaWYgaXNpbnN0YW5jZShkYXRhLCBsaXN0KToKICAgICAgICBkYXRhID0geyJmYWlsdXJlcyI6IGRhdGF9CiAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBkaWN0KToKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KCJmYWlsdXJlIHN1bW1hcnkgbXVzdCBiZSBhIEpTT04gb2JqZWN0IG9yIGxpc3QiKQogICAgZmFpbHVyZXMgPSBkYXRhLmdldCgiZmFpbHVyZXMiKQogICAgaWYgZmFpbHVyZXMgaXMgTm9uZSBhbmQgInN0YWdlcyIgaW4gZGF0YToKICAgICAgICBmYWlsdXJlcyA9IFtzIGZvciBzIGluIGRhdGEuZ2V0KCJzdGFnZXMiLCBbXSkgaWYgcy5nZXQoInN0YXR1cyIpID09ICJmYWlsZWQiXQogICAgICAgIGRhdGFbImZhaWx1cmVzIl0gPSBmYWlsdXJlcwogICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0YS5nZXQoImZhaWx1cmVzIiwgW10pLCBsaXN0KToKICAgICAgICBkYXRhWyJmYWlsdXJlcyJdID0gW10KICAgIGRhdGFbIl9wYXRoIl0gPSBwCiAgICByZXR1cm4gZGF0YQoKZGVmIG5vcm1hbGl6ZV9mYWlsdXJlKGY6IERpY3Rbc3RyLCBBbnldKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHN0YWdlID0gc3RyKF9qZ2V0KGYsICJzdGFnZSIsICJuYW1lIiwgZGVmYXVsdD0idW5rbm93biIpKQogICAgbXNnID0gc3RyKF9qZ2V0KGYsICJtZXNzYWdlIiwgImVycm9yIiwgInN1bW1hcnkiLCBkZWZhdWx0PSIobm8gbWVzc2FnZSkiKSkKICAgIGNtZCA9IF9qZ2V0KGYsICJjb21tYW5kIiwgImNtZCIsIGRlZmF1bHQ9Tm9uZSkKICAgIGxvZyA9IF9qZ2V0KGYsICJsb2dfcGF0aCIsICJsb2ciLCAic3RkZXJyX3BhdGgiLCBkZWZhdWx0PU5vbmUpCiAgICByZXR1cm4geyJzdGFnZSI6IHN0YWdlLCAibWVzc2FnZSI6IG1zZywgImNvbW1hbmQiOiBjbWQsICJsb2dfcGF0aCI6IGxvZ30KCmRlZiBmaW5nZXJwcmludChmOiBEaWN0W3N0ciwgQW55XSkgLT4gc3RyOgogICAgc3RhZ2UgPSBmLmdldCgic3RhZ2UiLCAidW5rbm93biIpCiAgICBmaXJzdCA9IChmLmdldCgibWVzc2FnZSIpIG9yICIiKS5zdHJpcCgpLnNwbGl0bGluZXMoKVs6MV0KICAgIHNpZyA9IGYie3N0YWdlfVxue2ZpcnN0WzBdIGlmIGZpcnN0IGVsc2UgJyd9Ii5lbmNvZGUoInV0Zi04IiwgImlnbm9yZSIpCiAgICByZXR1cm4gaGFzaGxpYi5zaGExKHNpZykuaGV4ZGlnZXN0KClbOjEyXQoKZGVmIHJlcHJvX3N0ZXBzKHN1bW1hcnk6IERpY3Rbc3RyLCBBbnldLCBmOiBEaWN0W3N0ciwgQW55XSkgLT4gc3RyOgogICAgc2hhID0gX2pnZXQoc3VtbWFyeSwgInNoYSIsICJnaXRfc2hhIiwgZGVmYXVsdD1vcy5nZXRlbnYoIkdJVEhVQl9TSEEiLCAiIikpCiAgICBydW5fdXJsID0gX2pnZXQoc3VtbWFyeSwgInJ1bl91cmwiLCBkZWZhdWx0PW9zLmdldGVudigiR0lUSFVCX1NFUlZFUl9VUkwiLCAiIikgKyAiLyIgKyBvcy5nZXRlbnYoIkdJVEhVQl9SRVBPU0lUT1JZIiwgIiIpICsgIi9hY3Rpb25zL3J1bnMvIiArIG9zLmdldGVudigiR0lUSFVCX1JVTl9JRCIsICIiKSkKICAgIGNtZCA9IGYuZ2V0KCJjb21tYW5kIikgb3IgIm1ha2UgZTJlIgogICAgbGluZXMgPSBbCiAgICAgICAgIiMjIyBNaW5pbWFsIHJlcHJvZHVjdGlvbiIsCiAgICAgICAgIjEuIENoZWNrIG91dCB0aGUgZmFpbGluZyBjb21taXQ6IiwKICAgICAgICBmIiAgIC0gYHtzaGF9YCIgaWYgc2hhIGVsc2UgIiAgIC0gKHVua25vd24gU0hBKSIsCiAgICAgICAgZiIyLiBSdW46IGB7Y21kfWAiLAogICAgXQogICAgaWYgZi5nZXQoImxvZ19wYXRoIik6CiAgICAgICAgbGluZXMuYXBwZW5kKGYiMy4gSW5zcGVjdCBsb2dzOiBge2ZbJ2xvZ19wYXRoJ119YCAoc2VlIENJIGFydGlmYWN0cyBpZiBhdmFpbGFibGUpIikKICAgIGlmIHJ1bl91cmwgYW5kIHJ1bl91cmwuc3RyaXAoIi8iKToKICAgICAgICBsaW5lcy5hcHBlbmQoIiIpCiAgICAgICAgbGluZXMuYXBwZW5kKGYiQ0kgcnVuOiB7cnVuX3VybH0iKQogICAgcmV0dXJuICJcbiIuam9pbihsaW5lcykKCmRlZiBnaF9yZXF1ZXN0KG1ldGhvZDogc3RyLCB1cmw6IHN0ciwgdG9rZW46IHN0ciwgKiprd2FyZ3MpOgogICAgaGVhZGVycyA9IGt3YXJncy5wb3AoImhlYWRlcnMiLCB7fSkKICAgIGhlYWRlcnMudXBkYXRlKHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGYidG9rZW4ge3Rva2VufSIsCiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi92bmQuZ2l0aHViK2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogVUEsCiAgICB9KQogICAgZm9yIF8gaW4gcmFuZ2UoMyk6CiAgICAgICAgciA9IHJlcXVlc3RzLnJlcXVlc3QobWV0aG9kLCB1cmwsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD0zMCwgKiprd2FyZ3MpCiAgICAgICAgaWYgci5zdGF0dXNfY29kZSBpbiAoNDI5LCA1MDAsIDUwMiwgNTAzLCA1MDQpOgogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmV0dXJuIHIKICAgIHJldHVybiByCgpkZWYgZmluZF9leGlzdGluZ19pc3N1ZShyZXBvOiBzdHIsIHRva2VuOiBzdHIsIGZwOiBzdHIpIC0+IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXToKICAgIHEgPSBmInJlcG86e3JlcG99IGlzOmlzc3VlIGlzOm9wZW4gbGFiZWw6e0xBQkVMfSBpbjpib2R5IGZpbmdlcnByaW50OntmcH0iCiAgICB1cmwgPSBmImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vc2VhcmNoL2lzc3Vlcz9xPXtyZXF1ZXN0cy51dGlscy5xdW90ZShxKX0iCiAgICByID0gZ2hfcmVxdWVzdCgiR0VUIiwgdXJsLCB0b2tlbikKICAgIGlmIHIuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgIHJldHVybiBOb25lCiAgICBpdGVtcyA9IHIuanNvbigpLmdldCgiaXRlbXMiLCBbXSkgb3IgW10KICAgIHJldHVybiBpdGVtc1swXSBpZiBpdGVtcyBlbHNlIE5vbmUKCmRlZiBjcmVhdGVfaXNzdWUocmVwbzogc3RyLCB0b2tlbjogc3RyLCB0aXRsZTogc3RyLCBib2R5OiBzdHIpIC0+IFR1cGxlW2ludCwgc3RyXToKICAgIHVybCA9IGYiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy97cmVwb30vaXNzdWVzIgogICAgcGF5bG9hZCA9IHsidGl0bGUiOiB0aXRsZSwgImJvZHkiOiBib2R5LCAibGFiZWxzIjogW0xBQkVMXX0KICAgIHIgPSBnaF9yZXF1ZXN0KCJQT1NUIiwgdXJsLCB0b2tlbiwganNvbj1wYXlsb2FkKQogICAgaWYgci5zdGF0dXNfY29kZSBub3QgaW4gKDIwMCwgMjAxKToKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KGYiZmFpbGVkIHRvIGNyZWF0ZSBpc3N1ZToge3Iuc3RhdHVzX2NvZGV9IHtyLnRleHRbOjIwMF19IikKICAgIGogPSByLmpzb24oKQogICAgcmV0dXJuIGludChqWyJudW1iZXIiXSksIGouZ2V0KCJodG1sX3VybCIsICIiKQoKZGVmIGNvbW1lbnRfaXNzdWUocmVwbzogc3RyLCB0b2tlbjogc3RyLCBudW1iZXI6IGludCwgYm9keTogc3RyKSAtPiBOb25lOgogICAgdXJsID0gZiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3tyZXBvfS9pc3N1ZXMve251bWJlcn0vY29tbWVudHMiCiAgICByID0gZ2hfcmVxdWVzdCgiUE9TVCIsIHVybCwgdG9rZW4sIGpzb249eyJib2R5IjogYm9keX0pCiAgICBpZiByLnN0YXR1c19jb2RlIG5vdCBpbiAoMjAwLCAyMDEpOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJmYWlsZWQgdG8gY29tbWVudDoge3Iuc3RhdHVzX2NvZGV9IHtyLnRleHRbOjIwMF19IikKZGVmIGJ1aWxkX2lzc3VlKHRpdGxlX3ByZWZpeDogc3RyLCBzdW1tYXJ5OiBEaWN0W3N0ciwgQW55XSwgZjogRGljdFtzdHIsIEFueV0pIC0+IFR1cGxlW3N0ciwgc3RyLCBzdHJdOgogICAgbmYgPSBub3JtYWxpemVfZmFpbHVyZShmKQogICAgZnAgPSBmaW5nZXJwcmludChuZikKICAgIG1zZyA9IChuZlsibWVzc2FnZSJdIG9yICIiKS5zdHJpcCgpCiAgICBzaG9ydCA9IChtc2cuc3BsaXRsaW5lcygpWzoxXSBvciBbIihubyBtZXNzYWdlKSJdKVswXQogICAgc2hvcnQgPSBzaG9ydFs6MTIwXQogICAgdGl0bGUgPSBmInt0aXRsZV9wcmVmaXh9e25mWydzdGFnZSddfToge3Nob3J0fSIKICAgIGJvZHkgPSAiXG4iLmpvaW4oWwogICAgICAgIGYiPCEtLSBmaW5nZXJwcmludDp7ZnB9IC0tPiIsCiAgICAgICAgIiMjIyBGYWlsdXJlIiwKICAgICAgICBmIi0gU3RhZ2U6IGB7bmZbJ3N0YWdlJ119YCIsCiAgICAgICAgZiItIE1lc3NhZ2U6XG5cbmBgYHRleHRcbnttc2cuc3RyaXAoKX1cbmBgYCIgaWYgbXNnIGVsc2UgIi0gTWVzc2FnZTogKG5vbmUpIiwKICAgICAgICAiIiwKICAgICAgICByZXByb19zdGVwcyhzdW1tYXJ5LCBuZiksCiAgICAgICAgIiIsCiAgICAgICAgIiMjIyBDb250ZXh0IiwKICAgICAgICBmIi0gU3VtbWFyeSBmaWxlOiBge3N1bW1hcnkuZ2V0KCdfcGF0aCcsJycpfWAiLAogICAgICAgIGYiLSBXb3JrZmxvdzogYHtvcy5nZXRlbnYoJ0dJVEhVQl9XT1JLRkxPVycsJycpfWAgUnVuIElEOiBge29zLmdldGVudignR0lUSFVCX1JVTl9JRCcsJycpfWAiLAogICAgXSkuc3RyaXAoKSArICJcbiIKICAgIHJldHVybiBmcCwgdGl0bGUsIGJvZHkKCmRlZiBtYWluKGFyZ3Y6IExpc3Rbc3RyXSkgLT4gaW50OgogICAgYXAgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0iT3BlbiBvciB1cGRhdGUgR2l0SHViIGlzc3VlcyBmb3IgZTJlIGZhaWx1cmVzLiIpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tc3VtbWFyeSIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJGQUlMVVJFX1NVTU1BUlkiLCAiYXJ0aWZhY3RzL2ZhaWx1cmVfc3VtbWFyeS5qc29uIikpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tcmVwbyIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJHSVRIVUJfUkVQT1NJVE9SWSIsICIiKSkKICAgIGFwLmFkZF9hcmd1bWVudCgiLS10b2tlbiIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJHSVRIVUJfVE9LRU4iLCAiIikpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tdGl0bGUtcHJlZml4IiwgZGVmYXVsdD0iW2UyZV0gIikKICAgIGFyZ3MgPSBhcC5wYXJzZV9hcmdzKGFyZ3YpCgogICAgaWYgbm90IGFyZ3MucmVwbzoKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KCJHSVRIVUJfUkVQT1NJVE9SWSBvciAtLXJlcG8gaXMgcmVxdWlyZWQgKGUuZy4gb3duZXIvcmVwbykiKQogICAgaWYgbm90IGFyZ3MudG9rZW46CiAgICAgICAgcmFpc2UgU3lzdGVtRXhpdCgiR0lUSFVCX1RPS0VOIG9yIC0tdG9rZW4gaXMgcmVxdWlyZWQiKQoKICAgIHN1bW1hcnkgPSBsb2FkX3N1bW1hcnkoYXJncy5zdW1tYXJ5KQogICAgZmFpbHVyZXMgPSBzdW1tYXJ5LmdldCgiZmFpbHVyZXMiLCBbXSkgb3IgW10KICAgIGlmIG5vdCBmYWlsdXJlczoKICAgICAgICBwcmludCgiTm8gZmFpbHVyZXMgZm91bmQ7IG5vdGhpbmcgdG8gZG8uIikKICAgICAgICByZXR1cm4gMAoKICAgIGNyZWF0ZWQgPSB1cGRhdGVkID0gMAogICAgZm9yIGYgaW4gZmFpbHVyZXM6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZiwgZGljdCk6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZnAsIHRpdGxlLCBib2R5ID0gYnVpbGRfaXNzdWUoYXJncy50aXRsZV9wcmVmaXgsIHN1bW1hcnksIGYpCiAgICAgICAgZXhpc3RpbmcgPSBmaW5kX2V4aXN0aW5nX2lzc3VlKGFyZ3MucmVwbywgYXJncy50b2tlbiwgZnApCiAgICAgICAgaWYgZXhpc3RpbmcgYW5kIGV4aXN0aW5nLmdldCgibnVtYmVyIik6CiAgICAgICAgICAgIG51bSA9IGludChleGlzdGluZ1sibnVtYmVyIl0pCiAgICAgICAgICAgIGNvbW1lbnQgPSAiXG4iLmpvaW4oWwogICAgICAgICAgICAgICAgZiJSZXByb2R1Y2VkIGluIGEgbmV3IENJIHJ1bi4iLAogICAgICAgICAgICAgICAgcmVwcm9fc3RlcHMoc3VtbWFyeSwgbm9ybWFsaXplX2ZhaWx1cmUoZikpLAogICAgICAgICAgICBdKQogICAgICAgICAgICBjb21tZW50X2lzc3VlKGFyZ3MucmVwbywgYXJncy50b2tlbiwgbnVtLCBjb21tZW50KQogICAgICAgICAgICB1cGRhdGVkICs9IDEKICAgICAgICAgICAgcHJpbnQoZiJVUERBVEVEX0lTU1VFOntudW19IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBudW0sIHVybCA9IGNyZWF0ZV9pc3N1ZShhcmdzLnJlcG8sIGFyZ3MudG9rZW4sIHRpdGxlLCBib2R5KQogICAgICAgICAgICBjcmVhdGVkICs9IDEKICAgICAgICAgICAgcHJpbnQoZiJDUkVBVEVEX0lTU1VFOntudW19Ont1cmx9IikKICAgIHByaW50KGYiU1RBVFM6Y3JlYXRlZD17Y3JlYXRlZH0gdXBkYXRlZD17dXBkYXRlZH0gdG90YWw9e2NyZWF0ZWQrdXBkYXRlZH0iKQogICAgcmV0dXJuIDAKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICByYWlzZSBTeXN0ZW1FeGl0KG1haW4oc3lzLmFyZ3ZbMTpdKSkK\"}\nDIR_STATE:[\"scripts/README_e2e.md\", \"scripts/artifacts.py\", \"scripts/e2e.py\", \"scripts/issue_on_failure.py\", \"scripts/repro_steps.py\", \"scripts/requirements-ci.txt\"]\n"
        }
      ]
    },
    {
      "id": "msg_0bbb72ff98d44aa2006949c07d3bd88197867d85d4d7b14c1d",
      "type": "message",
      "status": "completed",
      "content": [
        {
          "type": "output_text",
          "annotations": [],
          "logprobs": [],
          "text": "FILE_EXPORT:{\"path\":\"scripts/issue_on_failure.py\",\"size\":6861,\"encoding\":\"base64\",\"sha256\":\"e72d4881c388a46b0f9cdbfcca96d399548712a874c8385fbc05f5d17b5f6d20\",\"content\":\"IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgYXJncGFyc2UKaW1wb3J0IGhhc2hsaWIKaW1wb3J0IGpzb24KaW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIERpY3QsIExpc3QsIE9wdGlvbmFsLCBUdXBsZQoKaW1wb3J0IHJlcXVlc3RzCgpMQUJFTCA9ICJlMmUtZmFpbHVyZSIKVUEgPSAiaXNzdWVfb25fZmFpbHVyZS5weSIKRklOR0VSUFJJTlRfUkUgPSByZS5jb21waWxlKHIiPCEtLVxzKmZpbmdlcnByaW50OihbYS1mMC05XXs4LDQwfSlccyotLT4iKQoKZGVmIF9qZ2V0KGQ6IEFueSwgKmtleXM6IHN0ciwgZGVmYXVsdD1Ob25lKToKICAgIGZvciBrIGluIGtleXM6CiAgICAgICAgaWYgaXNpbnN0YW5jZShkLCBkaWN0KSBhbmQgayBpbiBkOgogICAgICAgICAgICByZXR1cm4gZFtrXQogICAgcmV0dXJuIGRlZmF1bHQKCmRlZiBsb2FkX3N1bW1hcnkocGF0aDogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHAgPSBvcy5wYXRoLmFic3BhdGgocGF0aCkKICAgIHdpdGggb3BlbihwLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgZGF0YSA9IGpzb24ubG9hZChmKQogICAgaWYgaXNpbnN0YW5jZShkYXRhLCBsaXN0KToKICAgICAgICBkYXRhID0geyJmYWlsdXJlcyI6IGRhdGF9CiAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBkaWN0KToKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KCJmYWlsdXJlIHN1bW1hcnkgbXVzdCBiZSBhIEpTT04gb2JqZWN0IG9yIGxpc3QiKQogICAgZmFpbHVyZXMgPSBkYXRhLmdldCgiZmFpbHVyZXMiKQogICAgaWYgZmFpbHVyZXMgaXMgTm9uZSBhbmQgInN0YWdlcyIgaW4gZGF0YToKICAgICAgICBmYWlsdXJlcyA9IFtzIGZvciBzIGluIGRhdGEuZ2V0KCJzdGFnZXMiLCBbXSkgaWYgcy5nZXQoInN0YXR1cyIpID09ICJmYWlsZWQiXQogICAgICAgIGRhdGFbImZhaWx1cmVzIl0gPSBmYWlsdXJlcwogICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0YS5nZXQoImZhaWx1cmVzIiwgW10pLCBsaXN0KToKICAgICAgICBkYXRhWyJmYWlsdXJlcyJdID0gW10KICAgIGRhdGFbIl9wYXRoIl0gPSBwCiAgICByZXR1cm4gZGF0YQoKZGVmIG5vcm1hbGl6ZV9mYWlsdXJlKGY6IERpY3Rbc3RyLCBBbnldKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHN0YWdlID0gc3RyKF9qZ2V0KGYsICJzdGFnZSIsICJuYW1lIiwgZGVmYXVsdD0idW5rbm93biIpKQogICAgbXNnID0gc3RyKF9qZ2V0KGYsICJtZXNzYWdlIiwgImVycm9yIiwgInN1bW1hcnkiLCBkZWZhdWx0PSIobm8gbWVzc2FnZSkiKSkKICAgIGNtZCA9IF9qZ2V0KGYsICJjb21tYW5kIiwgImNtZCIsIGRlZmF1bHQ9Tm9uZSkKICAgIGxvZyA9IF9qZ2V0KGYsICJsb2dfcGF0aCIsICJsb2ciLCAic3RkZXJyX3BhdGgiLCBkZWZhdWx0PU5vbmUpCiAgICByZXR1cm4geyJzdGFnZSI6IHN0YWdlLCAibWVzc2FnZSI6IG1zZywgImNvbW1hbmQiOiBjbWQsICJsb2dfcGF0aCI6IGxvZ30KCmRlZiBmaW5nZXJwcmludChmOiBEaWN0W3N0ciwgQW55XSkgLT4gc3RyOgogICAgc3RhZ2UgPSBmLmdldCgic3RhZ2UiLCAidW5rbm93biIpCiAgICBmaXJzdCA9IChmLmdldCgibWVzc2FnZSIpIG9yICIiKS5zdHJpcCgpLnNwbGl0bGluZXMoKVs6MV0KICAgIHNpZyA9IGYie3N0YWdlfVxue2ZpcnN0WzBdIGlmIGZpcnN0IGVsc2UgJyd9Ii5lbmNvZGUoInV0Zi04IiwgImlnbm9yZSIpCiAgICByZXR1cm4gaGFzaGxpYi5zaGExKHNpZykuaGV4ZGlnZXN0KClbOjEyXQoKZGVmIHJlcHJvX3N0ZXBzKHN1bW1hcnk6IERpY3Rbc3RyLCBBbnldLCBmOiBEaWN0W3N0ciwgQW55XSkgLT4gc3RyOgogICAgc2hhID0gX2pnZXQoc3VtbWFyeSwgInNoYSIsICJnaXRfc2hhIiwgZGVmYXVsdD1vcy5nZXRlbnYoIkdJVEhVQl9TSEEiLCAiIikpCiAgICBydW5fdXJsID0gX2pnZXQoc3VtbWFyeSwgInJ1bl91cmwiLCBkZWZhdWx0PW9zLmdldGVudigiR0lUSFVCX1NFUlZFUl9VUkwiLCAiIikgKyAiLyIgKyBvcy5nZXRlbnYoIkdJVEhVQl9SRVBPU0lUT1JZIiwgIiIpICsgIi9hY3Rpb25zL3J1bnMvIiArIG9zLmdldGVudigiR0lUSFVCX1JVTl9JRCIsICIiKSkKICAgIGNtZCA9IGYuZ2V0KCJjb21tYW5kIikgb3IgIm1ha2UgZTJlIgogICAgbGluZXMgPSBbCiAgICAgICAgIiMjIyBNaW5pbWFsIHJlcHJvZHVjdGlvbiIsCiAgICAgICAgIjEuIENoZWNrIG91dCB0aGUgZmFpbGluZyBjb21taXQ6IiwKICAgICAgICBmIiAgIC0gYHtzaGF9YCIgaWYgc2hhIGVsc2UgIiAgIC0gKHVua25vd24gU0hBKSIsCiAgICAgICAgZiIyLiBSdW46IGB7Y21kfWAiLAogICAgXQogICAgaWYgZi5nZXQoImxvZ19wYXRoIik6CiAgICAgICAgbGluZXMuYXBwZW5kKGYiMy4gSW5zcGVjdCBsb2dzOiBge2ZbJ2xvZ19wYXRoJ119YCAoc2VlIENJIGFydGlmYWN0cyBpZiBhdmFpbGFibGUpIikKICAgIGlmIHJ1bl91cmwgYW5kIHJ1bl91cmwuc3RyaXAoIi8iKToKICAgICAgICBsaW5lcy5hcHBlbmQoIiIpCiAgICAgICAgbGluZXMuYXBwZW5kKGYiQ0kgcnVuOiB7cnVuX3VybH0iKQogICAgcmV0dXJuICJcbiIuam9pbihsaW5lcykKCmRlZiBnaF9yZXF1ZXN0KG1ldGhvZDogc3RyLCB1cmw6IHN0ciwgdG9rZW46IHN0ciwgKiprd2FyZ3MpOgogICAgaGVhZGVycyA9IGt3YXJncy5wb3AoImhlYWRlcnMiLCB7fSkKICAgIGhlYWRlcnMudXBkYXRlKHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGYidG9rZW4ge3Rva2VufSIsCiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi92bmQuZ2l0aHViK2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogVUEsCiAgICB9KQogICAgZm9yIF8gaW4gcmFuZ2UoMyk6CiAgICAgICAgciA9IHJlcXVlc3RzLnJlcXVlc3QobWV0aG9kLCB1cmwsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD0zMCwgKiprd2FyZ3MpCiAgICAgICAgaWYgci5zdGF0dXNfY29kZSBpbiAoNDI5LCA1MDAsIDUwMiwgNTAzLCA1MDQpOgogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmV0dXJuIHIKICAgIHJldHVybiByCgpkZWYgZmluZF9leGlzdGluZ19pc3N1ZShyZXBvOiBzdHIsIHRva2VuOiBzdHIsIGZwOiBzdHIpIC0+IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXToKICAgIHEgPSBmInJlcG86e3JlcG99IGlzOmlzc3VlIGlzOm9wZW4gbGFiZWw6e0xBQkVMfSBpbjpib2R5IGZpbmdlcnByaW50OntmcH0iCiAgICB1cmwgPSBmImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vc2VhcmNoL2lzc3Vlcz9xPXtyZXF1ZXN0cy51dGlscy5xdW90ZShxKX0iCiAgICByID0gZ2hfcmVxdWVzdCgiR0VUIiwgdXJsLCB0b2tlbikKICAgIGlmIHIuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgIHJldHVybiBOb25lCiAgICBpdGVtcyA9IHIuanNvbigpLmdldCgiaXRlbXMiLCBbXSkgb3IgW10KICAgIHJldHVybiBpdGVtc1swXSBpZiBpdGVtcyBlbHNlIE5vbmUKCmRlZiBjcmVhdGVfaXNzdWUocmVwbzogc3RyLCB0b2tlbjogc3RyLCB0aXRsZTogc3RyLCBib2R5OiBzdHIpIC0+IFR1cGxlW2ludCwgc3RyXToKICAgIHVybCA9IGYiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy97cmVwb30vaXNzdWVzIgogICAgcGF5bG9hZCA9IHsidGl0bGUiOiB0aXRsZSwgImJvZHkiOiBib2R5LCAibGFiZWxzIjogW0xBQkVMXX0KICAgIHIgPSBnaF9yZXF1ZXN0KCJQT1NUIiwgdXJsLCB0b2tlbiwganNvbj1wYXlsb2FkKQogICAgaWYgci5zdGF0dXNfY29kZSBub3QgaW4gKDIwMCwgMjAxKToKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KGYiZmFpbGVkIHRvIGNyZWF0ZSBpc3N1ZToge3Iuc3RhdHVzX2NvZGV9IHtyLnRleHRbOjIwMF19IikKICAgIGogPSByLmpzb24oKQogICAgcmV0dXJuIGludChqWyJudW1iZXIiXSksIGouZ2V0KCJodG1sX3VybCIsICIiKQoKZGVmIGNvbW1lbnRfaXNzdWUocmVwbzogc3RyLCB0b2tlbjogc3RyLCBudW1iZXI6IGludCwgYm9keTogc3RyKSAtPiBOb25lOgogICAgdXJsID0gZiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3tyZXBvfS9pc3N1ZXMve251bWJlcn0vY29tbWVudHMiCiAgICByID0gZ2hfcmVxdWVzdCgiUE9TVCIsIHVybCwgdG9rZW4sIGpzb249eyJib2R5IjogYm9keX0pCiAgICBpZiByLnN0YXR1c19jb2RlIG5vdCBpbiAoMjAwLCAyMDEpOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJmYWlsZWQgdG8gY29tbWVudDoge3Iuc3RhdHVzX2NvZGV9IHtyLnRleHRbOjIwMF19IikKZGVmIGJ1aWxkX2lzc3VlKHRpdGxlX3ByZWZpeDogc3RyLCBzdW1tYXJ5OiBEaWN0W3N0ciwgQW55XSwgZjogRGljdFtzdHIsIEFueV0pIC0+IFR1cGxlW3N0ciwgc3RyLCBzdHJdOgogICAgbmYgPSBub3JtYWxpemVfZmFpbHVyZShmKQogICAgZnAgPSBmaW5nZXJwcmludChuZikKICAgIG1zZyA9IChuZlsibWVzc2FnZSJdIG9yICIiKS5zdHJpcCgpCiAgICBzaG9ydCA9IChtc2cuc3BsaXRsaW5lcygpWzoxXSBvciBbIihubyBtZXNzYWdlKSJdKVswXQogICAgc2hvcnQgPSBzaG9ydFs6MTIwXQogICAgdGl0bGUgPSBmInt0aXRsZV9wcmVmaXh9e25mWydzdGFnZSddfToge3Nob3J0fSIKICAgIGJvZHkgPSAiXG4iLmpvaW4oWwogICAgICAgIGYiPCEtLSBmaW5nZXJwcmludDp7ZnB9IC0tPiIsCiAgICAgICAgIiMjIyBGYWlsdXJlIiwKICAgICAgICBmIi0gU3RhZ2U6IGB7bmZbJ3N0YWdlJ119YCIsCiAgICAgICAgZiItIE1lc3NhZ2U6XG5cbmBgYHRleHRcbnttc2cuc3RyaXAoKX1cbmBgYCIgaWYgbXNnIGVsc2UgIi0gTWVzc2FnZTogKG5vbmUpIiwKICAgICAgICAiIiwKICAgICAgICByZXByb19zdGVwcyhzdW1tYXJ5LCBuZiksCiAgICAgICAgIiIsCiAgICAgICAgIiMjIyBDb250ZXh0IiwKICAgICAgICBmIi0gU3VtbWFyeSBmaWxlOiBge3N1bW1hcnkuZ2V0KCdfcGF0aCcsJycpfWAiLAogICAgICAgIGYiLSBXb3JrZmxvdzogYHtvcy5nZXRlbnYoJ0dJVEhVQl9XT1JLRkxPVycsJycpfWAgUnVuIElEOiBge29zLmdldGVudignR0lUSFVCX1JVTl9JRCcsJycpfWAiLAogICAgXSkuc3RyaXAoKSArICJcbiIKICAgIHJldHVybiBmcCwgdGl0bGUsIGJvZHkKCmRlZiBtYWluKGFyZ3Y6IExpc3Rbc3RyXSkgLT4gaW50OgogICAgYXAgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0iT3BlbiBvciB1cGRhdGUgR2l0SHViIGlzc3VlcyBmb3IgZTJlIGZhaWx1cmVzLiIpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tc3VtbWFyeSIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJGQUlMVVJFX1NVTU1BUlkiLCAiYXJ0aWZhY3RzL2ZhaWx1cmVfc3VtbWFyeS5qc29uIikpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tcmVwbyIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJHSVRIVUJfUkVQT1NJVE9SWSIsICIiKSkKICAgIGFwLmFkZF9hcmd1bWVudCgiLS10b2tlbiIsIGRlZmF1bHQ9b3MuZ2V0ZW52KCJHSVRIVUJfVE9LRU4iLCAiIikpCiAgICBhcC5hZGRfYXJndW1lbnQoIi0tdGl0bGUtcHJlZml4IiwgZGVmYXVsdD0iW2UyZV0gIikKICAgIGFyZ3MgPSBhcC5wYXJzZV9hcmdzKGFyZ3YpCgogICAgaWYgbm90IGFyZ3MucmVwbzoKICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KCJHSVRIVUJfUkVQT1NJVE9SWSBvciAtLXJlcG8gaXMgcmVxdWlyZWQgKGUuZy4gb3duZXIvcmVwbykiKQogICAgaWYgbm90IGFyZ3MudG9rZW46CiAgICAgICAgcmFpc2UgU3lzdGVtRXhpdCgiR0lUSFVCX1RPS0VOIG9yIC0tdG9rZW4gaXMgcmVxdWlyZWQiKQoKICAgIHN1bW1hcnkgPSBsb2FkX3N1bW1hcnkoYXJncy5zdW1tYXJ5KQogICAgZmFpbHVyZXMgPSBzdW1tYXJ5LmdldCgiZmFpbHVyZXMiLCBbXSkgb3IgW10KICAgIGlmIG5vdCBmYWlsdXJlczoKICAgICAgICBwcmludCgiTm8gZmFpbHVyZXMgZm91bmQ7IG5vdGhpbmcgdG8gZG8uIikKICAgICAgICByZXR1cm4gMAoKICAgIGNyZWF0ZWQgPSB1cGRhdGVkID0gMAogICAgZm9yIGYgaW4gZmFpbHVyZXM6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZiwgZGljdCk6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZnAsIHRpdGxlLCBib2R5ID0gYnVpbGRfaXNzdWUoYXJncy50aXRsZV9wcmVmaXgsIHN1bW1hcnksIGYpCiAgICAgICAgZXhpc3RpbmcgPSBmaW5kX2V4aXN0aW5nX2lzc3VlKGFyZ3MucmVwbywgYXJncy50b2tlbiwgZnApCiAgICAgICAgaWYgZXhpc3RpbmcgYW5kIGV4aXN0aW5nLmdldCgibnVtYmVyIik6CiAgICAgICAgICAgIG51bSA9IGludChleGlzdGluZ1sibnVtYmVyIl0pCiAgICAgICAgICAgIGNvbW1lbnQgPSAiXG4iLmpvaW4oWwogICAgICAgICAgICAgICAgZiJSZXByb2R1Y2VkIGluIGEgbmV3IENJIHJ1bi4iLAogICAgICAgICAgICAgICAgcmVwcm9fc3RlcHMoc3VtbWFyeSwgbm9ybWFsaXplX2ZhaWx1cmUoZikpLAogICAgICAgICAgICBdKQogICAgICAgICAgICBjb21tZW50X2lzc3VlKGFyZ3MucmVwbywgYXJncy50b2tlbiwgbnVtLCBjb21tZW50KQogICAgICAgICAgICB1cGRhdGVkICs9IDEKICAgICAgICAgICAgcHJpbnQoZiJVUERBVEVEX0lTU1VFOntudW19IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBudW0sIHVybCA9IGNyZWF0ZV9pc3N1ZShhcmdzLnJlcG8sIGFyZ3MudG9rZW4sIHRpdGxlLCBib2R5KQogICAgICAgICAgICBjcmVhdGVkICs9IDEKICAgICAgICAgICAgcHJpbnQoZiJDUkVBVEVEX0lTU1VFOntudW19Ont1cmx9IikKICAgIHByaW50KGYiU1RBVFM6Y3JlYXRlZD17Y3JlYXRlZH0gdXBkYXRlZD17dXBkYXRlZH0gdG90YWw9e2NyZWF0ZWQrdXBkYXRlZH0iKQogICAgcmV0dXJuIDAKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICByYWlzZSBTeXN0ZW1FeGl0KG1haW4oc3lzLmFyZ3ZbMTpdKSkK\"}\nDIR_STATE:[\"scripts/README_e2e.md\",\"scripts/artifacts.py\",\"scripts/e2e.py\",\"scripts/issue_on_failure.py\",\"scripts/repro_steps.py\",\"scripts/requirements-ci.txt\"]"
        }
      ],
      "role": "assistant"
    }
  ],
  "codeResults": []
}