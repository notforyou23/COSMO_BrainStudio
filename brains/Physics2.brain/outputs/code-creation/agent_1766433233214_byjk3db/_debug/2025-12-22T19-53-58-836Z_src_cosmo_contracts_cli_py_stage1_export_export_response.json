{
  "content": "FILE_EXPORT:{\"path\":\"src/cosmo_contracts/cli.py\",\"size\":6451,\"encoding\":\"base64\",\"sha256\":\"16c99dd188175e8e7971a143ccdd608b12976c8495dae64f6930234af2b309ef\",\"content\":\"IyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCmZyb20gX19mdXR1cmVfXyBpbXBvcnQgYW5ub3RhdGlvbnMKCmltcG9ydCBhcmdwYXJzZQppbXBvcnQgaW1wb3J0bGliCmltcG9ydCBqc29uCmltcG9ydCBzeXMKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIHR5cGluZyBpbXBvcnQgQW55LCBEaWN0LCBJdGVyYWJsZSwgTGlzdCwgT3B0aW9uYWwsIFR1cGxlCkBkYXRhY2xhc3MKY2xhc3MgQ29tcGxpYW5jZVJlc3VsdDoKICAgIGJlbmNobWFya19pZDogc3RyCiAgICBpbXBsZW1lbnRhdGlvbjogc3RyCiAgICBwYXNzZWQ6IGJvb2wKICAgIGRpYWdub3N0aWNzOiBBbnkgPSBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9qc29uKGNscywgb2JqOiBEaWN0W3N0ciwgQW55XSwgc291cmNlOiBzdHIpIC0+ICJDb21wbGlhbmNlUmVzdWx0IjoKICAgICAgICBtaXNzaW5nID0gW2sgZm9yIGsgaW4gKCJiZW5jaG1hcmtfaWQiLCAiaW1wbGVtZW50YXRpb24iLCAicGFzcyIpIGlmIGsgbm90IGluIG9ial0KICAgICAgICBpZiBtaXNzaW5nOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYie3NvdXJjZX06IG1pc3NpbmcgcmVxdWlyZWQgZmllbGRzOiB7JywgJy5qb2luKG1pc3NpbmcpfSIpCiAgICAgICAgcmV0dXJuIGNscygKICAgICAgICAgICAgYmVuY2htYXJrX2lkPXN0cihvYmpbImJlbmNobWFya19pZCJdKSwKICAgICAgICAgICAgaW1wbGVtZW50YXRpb249c3RyKG9ialsiaW1wbGVtZW50YXRpb24iXSksCiAgICAgICAgICAgIHBhc3NlZD1ib29sKG9ialsicGFzcyJdKSwKICAgICAgICAgICAgZGlhZ25vc3RpY3M9b2JqLmdldCgiZGlhZ25vc3RpY3MiKSwKICAgICAgICApCgogICAgZGVmIHRvX2pzb24oc2VsZikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImJlbmNobWFya19pZCI6IHNlbGYuYmVuY2htYXJrX2lkLAogICAgICAgICAgICAiaW1wbGVtZW50YXRpb24iOiBzZWxmLmltcGxlbWVudGF0aW9uLAogICAgICAgICAgICAicGFzcyI6IHNlbGYucGFzc2VkLAogICAgICAgICAgICAiZGlhZ25vc3RpY3MiOiBzZWxmLmRpYWdub3N0aWNzLAogICAgICAgIH0KZGVmIF90cnlfaW1wb3J0KHBhdGg6IHN0cik6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGltcG9ydGxpYi5pbXBvcnRfbW9kdWxlKHBhdGgpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6ICAjIHByYWdtYTogbm8gY292ZXIKICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoCiAgICAgICAgICAgIGYiRmFpbGVkIHRvIGltcG9ydCAne3BhdGh9Jy4gRW5zdXJlIGNvc21vX2NvbnRyYWN0cyBpcyBpbnN0YWxsZWQgd2l0aCBpdHMgZGVwZW5kZW5jaWVzLlxuIgogICAgICAgICAgICBmIlVuZGVybHlpbmcgZXJyb3I6IHt0eXBlKGUpLl9fbmFtZV9ffToge2V9IgogICAgICAgICkgZnJvbSBlCmRlZiBfcmVhZF9qc29uKHBhdGg6IFBhdGgpIC0+IEFueToKICAgIHRyeToKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhwYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgIGV4Y2VwdCBqc29uLkpTT05EZWNvZGVFcnJvciBhcyBlOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJJbnZhbGlkIEpTT04gaW4ge3BhdGh9OiB7ZX0iKSBmcm9tIGUKCgpkZWYgX2xvYWRfcmVwb3J0X2ZpbGVzKHBhdGhzOiBJdGVyYWJsZVtQYXRoXSkgLT4gTGlzdFtDb21wbGlhbmNlUmVzdWx0XToKICAgIHJlc3VsdHM6IExpc3RbQ29tcGxpYW5jZVJlc3VsdF0gPSBbXQogICAgZm9yIHAgaW4gcGF0aHM6CiAgICAgICAgb2JqID0gX3JlYWRfanNvbihwKQogICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBkaWN0KToKICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoQ29tcGxpYW5jZVJlc3VsdC5mcm9tX2pzb24ob2JqLCBzdHIocCkpKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvYmosIGxpc3QpOgogICAgICAgICAgICBmb3IgaSwgaXRlbSBpbiBlbnVtZXJhdGUob2JqKToKICAgICAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGl0ZW0sIGRpY3QpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJ7cH1be2l9XTogZXhwZWN0ZWQgb2JqZWN0LCBnb3Qge3R5cGUoaXRlbSkuX19uYW1lX199IikKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKENvbXBsaWFuY2VSZXN1bHQuZnJvbV9qc29uKGl0ZW0sIGYie3B9W3tpfV0iKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KGYie3B9OiBleHBlY3RlZCBvYmplY3Qgb3IgYXJyYXksIGdvdCB7dHlwZShvYmopLl9fbmFtZV9ffSIpCiAgICByZXR1cm4gcmVzdWx0cwpkZWYgX2FnZ3JlZ2F0ZShyZXN1bHRzOiBMaXN0W0NvbXBsaWFuY2VSZXN1bHRdKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHRvdGFsID0gbGVuKHJlc3VsdHMpCiAgICBwYXNzZWQgPSBzdW0oMSBmb3IgciBpbiByZXN1bHRzIGlmIHIucGFzc2VkKQogICAgZmFpbGVkID0gdG90YWwgLSBwYXNzZWQKICAgIGJ5X2JlbmNobWFyazogRGljdFtzdHIsIERpY3Rbc3RyLCBBbnldXSA9IHt9CiAgICBmb3IgciBpbiByZXN1bHRzOgogICAgICAgIGIgPSBieV9iZW5jaG1hcmsuc2V0ZGVmYXVsdChyLmJlbmNobWFya19pZCwgeyJwYXNzZWQiOiAwLCAiZmFpbGVkIjogMCwgInJlc3VsdHMiOiBbXX0pCiAgICAgICAgYlsicGFzZWQiBpZiByLnBhc3NlZCBlbHNlICJmYWlsZWQiXSArPSAxCiAgICAgICAgYlsicmVzdWx0cyJdLmFwcGVuZChyLnRvX2pzb24oKSkKICAgIHJldHVybiB7InN1bW1hcnkiOiB7InRvdGFsIjogdG90YWwsICJwYXNzZWQiOiBwYXNzZWQsICJmYWlsZWQiOiBmYWlsZWR9LCAiYnlfYmVuY2htYXJrIjogYnlfYmVuY2htYXJrfQpkZWYgY21kX3N5bmMoYXJnczogYXJncGFyc2UuTmFtZXNwYWNlKSAtPiBpbnQ6CiAgICBtZF9wYXRoID0gUGF0aChhcmdzLmJlbmNobWFya3NfbWQpCiAgICBvdXRfcGF0aCA9IFBhdGgoYXJncy5vdXQpIGlmIGFyZ3Mub3V0IGVsc2UgbWRfcGF0aAogICAgbWFya2Rvd24gPSBfdHJ5X2ltcG9ydCgiY29zbW9fY29udHJhY3RzLm1hcmtkb3duIikKICAgIGlmIG5vdCBoYXNhdHRyKG1hcmtkb3duLCAicmV3cml0ZV93aXRoX2NvbnRyYWN0cyIpOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoImNvc21vX2NvbnRyYWN0cy5tYXJrZG93bi5yZXdyaXRlX3dpdGhfY29udHJhY3RzIGlzIHJlcXVpcmVkIGZvciAnc3luYycuIikKICAgIG5ld190ZXh0ID0gbWFya2Rvd24ucmV3cml0ZV93aXRoX2NvbnRyYWN0cyhtZF9wYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgIGlmIGFyZ3MuY2hlY2s6CiAgICAgICAgaWYgbmV3X3RleHQgIT0gbWRfcGF0aC5yZWFkX3RleHQoZW5jb2Rpbmc9InV0Zi04Iik6CiAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoImNvbnRyYWN0c19vdXRfb2ZfZGF0ZVxuIikKICAgICAgICAgICAgcmV0dXJuIDIKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJjb250cmFjdHNfdXBfdG9fZGF0ZVxuIikKICAgICAgICByZXR1cm4gMAogICAgb3V0X3BhdGgud3JpdGVfdGV4dChuZXdfdGV4dCwgZW5jb2Rpbmc9InV0Zi04IikKICAgIHN5cy5zdGRvdXQud3JpdGUoZiJ3cml0dGVuOntvdXRfcGF0aH1cbiIpCiAgICByZXR1cm4gMApkZWYgY21kX3ZhbGlkYXRlKGFyZ3M6IGFyZ3BhcnNlLk5hbWVzcGFjZSkgLT4gaW50OgogICAgIyBUd28gbW9kZXM6CiAgICAjIChBKSBWYWxpZGF0ZSBjb21wbGlhbmNlLXJlcG9ydCBKU09OIGZpbGVzIChhbHdheXMgc3VwcG9ydGVkKS4KICAgICMgKEIpIElmIGNvc21vX2NvbnRyYWN0cyBoYXMgYSB2YWxpZGF0b3IgQVBJLCBydW4gaXQgYW5kIGVtaXQgYSByZXBvcnQuCiAgICBpZiBhcmdzLnJlcG9ydHM6CiAgICAgICAgcmVzdWx0cyA9IF9sb2FkX3JlcG9ydF9maWxlcyhbUGF0aChwKSBmb3IgcCBpbiBhcmdzLnJlcG9ydHNdKQogICAgICAgIHJlcG9ydCA9IF9hZ2dyZWdhdGUocmVzdWx0cykKICAgIGVsc2U6CiAgICAgICAgdmFsaWRhdG9yID0gX3RyeV9pbXBvcnQoImNvc21vX2NvbnRyYWN0cyIpCiAgICAgICAgaWYgbm90IGhhc2F0dHIodmFsaWRhdG9yLCAidmFsaWRhdGVfY29tcGxpYW5jZSIpOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KAogICAgICAgICAgICAgICAgIk5vIHJlcG9ydHMgcHJvdmlkZWQgYW5kIGNvc21vX2NvbnRyYWN0cy52YWxpZGF0ZV9jb21wbGlhbmNlIG5vdCBhdmFpbGFibGUuICIKICAgICAgICAgICAgICAgICJQcm92aWRlIC0tcmVwb3J0cyBvciBpbnN0YWxsIGZ1bGwgY29zbW9fY29udHJhY3RzIHBhY2thZ2UuIgogICAgICAgICAgICApCiAgICAgICAgcmVwb3J0ID0gdmFsaWRhdG9yLnZhbGlkYXRlX2NvbXBsaWFuY2UoCiAgICAgICAgICAgIGJlbmNobWFya3NfbWQ9UGF0aChhcmdzLmJlbmNobWFya3NfbWQpIGlmIGFyZ3MuYmVuY2htYXJrc19tZCBlbHNlIE5vbmUsCiAgICAgICAgICAgIGltcGxlbWVudGF0aW9ucz1hcmdzLmltcGxlbWVudGF0aW9ucyBvciBbXSwKICAgICAgICApCgogICAgdGV4dCA9IGpzb24uZHVtcHMocmVwb3J0LCBpbmRlbnQ9Miwgc29ydF9rZXlzPVRydWUpCiAgICBpZiBhcmdzLm91dDoKICAgICAgICBQYXRoKGFyZ3Mub3V0KS53cml0ZV90ZXh0KHRleHQgKyAiXG4iLCBlbmNvZGluZz0idXRmLTgiKQogICAgZWxzZToKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKHRleHQgKyAiXG4iKQoKICAgIGZhaWxlZCA9IGludChyZXBvcnQuZ2V0KCJzdW1tYXJ5Iiwge30pLmdldCgiZmFpbGVkIiwgMCkpCiAgICByZXR1cm4gMSBpZiBmYWlsZWQgZWxzZSAwCmRlZiBidWlsZF9wYXJzZXIoKSAtPiBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcjoKICAgIHAgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihwcm9nPSJjb3Ntby1jb250cmFjdHMiLCBkZXNjcmlwdGlvbj0iQ29udHJhY3Qgc2VjdGlvbiBzeW5jICsgY29tcGxpYW5jZSB2YWxpZGF0aW9uIikKICAgIHN1YiA9IHAuYWRkX3N1YnBhcnNlcnMoZGVzdD0iY21kIiwgcmVxdWlyZWQ9VHJ1ZSkKCiAgICBzID0gc3ViLmFkZF9wYXJzZXIoInN5bmMiLCBoZWxwPSJBZGQvdXBkYXRlIHN0YW5kYXJkaXplZCBDb250cmFjdCBzZWN0aW9ucyBpbiB2MC4xIGJlbmNobWFyayBtYXJrZG93biIpCiAgICBzLmFkZF9hcmd1bWVudCgiYmVuY2htYXJrc19tZCIsIGhlbHA9IlBhdGggdG8gYmVuY2htYXJrc192MF8xLm1kIChpbnB1dDsgYWxzbyBvdXRwdXQgaWYgLS1vdXQgbm90IHNldCkiKQogICAgcy5hZGRfYXJndW1lbnQoIi0tb3V0IiwgaGVscD0iV3JpdGUgdXBkYXRlZCBtYXJrZG93biB0byB0aGlzIHBhdGggKGRlZmF1bHQ6IGluLXBsYWNlKSIpCiAgICBzLmFkZF9hcmd1bWVudCgiLS1jaGVjayIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IkRvIG5vdCB3cml0ZTsgZXhpdCAwIGlmIHVwLXRvLWRhdGUgZWxzZSAyIikKICAgIHMuc2V0X2RlZmF1bHRzKGZ1bmM9Y21kX3N5bmMpCgogICAgdiA9IHN1Yi5hZGRfcGFyc2VyKCJ2YWxpZGF0ZSIsIGhlbHA9IlZhbGlkYXRlIGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGNvbXBsaWFuY2UgYW5kIGVtaXQgYSByZXBvcnQiKQogICAgdi5hZGRfYXJndW1lbnQoIi0tYmVuY2htYXJrcy1tZCIsIGRlc3Q9ImJlbmNobWFya3NfbWQiLCBoZWxwPSJPcHRpb25hbCBtYXJrZG93biBwYXRoIGZvciBBUEktZHJpdmVuIHZhbGlkYXRpb24iKQogICAgdi5hZGRfYXJndW1lbnQoIi0taW1wbGVtZW50YXRpb25zIiwgbmFyZ3M9IioiLCBoZWxwPSJPcHRpb25hbCBpbXBsZW1lbnRhdGlvbiBpZGVudGlmaWVycyBmb3IgQVBJLWRyaXZlbiB2YWxpZGF0aW9uIikKICAgIHYuYWRkX2FyZ3VtZW50KCItLXJlcG9ydHMiLCBuYXJncz0iKiIsIGhlbHA9IlBhdGhzIHRvIEpTT04gY29tcGxpYW5jZSByZXBvcnRzIGVtaXR0ZWQgYnkgaW1wbGVtZW50YXRpb25zIikKICAgIHYuYWRkX2FyZ3VtZW50KCItLW91dCIsIGhlbHA9IldyaXRlIEpTT04gcmVwb3J0IHRvIHRoaXMgZmlsZSAoZGVmYXVsdDogc3Rkb3V0KSIpCiAgICB2LnNldF9kZWZhdWx0cyhmdW5jPWNtZF92YWxpZGF0ZSkKCiAgICByZXR1cm4gcAoKCmRlZiBtYWluKGFyZ3Y6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lKSAtPiBpbnQ6CiAgICBhcmdzID0gYnVpbGRfcGFyc2VyKCkucGFyc2VfYXJncyhhcmd2KQogICAgdHJ5OgogICAgICAgIHJldHVybiBpbnQoYXJncy5mdW5jKGFyZ3MpKQogICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogICMgcHJhZ21hOiBubyBjb3ZlcgogICAgICAgIHN5cy5zdGRlcnIud3JpdGUoZiJlcnJvcjp7dHlwZShlKS5fX25hbWVfX306e2V9XG4iKQogICAgICAgIHJldHVybiAxCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjogICMgcHJhZ21hOiBubyBjb3ZlcgogICAgcmFpc2UgU3lzdGVtRXhpdChtYWluKCkpCg==\"}\nDIR_STATE:[\"src/cosmo_contracts/__init__.py\",\"src/cosmo_contracts/__main__.py\",\"src/cosmo_contracts/cli.py\",\"src/cosmo_contracts/contracts.py\",\"src/cosmo_contracts/markdown.py\",\"src/cosmo_contracts/runner.py\",\"src/cosmo_contracts/schema.py\"]",
  "reasoning": "",
  "responseId": "resp_0dd75ba363ea4411006949a51f8ea88195bc59ce6a656d1563",
  "model": "gpt-5.2-2025-12-11",
  "usage": {
    "input_tokens": 6682,
    "input_tokens_details": {
      "cached_tokens": 0
    },
    "output_tokens": 5631,
    "output_tokens_details": {
      "reasoning_tokens": 0
    },
    "total_tokens": 12313
  },
  "hadError": false,
  "errorType": null,
  "webSearchSources": [],
  "citations": [],
  "output": [
    {
      "id": "ci_0dd75ba363ea4411006949a520999c8195858ed7362ce5b4a0",
      "type": "code_interpreter_call",
      "status": "completed",
      "code": "from pathlib import Path\nimport base64, json, hashlib, gzip\n\ntarget_path = Path('/mnt/data').joinpath('src/cosmo_contracts/cli.py')\nassert target_path.is_file(), 'Expected src/cosmo_contracts/cli.py to exist before export'\ndata = target_path.read_bytes()\npayload = {\n  'path': 'src/cosmo_contracts/cli.py',\n  'size': len(data),\n  'encoding': 'base64',\n  'sha256': hashlib.sha256(data).hexdigest(),\n  'content': None\n}\nif len(data) > 20000:\n    compressed = gzip.compress(data)\n    payload['encoding'] = 'gzip+base64'\n    payload['content'] = base64.b64encode(compressed).decode('ascii')\nelse:\n    payload['content'] = base64.b64encode(data).decode('ascii')\n\nprint('FILE_EXPORT:' + json.dumps(payload, separators=(',', ':')))\nprint('DIR_STATE:' + json.dumps(sorted(str(p.relative_to(Path(\"/mnt/data\"))) for p in target_path.parent.glob('*') if p.is_file())))",
      "container_id": "cntr_6949a1d5445881908092d2723527a8b207f782e9910e8fd5",
      "outputs": [
        {
          "type": "logs",
          "logs": "FILE_EXPORT:{\"path\":\"src/cosmo_contracts/cli.py\",\"size\":6451,\"encoding\":\"base64\",\"sha256\":\"16c99dd188175e8e7971a143ccdd608b12976c8495dae64f6930234af2b309ef\",\"content\":\"IyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCmZyb20gX19mdXR1cmVfXyBpbXBvcnQgYW5ub3RhdGlvbnMKCmltcG9ydCBhcmdwYXJzZQppbXBvcnQgaW1wb3J0bGliCmltcG9ydCBqc29uCmltcG9ydCBzeXMKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIHR5cGluZyBpbXBvcnQgQW55LCBEaWN0LCBJdGVyYWJsZSwgTGlzdCwgT3B0aW9uYWwsIFR1cGxlCkBkYXRhY2xhc3MKY2xhc3MgQ29tcGxpYW5jZVJlc3VsdDoKICAgIGJlbmNobWFya19pZDogc3RyCiAgICBpbXBsZW1lbnRhdGlvbjogc3RyCiAgICBwYXNzZWQ6IGJvb2wKICAgIGRpYWdub3N0aWNzOiBBbnkgPSBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9qc29uKGNscywgb2JqOiBEaWN0W3N0ciwgQW55XSwgc291cmNlOiBzdHIpIC0+ICJDb21wbGlhbmNlUmVzdWx0IjoKICAgICAgICBtaXNzaW5nID0gW2sgZm9yIGsgaW4gKCJiZW5jaG1hcmtfaWQiLCAiaW1wbGVtZW50YXRpb24iLCAicGFzcyIpIGlmIGsgbm90IGluIG9ial0KICAgICAgICBpZiBtaXNzaW5nOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYie3NvdXJjZX06IG1pc3NpbmcgcmVxdWlyZWQgZmllbGRzOiB7JywgJy5qb2luKG1pc3NpbmcpfSIpCiAgICAgICAgcmV0dXJuIGNscygKICAgICAgICAgICAgYmVuY2htYXJrX2lkPXN0cihvYmpbImJlbmNobWFya19pZCJdKSwKICAgICAgICAgICAgaW1wbGVtZW50YXRpb249c3RyKG9ialsiaW1wbGVtZW50YXRpb24iXSksCiAgICAgICAgICAgIHBhc3NlZD1ib29sKG9ialsicGFzcyJdKSwKICAgICAgICAgICAgZGlhZ25vc3RpY3M9b2JqLmdldCgiZGlhZ25vc3RpY3MiKSwKICAgICAgICApCgogICAgZGVmIHRvX2pzb24oc2VsZikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImJlbmNobWFya19pZCI6IHNlbGYuYmVuY2htYXJrX2lkLAogICAgICAgICAgICAiaW1wbGVtZW50YXRpb24iOiBzZWxmLmltcGxlbWVudGF0aW9uLAogICAgICAgICAgICAicGFzcyI6IHNlbGYucGFzc2VkLAogICAgICAgICAgICAiZGlhZ25vc3RpY3MiOiBzZWxmLmRpYWdub3N0aWNzLAogICAgICAgIH0KZGVmIF90cnlfaW1wb3J0KHBhdGg6IHN0cik6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGltcG9ydGxpYi5pbXBvcnRfbW9kdWxlKHBhdGgpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6ICAjIHByYWdtYTogbm8gY292ZXIKICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoCiAgICAgICAgICAgIGYiRmFpbGVkIHRvIGltcG9ydCAne3BhdGh9Jy4gRW5zdXJlIGNvc21vX2NvbnRyYWN0cyBpcyBpbnN0YWxsZWQgd2l0aCBpdHMgZGVwZW5kZW5jaWVzLlxuIgogICAgICAgICAgICBmIlVuZGVybHlpbmcgZXJyb3I6IHt0eXBlKGUpLl9fbmFtZV9ffToge2V9IgogICAgICAgICkgZnJvbSBlCmRlZiBfcmVhZF9qc29uKHBhdGg6IFBhdGgpIC0+IEFueToKICAgIHRyeToKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhwYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgIGV4Y2VwdCBqc29uLkpTT05EZWNvZGVFcnJvciBhcyBlOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJJbnZhbGlkIEpTT04gaW4ge3BhdGh9OiB7ZX0iKSBmcm9tIGUKCgpkZWYgX2xvYWRfcmVwb3J0X2ZpbGVzKHBhdGhzOiBJdGVyYWJsZVtQYXRoXSkgLT4gTGlzdFtDb21wbGlhbmNlUmVzdWx0XToKICAgIHJlc3VsdHM6IExpc3RbQ29tcGxpYW5jZVJlc3VsdF0gPSBbXQogICAgZm9yIHAgaW4gcGF0aHM6CiAgICAgICAgb2JqID0gX3JlYWRfanNvbihwKQogICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBkaWN0KToKICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoQ29tcGxpYW5jZVJlc3VsdC5mcm9tX2pzb24ob2JqLCBzdHIocCkpKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvYmosIGxpc3QpOgogICAgICAgICAgICBmb3IgaSwgaXRlbSBpbiBlbnVtZXJhdGUob2JqKToKICAgICAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGl0ZW0sIGRpY3QpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJ7cH1be2l9XTogZXhwZWN0ZWQgb2JqZWN0LCBnb3Qge3R5cGUoaXRlbSkuX19uYW1lX199IikKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKENvbXBsaWFuY2VSZXN1bHQuZnJvbV9qc29uKGl0ZW0sIGYie3B9W3tpfV0iKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KGYie3B9OiBleHBlY3RlZCBvYmplY3Qgb3IgYXJyYXksIGdvdCB7dHlwZShvYmopLl9fbmFtZV9ffSIpCiAgICByZXR1cm4gcmVzdWx0cwpkZWYgX2FnZ3JlZ2F0ZShyZXN1bHRzOiBMaXN0W0NvbXBsaWFuY2VSZXN1bHRdKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHRvdGFsID0gbGVuKHJlc3VsdHMpCiAgICBwYXNzZWQgPSBzdW0oMSBmb3IgciBpbiByZXN1bHRzIGlmIHIucGFzc2VkKQogICAgZmFpbGVkID0gdG90YWwgLSBwYXNzZWQKICAgIGJ5X2JlbmNobWFyazogRGljdFtzdHIsIERpY3Rbc3RyLCBBbnldXSA9IHt9CiAgICBmb3IgciBpbiByZXN1bHRzOgogICAgICAgIGIgPSBieV9iZW5jaG1hcmsuc2V0ZGVmYXVsdChyLmJlbmNobWFya19pZCwgeyJwYXNzZWQiOiAwLCAiZmFpbGVkIjogMCwgInJlc3VsdHMiOiBbXX0pCiAgICAgICAgYlsicGFzc2VkIiBpZiByLnBhc3NlZCBlbHNlICJmYWlsZWQiXSArPSAxCiAgICAgICAgYlsicmVzdWx0cyJdLmFwcGVuZChyLnRvX2pzb24oKSkKICAgIHJldHVybiB7InN1bW1hcnkiOiB7InRvdGFsIjogdG90YWwsICJwYXNzZWQiOiBwYXNzZWQsICJmYWlsZWQiOiBmYWlsZWR9LCAiYnlfYmVuY2htYXJrIjogYnlfYmVuY2htYXJrfQpkZWYgY21kX3N5bmMoYXJnczogYXJncGFyc2UuTmFtZXNwYWNlKSAtPiBpbnQ6CiAgICBtZF9wYXRoID0gUGF0aChhcmdzLmJlbmNobWFya3NfbWQpCiAgICBvdXRfcGF0aCA9IFBhdGgoYXJncy5vdXQpIGlmIGFyZ3Mub3V0IGVsc2UgbWRfcGF0aAogICAgbWFya2Rvd24gPSBfdHJ5X2ltcG9ydCgiY29zbW9fY29udHJhY3RzLm1hcmtkb3duIikKICAgIGlmIG5vdCBoYXNhdHRyKG1hcmtkb3duLCAicmV3cml0ZV93aXRoX2NvbnRyYWN0cyIpOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoImNvc21vX2NvbnRyYWN0cy5tYXJrZG93bi5yZXdyaXRlX3dpdGhfY29udHJhY3RzIGlzIHJlcXVpcmVkIGZvciAnc3luYycuIikKICAgIG5ld190ZXh0ID0gbWFya2Rvd24ucmV3cml0ZV93aXRoX2NvbnRyYWN0cyhtZF9wYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgIGlmIGFyZ3MuY2hlY2s6CiAgICAgICAgaWYgbmV3X3RleHQgIT0gbWRfcGF0aC5yZWFkX3RleHQoZW5jb2Rpbmc9InV0Zi04Iik6CiAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoImNvbnRyYWN0c19vdXRfb2ZfZGF0ZVxuIikKICAgICAgICAgICAgcmV0dXJuIDIKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJjb250cmFjdHNfdXBfdG9fZGF0ZVxuIikKICAgICAgICByZXR1cm4gMAogICAgb3V0X3BhdGgud3JpdGVfdGV4dChuZXdfdGV4dCwgZW5jb2Rpbmc9InV0Zi04IikKICAgIHN5cy5zdGRvdXQud3JpdGUoZiJ3cml0dGVuOntvdXRfcGF0aH1cbiIpCiAgICByZXR1cm4gMApkZWYgY21kX3ZhbGlkYXRlKGFyZ3M6IGFyZ3BhcnNlLk5hbWVzcGFjZSkgLT4gaW50OgogICAgIyBUd28gbW9kZXM6CiAgICAjIChBKSBWYWxpZGF0ZSBjb21wbGlhbmNlLXJlcG9ydCBKU09OIGZpbGVzIChhbHdheXMgc3VwcG9ydGVkKS4KICAgICMgKEIpIElmIGNvc21vX2NvbnRyYWN0cyBoYXMgYSB2YWxpZGF0b3IgQVBJLCBydW4gaXQgYW5kIGVtaXQgYSByZXBvcnQuCiAgICBpZiBhcmdzLnJlcG9ydHM6CiAgICAgICAgcmVzdWx0cyA9IF9sb2FkX3JlcG9ydF9maWxlcyhbUGF0aChwKSBmb3IgcCBpbiBhcmdzLnJlcG9ydHNdKQogICAgICAgIHJlcG9ydCA9IF9hZ2dyZWdhdGUocmVzdWx0cykKICAgIGVsc2U6CiAgICAgICAgdmFsaWRhdG9yID0gX3RyeV9pbXBvcnQoImNvc21vX2NvbnRyYWN0cyIpCiAgICAgICAgaWYgbm90IGhhc2F0dHIodmFsaWRhdG9yLCAidmFsaWRhdGVfY29tcGxpYW5jZSIpOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KAogICAgICAgICAgICAgICAgIk5vIHJlcG9ydHMgcHJvdmlkZWQgYW5kIGNvc21vX2NvbnRyYWN0cy52YWxpZGF0ZV9jb21wbGlhbmNlIG5vdCBhdmFpbGFibGUuICIKICAgICAgICAgICAgICAgICJQcm92aWRlIC0tcmVwb3J0cyBvciBpbnN0YWxsIGZ1bGwgY29zbW9fY29udHJhY3RzIHBhY2thZ2UuIgogICAgICAgICAgICApCiAgICAgICAgcmVwb3J0ID0gdmFsaWRhdG9yLnZhbGlkYXRlX2NvbXBsaWFuY2UoCiAgICAgICAgICAgIGJlbmNobWFya3NfbWQ9UGF0aChhcmdzLmJlbmNobWFya3NfbWQpIGlmIGFyZ3MuYmVuY2htYXJrc19tZCBlbHNlIE5vbmUsCiAgICAgICAgICAgIGltcGxlbWVudGF0aW9ucz1hcmdzLmltcGxlbWVudGF0aW9ucyBvciBbXSwKICAgICAgICApCgogICAgdGV4dCA9IGpzb24uZHVtcHMocmVwb3J0LCBpbmRlbnQ9Miwgc29ydF9rZXlzPVRydWUpCiAgICBpZiBhcmdzLm91dDoKICAgICAgICBQYXRoKGFyZ3Mub3V0KS53cml0ZV90ZXh0KHRleHQgKyAiXG4iLCBlbmNvZGluZz0idXRmLTgiKQogICAgZWxzZToKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKHRleHQgKyAiXG4iKQoKICAgIGZhaWxlZCA9IGludChyZXBvcnQuZ2V0KCJzdW1tYXJ5Iiwge30pLmdldCgiZmFpbGVkIiwgMCkpCiAgICByZXR1cm4gMSBpZiBmYWlsZWQgZWxzZSAwCmRlZiBidWlsZF9wYXJzZXIoKSAtPiBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcjoKICAgIHAgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihwcm9nPSJjb3Ntby1jb250cmFjdHMiLCBkZXNjcmlwdGlvbj0iQ29udHJhY3Qgc2VjdGlvbiBzeW5jICsgY29tcGxpYW5jZSB2YWxpZGF0aW9uIikKICAgIHN1YiA9IHAuYWRkX3N1YnBhcnNlcnMoZGVzdD0iY21kIiwgcmVxdWlyZWQ9VHJ1ZSkKCiAgICBzID0gc3ViLmFkZF9wYXJzZXIoInN5bmMiLCBoZWxwPSJBZGQvdXBkYXRlIHN0YW5kYXJkaXplZCBDb250cmFjdCBzZWN0aW9ucyBpbiB2MC4xIGJlbmNobWFyayBtYXJrZG93biIpCiAgICBzLmFkZF9hcmd1bWVudCgiYmVuY2htYXJrc19tZCIsIGhlbHA9IlBhdGggdG8gYmVuY2htYXJrc192MF8xLm1kIChpbnB1dDsgYWxzbyBvdXRwdXQgaWYgLS1vdXQgbm90IHNldCkiKQogICAgcy5hZGRfYXJndW1lbnQoIi0tb3V0IiwgaGVscD0iV3JpdGUgdXBkYXRlZCBtYXJrZG93biB0byB0aGlzIHBhdGggKGRlZmF1bHQ6IGluLXBsYWNlKSIpCiAgICBzLmFkZF9hcmd1bWVudCgiLS1jaGVjayIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IkRvIG5vdCB3cml0ZTsgZXhpdCAwIGlmIHVwLXRvLWRhdGUgZWxzZSAyIikKICAgIHMuc2V0X2RlZmF1bHRzKGZ1bmM9Y21kX3N5bmMpCgogICAgdiA9IHN1Yi5hZGRfcGFyc2VyKCJ2YWxpZGF0ZSIsIGhlbHA9IlZhbGlkYXRlIGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGNvbXBsaWFuY2UgYW5kIGVtaXQgYSByZXBvcnQiKQogICAgdi5hZGRfYXJndW1lbnQoIi0tYmVuY2htYXJrcy1tZCIsIGRlc3Q9ImJlbmNobWFya3NfbWQiLCBoZWxwPSJPcHRpb25hbCBtYXJrZG93biBwYXRoIGZvciBBUEktZHJpdmVuIHZhbGlkYXRpb24iKQogICAgdi5hZGRfYXJndW1lbnQoIi0taW1wbGVtZW50YXRpb25zIiwgbmFyZ3M9IioiLCBoZWxwPSJPcHRpb25hbCBpbXBsZW1lbnRhdGlvbiBpZGVudGlmaWVycyBmb3IgQVBJLWRyaXZlbiB2YWxpZGF0aW9uIikKICAgIHYuYWRkX2FyZ3VtZW50KCItLXJlcG9ydHMiLCBuYXJncz0iKiIsIGhlbHA9IlBhdGhzIHRvIEpTT04gY29tcGxpYW5jZSByZXBvcnRzIGVtaXR0ZWQgYnkgaW1wbGVtZW50YXRpb25zIikKICAgIHYuYWRkX2FyZ3VtZW50KCItLW91dCIsIGhlbHA9IldyaXRlIEpTT04gcmVwb3J0IHRvIHRoaXMgZmlsZSAoZGVmYXVsdDogc3Rkb3V0KSIpCiAgICB2LnNldF9kZWZhdWx0cyhmdW5jPWNtZF92YWxpZGF0ZSkKCiAgICByZXR1cm4gcAoKCmRlZiBtYWluKGFyZ3Y6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lKSAtPiBpbnQ6CiAgICBhcmdzID0gYnVpbGRfcGFyc2VyKCkucGFyc2VfYXJncyhhcmd2KQogICAgdHJ5OgogICAgICAgIHJldHVybiBpbnQoYXJncy5mdW5jKGFyZ3MpKQogICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogICMgcHJhZ21hOiBubyBjb3ZlcgogICAgICAgIHN5cy5zdGRlcnIud3JpdGUoZiJlcnJvcjp7dHlwZShlKS5fX25hbWVfX306e2V9XG4iKQogICAgICAgIHJldHVybiAxCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjogICMgcHJhZ21hOiBubyBjb3ZlcgogICAgcmFpc2UgU3lzdGVtRXhpdChtYWluKCkpCg==\"}\nDIR_STATE:[\"src/cosmo_contracts/__init__.py\", \"src/cosmo_contracts/__main__.py\", \"src/cosmo_contracts/cli.py\", \"src/cosmo_contracts/contracts.py\", \"src/cosmo_contracts/markdown.py\", \"src/cosmo_contracts/runner.py\", \"src/cosmo_contracts/schema.py\"]\n"
        }
      ]
    },
    {
      "id": "msg_0dd75ba363ea4411006949a524514081959cbe0538759d675e",
      "type": "message",
      "status": "completed",
      "content": [
        {
          "type": "output_text",
          "annotations": [],
          "logprobs": [],
          "text": "FILE_EXPORT:{\"path\":\"src/cosmo_contracts/cli.py\",\"size\":6451,\"encoding\":\"base64\",\"sha256\":\"16c99dd188175e8e7971a143ccdd608b12976c8495dae64f6930234af2b309ef\",\"content\":\"IyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCmZyb20gX19mdXR1cmVfXyBpbXBvcnQgYW5ub3RhdGlvbnMKCmltcG9ydCBhcmdwYXJzZQppbXBvcnQgaW1wb3J0bGliCmltcG9ydCBqc29uCmltcG9ydCBzeXMKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIHR5cGluZyBpbXBvcnQgQW55LCBEaWN0LCBJdGVyYWJsZSwgTGlzdCwgT3B0aW9uYWwsIFR1cGxlCkBkYXRhY2xhc3MKY2xhc3MgQ29tcGxpYW5jZVJlc3VsdDoKICAgIGJlbmNobWFya19pZDogc3RyCiAgICBpbXBsZW1lbnRhdGlvbjogc3RyCiAgICBwYXNzZWQ6IGJvb2wKICAgIGRpYWdub3N0aWNzOiBBbnkgPSBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9qc29uKGNscywgb2JqOiBEaWN0W3N0ciwgQW55XSwgc291cmNlOiBzdHIpIC0+ICJDb21wbGlhbmNlUmVzdWx0IjoKICAgICAgICBtaXNzaW5nID0gW2sgZm9yIGsgaW4gKCJiZW5jaG1hcmtfaWQiLCAiaW1wbGVtZW50YXRpb24iLCAicGFzcyIpIGlmIGsgbm90IGluIG9ial0KICAgICAgICBpZiBtaXNzaW5nOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYie3NvdXJjZX06IG1pc3NpbmcgcmVxdWlyZWQgZmllbGRzOiB7JywgJy5qb2luKG1pc3NpbmcpfSIpCiAgICAgICAgcmV0dXJuIGNscygKICAgICAgICAgICAgYmVuY2htYXJrX2lkPXN0cihvYmpbImJlbmNobWFya19pZCJdKSwKICAgICAgICAgICAgaW1wbGVtZW50YXRpb249c3RyKG9ialsiaW1wbGVtZW50YXRpb24iXSksCiAgICAgICAgICAgIHBhc3NlZD1ib29sKG9ialsicGFzcyJdKSwKICAgICAgICAgICAgZGlhZ25vc3RpY3M9b2JqLmdldCgiZGlhZ25vc3RpY3MiKSwKICAgICAgICApCgogICAgZGVmIHRvX2pzb24oc2VsZikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImJlbmNobWFya19pZCI6IHNlbGYuYmVuY2htYXJrX2lkLAogICAgICAgICAgICAiaW1wbGVtZW50YXRpb24iOiBzZWxmLmltcGxlbWVudGF0aW9uLAogICAgICAgICAgICAicGFzcyI6IHNlbGYucGFzc2VkLAogICAgICAgICAgICAiZGlhZ25vc3RpY3MiOiBzZWxmLmRpYWdub3N0aWNzLAogICAgICAgIH0KZGVmIF90cnlfaW1wb3J0KHBhdGg6IHN0cik6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGltcG9ydGxpYi5pbXBvcnRfbW9kdWxlKHBhdGgpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6ICAjIHByYWdtYTogbm8gY292ZXIKICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoCiAgICAgICAgICAgIGYiRmFpbGVkIHRvIGltcG9ydCAne3BhdGh9Jy4gRW5zdXJlIGNvc21vX2NvbnRyYWN0cyBpcyBpbnN0YWxsZWQgd2l0aCBpdHMgZGVwZW5kZW5jaWVzLlxuIgogICAgICAgICAgICBmIlVuZGVybHlpbmcgZXJyb3I6IHt0eXBlKGUpLl9fbmFtZV9ffToge2V9IgogICAgICAgICkgZnJvbSBlCmRlZiBfcmVhZF9qc29uKHBhdGg6IFBhdGgpIC0+IEFueToKICAgIHRyeToKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhwYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgIGV4Y2VwdCBqc29uLkpTT05EZWNvZGVFcnJvciBhcyBlOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJJbnZhbGlkIEpTT04gaW4ge3BhdGh9OiB7ZX0iKSBmcm9tIGUKCgpkZWYgX2xvYWRfcmVwb3J0X2ZpbGVzKHBhdGhzOiBJdGVyYWJsZVtQYXRoXSkgLT4gTGlzdFtDb21wbGlhbmNlUmVzdWx0XToKICAgIHJlc3VsdHM6IExpc3RbQ29tcGxpYW5jZVJlc3VsdF0gPSBbXQogICAgZm9yIHAgaW4gcGF0aHM6CiAgICAgICAgb2JqID0gX3JlYWRfanNvbihwKQogICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBkaWN0KToKICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoQ29tcGxpYW5jZVJlc3VsdC5mcm9tX2pzb24ob2JqLCBzdHIocCkpKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvYmosIGxpc3QpOgogICAgICAgICAgICBmb3IgaSwgaXRlbSBpbiBlbnVtZXJhdGUob2JqKToKICAgICAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGl0ZW0sIGRpY3QpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoZiJ7cH1be2l9XTogZXhwZWN0ZWQgb2JqZWN0LCBnb3Qge3R5cGUoaXRlbSkuX19uYW1lX199IikKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKENvbXBsaWFuY2VSZXN1bHQuZnJvbV9qc29uKGl0ZW0sIGYie3B9W3tpfV0iKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KGYie3B9OiBleHBlY3RlZCBvYmplY3Qgb3IgYXJyYXksIGdvdCB7dHlwZShvYmopLl9fbmFtZV9ffSIpCiAgICByZXR1cm4gcmVzdWx0cwpkZWYgX2FnZ3JlZ2F0ZShyZXN1bHRzOiBMaXN0W0NvbXBsaWFuY2VSZXN1bHRdKSAtPiBEaWN0W3N0ciwgQW55XToKICAgIHRvdGFsID0gbGVuKHJlc3VsdHMpCiAgICBwYXNzZWQgPSBzdW0oMSBmb3IgciBpbiByZXN1bHRzIGlmIHIucGFzc2VkKQogICAgZmFpbGVkID0gdG90YWwgLSBwYXNzZWQKICAgIGJ5X2JlbmNobWFyazogRGljdFtzdHIsIERpY3Rbc3RyLCBBbnldXSA9IHt9CiAgICBmb3IgciBpbiByZXN1bHRzOgogICAgICAgIGIgPSBieV9iZW5jaG1hcmsuc2V0ZGVmYXVsdChyLmJlbmNobWFya19pZCwgeyJwYXNzZWQiOiAwLCAiZmFpbGVkIjogMCwgInJlc3VsdHMiOiBbXX0pCiAgICAgICAgYlsicGFzZWQiBpZiByLnBhc3NlZCBlbHNlICJmYWlsZWQiXSArPSAxCiAgICAgICAgYlsicmVzdWx0cyJdLmFwcGVuZChyLnRvX2pzb24oKSkKICAgIHJldHVybiB7InN1bW1hcnkiOiB7InRvdGFsIjogdG90YWwsICJwYXNzZWQiOiBwYXNzZWQsICJmYWlsZWQiOiBmYWlsZWR9LCAiYnlfYmVuY2htYXJrIjogYnlfYmVuY2htYXJrfQpkZWYgY21kX3N5bmMoYXJnczogYXJncGFyc2UuTmFtZXNwYWNlKSAtPiBpbnQ6CiAgICBtZF9wYXRoID0gUGF0aChhcmdzLmJlbmNobWFya3NfbWQpCiAgICBvdXRfcGF0aCA9IFBhdGgoYXJncy5vdXQpIGlmIGFyZ3Mub3V0IGVsc2UgbWRfcGF0aAogICAgbWFya2Rvd24gPSBfdHJ5X2ltcG9ydCgiY29zbW9fY29udHJhY3RzLm1hcmtkb3duIikKICAgIGlmIG5vdCBoYXNhdHRyKG1hcmtkb3duLCAicmV3cml0ZV93aXRoX2NvbnRyYWN0cyIpOgogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoImNvc21vX2NvbnRyYWN0cy5tYXJrZG93bi5yZXdyaXRlX3dpdGhfY29udHJhY3RzIGlzIHJlcXVpcmVkIGZvciAnc3luYycuIikKICAgIG5ld190ZXh0ID0gbWFya2Rvd24ucmV3cml0ZV93aXRoX2NvbnRyYWN0cyhtZF9wYXRoLnJlYWRfdGV4dChlbmNvZGluZz0idXRmLTgiKSkKICAgIGlmIGFyZ3MuY2hlY2s6CiAgICAgICAgaWYgbmV3X3RleHQgIT0gbWRfcGF0aC5yZWFkX3RleHQoZW5jb2Rpbmc9InV0Zi04Iik6CiAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoImNvbnRyYWN0c19vdXRfb2ZfZGF0ZVxuIikKICAgICAgICAgICAgcmV0dXJuIDIKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJjb250cmFjdHNfdXBfdG9fZGF0ZVxuIikKICAgICAgICByZXR1cm4gMAogICAgb3V0X3BhdGgud3JpdGVfdGV4dChuZXdfdGV4dCwgZW5jb2Rpbmc9InV0Zi04IikKICAgIHN5cy5zdGRvdXQud3JpdGUoZiJ3cml0dGVuOntvdXRfcGF0aH1cbiIpCiAgICByZXR1cm4gMApkZWYgY21kX3ZhbGlkYXRlKGFyZ3M6IGFyZ3BhcnNlLk5hbWVzcGFjZSkgLT4gaW50OgogICAgIyBUd28gbW9kZXM6CiAgICAjIChBKSBWYWxpZGF0ZSBjb21wbGlhbmNlLXJlcG9ydCBKU09OIGZpbGVzIChhbHdheXMgc3VwcG9ydGVkKS4KICAgICMgKEIpIElmIGNvc21vX2NvbnRyYWN0cyBoYXMgYSB2YWxpZGF0b3IgQVBJLCBydW4gaXQgYW5kIGVtaXQgYSByZXBvcnQuCiAgICBpZiBhcmdzLnJlcG9ydHM6CiAgICAgICAgcmVzdWx0cyA9IF9sb2FkX3JlcG9ydF9maWxlcyhbUGF0aChwKSBmb3IgcCBpbiBhcmdzLnJlcG9ydHNdKQogICAgICAgIHJlcG9ydCA9IF9hZ2dyZWdhdGUocmVzdWx0cykKICAgIGVsc2U6CiAgICAgICAgdmFsaWRhdG9yID0gX3RyeV9pbXBvcnQoImNvc21vX2NvbnRyYWN0cyIpCiAgICAgICAgaWYgbm90IGhhc2F0dHIodmFsaWRhdG9yLCAidmFsaWRhdGVfY29tcGxpYW5jZSIpOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FeGl0KAogICAgICAgICAgICAgICAgIk5vIHJlcG9ydHMgcHJvdmlkZWQgYW5kIGNvc21vX2NvbnRyYWN0cy52YWxpZGF0ZV9jb21wbGlhbmNlIG5vdCBhdmFpbGFibGUuICIKICAgICAgICAgICAgICAgICJQcm92aWRlIC0tcmVwb3J0cyBvciBpbnN0YWxsIGZ1bGwgY29zbW9fY29udHJhY3RzIHBhY2thZ2UuIgogICAgICAgICAgICApCiAgICAgICAgcmVwb3J0ID0gdmFsaWRhdG9yLnZhbGlkYXRlX2NvbXBsaWFuY2UoCiAgICAgICAgICAgIGJlbmNobWFya3NfbWQ9UGF0aChhcmdzLmJlbmNobWFya3NfbWQpIGlmIGFyZ3MuYmVuY2htYXJrc19tZCBlbHNlIE5vbmUsCiAgICAgICAgICAgIGltcGxlbWVudGF0aW9ucz1hcmdzLmltcGxlbWVudGF0aW9ucyBvciBbXSwKICAgICAgICApCgogICAgdGV4dCA9IGpzb24uZHVtcHMocmVwb3J0LCBpbmRlbnQ9Miwgc29ydF9rZXlzPVRydWUpCiAgICBpZiBhcmdzLm91dDoKICAgICAgICBQYXRoKGFyZ3Mub3V0KS53cml0ZV90ZXh0KHRleHQgKyAiXG4iLCBlbmNvZGluZz0idXRmLTgiKQogICAgZWxzZToKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKHRleHQgKyAiXG4iKQoKICAgIGZhaWxlZCA9IGludChyZXBvcnQuZ2V0KCJzdW1tYXJ5Iiwge30pLmdldCgiZmFpbGVkIiwgMCkpCiAgICByZXR1cm4gMSBpZiBmYWlsZWQgZWxzZSAwCmRlZiBidWlsZF9wYXJzZXIoKSAtPiBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcjoKICAgIHAgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihwcm9nPSJjb3Ntby1jb250cmFjdHMiLCBkZXNjcmlwdGlvbj0iQ29udHJhY3Qgc2VjdGlvbiBzeW5jICsgY29tcGxpYW5jZSB2YWxpZGF0aW9uIikKICAgIHN1YiA9IHAuYWRkX3N1YnBhcnNlcnMoZGVzdD0iY21kIiwgcmVxdWlyZWQ9VHJ1ZSkKCiAgICBzID0gc3ViLmFkZF9wYXJzZXIoInN5bmMiLCBoZWxwPSJBZGQvdXBkYXRlIHN0YW5kYXJkaXplZCBDb250cmFjdCBzZWN0aW9ucyBpbiB2MC4xIGJlbmNobWFyayBtYXJrZG93biIpCiAgICBzLmFkZF9hcmd1bWVudCgiYmVuY2htYXJrc19tZCIsIGhlbHA9IlBhdGggdG8gYmVuY2htYXJrc192MF8xLm1kIChpbnB1dDsgYWxzbyBvdXRwdXQgaWYgLS1vdXQgbm90IHNldCkiKQogICAgcy5hZGRfYXJndW1lbnQoIi0tb3V0IiwgaGVscD0iV3JpdGUgdXBkYXRlZCBtYXJrZG93biB0byB0aGlzIHBhdGggKGRlZmF1bHQ6IGluLXBsYWNlKSIpCiAgICBzLmFkZF9hcmd1bWVudCgiLS1jaGVjayIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IkRvIG5vdCB3cml0ZTsgZXhpdCAwIGlmIHVwLXRvLWRhdGUgZWxzZSAyIikKICAgIHMuc2V0X2RlZmF1bHRzKGZ1bmM9Y21kX3N5bmMpCgogICAgdiA9IHN1Yi5hZGRfcGFyc2VyKCJ2YWxpZGF0ZSIsIGhlbHA9IlZhbGlkYXRlIGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGNvbXBsaWFuY2UgYW5kIGVtaXQgYSByZXBvcnQiKQogICAgdi5hZGRfYXJndW1lbnQoIi0tYmVuY2htYXJrcy1tZCIsIGRlc3Q9ImJlbmNobWFya3NfbWQiLCBoZWxwPSJPcHRpb25hbCBtYXJrZG93biBwYXRoIGZvciBBUEktZHJpdmVuIHZhbGlkYXRpb24iKQogICAgdi5hZGRfYXJndW1lbnQoIi0taW1wbGVtZW50YXRpb25zIiwgbmFyZ3M9IioiLCBoZWxwPSJPcHRpb25hbCBpbXBsZW1lbnRhdGlvbiBpZGVudGlmaWVycyBmb3IgQVBJLWRyaXZlbiB2YWxpZGF0aW9uIikKICAgIHYuYWRkX2FyZ3VtZW50KCItLXJlcG9ydHMiLCBuYXJncz0iKiIsIGhlbHA9IlBhdGhzIHRvIEpTT04gY29tcGxpYW5jZSByZXBvcnRzIGVtaXR0ZWQgYnkgaW1wbGVtZW50YXRpb25zIikKICAgIHYuYWRkX2FyZ3VtZW50KCItLW91dCIsIGhlbHA9IldyaXRlIEpTT04gcmVwb3J0IHRvIHRoaXMgZmlsZSAoZGVmYXVsdDogc3Rkb3V0KSIpCiAgICB2LnNldF9kZWZhdWx0cyhmdW5jPWNtZF92YWxpZGF0ZSkKCiAgICByZXR1cm4gcAoKCmRlZiBtYWluKGFyZ3Y6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lKSAtPiBpbnQ6CiAgICBhcmdzID0gYnVpbGRfcGFyc2VyKCkucGFyc2VfYXJncyhhcmd2KQogICAgdHJ5OgogICAgICAgIHJldHVybiBpbnQoYXJncy5mdW5jKGFyZ3MpKQogICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogICMgcHJhZ21hOiBubyBjb3ZlcgogICAgICAgIHN5cy5zdGRlcnIud3JpdGUoZiJlcnJvcjp7dHlwZShlKS5fX25hbWVfX306e2V9XG4iKQogICAgICAgIHJldHVybiAxCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjogICMgcHJhZ21hOiBubyBjb3ZlcgogICAgcmFpc2UgU3lzdGVtRXhpdChtYWluKCkpCg==\"}\nDIR_STATE:[\"src/cosmo_contracts/__init__.py\",\"src/cosmo_contracts/__main__.py\",\"src/cosmo_contracts/cli.py\",\"src/cosmo_contracts/contracts.py\",\"src/cosmo_contracts/markdown.py\",\"src/cosmo_contracts/runner.py\",\"src/cosmo_contracts/schema.py\"]"
        }
      ],
      "role": "assistant"
    }
  ],
  "codeResults": []
}