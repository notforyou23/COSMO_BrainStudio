{
  "content": "FILE_EXPORT:{\"path\":\"src/cosmo_contracts/runner.py\",\"size\":8470,\"encoding\":\"base64\",\"sha256\":\"e689c221fa7a29887e1859ce68b9278624d56d507f7c2597c82fcae0523a1651\",\"content\":\"IiIiY29zbW9fY29udHJhY3RzLnJ1bm5lcgoKUnVucyBjb250cmlidXRlZCBiZW5jaG1hcmsgaW1wbGVtZW50YXRpb25zIGFnYWluc3QgY2Fub25pY2FsIGNvbnRyYWN0IHRlc3QgdmVjdG9ycwphbmQgcHJvZHVjZXMgYSBwZXItY29udHJhY3QgY29tcGxpYW5jZSByZXBvcnQgKHBhc3MvZmFpbCArIGRpYWdub3N0aWNzKS4KClRoaXMgbW9kdWxlIGlzIGludGVudGlvbmFsbHkgc2VsZi1jb250YWluZWQgc28gaXQgY2FuIGJlIHVzZWQgZXZlbiB3aGVuIG9ubHkKY29udHJhY3RzIChkaWN0cykgYW5kIGltcGxlbWVudGF0aW9ucyAoY2FsbGFibGVzL2ltcG9ydCBwYXRocykgYXJlIGF2YWlsYWJsZS4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSBpbXBvcnRsaWIgaW1wb3J0IGltcG9ydF9tb2R1bGUKZnJvbSB0eXBpbmcgaW1wb3J0IEFueSwgQ2FsbGFibGUsIERpY3QsIEl0ZXJhYmxlLCBMaXN0LCBNYXBwaW5nLCBPcHRpb25hbCwgVHVwbGUsIFVuaW9uCk51bWJlciA9IFVuaW9uW2ludCwgZmxvYXRdCgoKZGVmIF9pc19udW1iZXIoeDogQW55KSAtPiBib29sOgogICAgcmV0dXJuIGlzaW5zdGFuY2UoeCwgKGludCwgZmxvYXQpKSBhbmQgbm90IGlzaW5zdGFuY2UoeCwgYm9vbCkKCgpkZWYgX2l0ZXJhYmxlKHg6IEFueSkgLT4gYm9vbDoKICAgIHJldHVybiBpc2luc3RhbmNlKHgsIChsaXN0LCB0dXBsZSkpCgoKZGVmIF9sb2FkX2ltcGwoc3BlYzogVW5pb25bc3RyLCBDYWxsYWJsZVsuLi4sIEFueV1dKSAtPiBDYWxsYWJsZVsuLi4sIEFueV06CiAgICAiIiJMb2FkIGFuIGltcGxlbWVudGF0aW9uIGZyb20gYSBjYWxsYWJsZSBvciBhICdtb2R1bGU6YXR0cicgc3RyaW5nLiIiIgogICAgaWYgY2FsbGFibGUoc3BlYyk6CiAgICAgICAgcmV0dXJuIHNwZWMKICAgIGlmIG5vdCBpc2luc3RhbmNlKHNwZWMsIHN0cikgb3IgIjoiIG5vdCBpbiBzcGVjOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiSW1wbGVtZW50YXRpb24gc3BlYyBtdXN0IGJlIGNhbGxhYmxlIG9yICdtb2R1bGU6YXR0cicgc3RyaW5nIikKICAgIG1vZCwgYXR0ciA9IHNwZWMu c3BsaXQoIjoiLCAxKQogICAgZm4gPSBnZXRhdHRyKGltcG9ydF9tb2R1bGUobW9kKSwgYXR0cikKICAgIGlmIG5vdCBjYWxsYWJsZShmbik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKGYiTG9hZGVkIG9iamVjdCB7c3BlYyFyfSBpcyBub3QgY2FsbGFibGUiKQogICAgcmV0dXJuIGZuCmRlZiBfYXBwcm94X2VxdWFsKGE6IEFueSwgYjogQW55LCAqLCBhdG9sOiBmbG9hdCwgcnRvbDogZmxvYXQpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiJEZWVwIGFwcHJveGltYXRlIGVxdWFsaXR5IHdpdGggdXNlZnVsIGRpYWdub3N0aWNzIChubyBudW1weSByZXF1aXJlZCkuIiIiCiAgICBpZiBhIGlzIGI6CiAgICAgICAgcmV0dXJuIFRydWUsICIiCiAgICBpZiBfaXNfbnVtYmVyKGEpIGFuZCBfaXNfbnVtYmVyKGIpOgogICAgICAgIGRpZmYgPSBhYnMoYSAtIGIpCiAgICAgICAgdG9sID0gYXRvbCArIHJ0b2wgKiBhYnMoYikKICAgICAgICBvayA9IGRpZmYgPD0gdG9sCiAgICAgICAgcmV0dXJuIG9rLCBmImFic19kaWZmPXtkaWZmfSB0b2w9e3RvbH0gYT17YX0gYj17Yn0iIGlmIG5vdCBvayBlbHNlICIiCiAgICBpZiBpc2luc3RhbmNlKGEsIHN0cikgb3IgaXNpbnN0YW5jZShiLCBzdHIpOgogICAgICAgIG9rID0gYSA9PSBiCiAgICAgICAgcmV0dXJuIG9rLCBmImE9e2Ehcn0gYj17YiFyfSIgaWYgbm90IG9rIGVsc2UgIiIKICAgIGlmIGlzaW5zdGFuY2UoYSwgTWFwcGluZykgYW5kIGlzaW5zdGFuY2UoYiwgTWFwcGluZyk6CiAgICAgICAgaWYgc2V0KGEua2V5cygpKSAhPSBzZXQoYi5rZXlzKCkpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGYiZGljdF9rZXlzIGE9e3NvcnRlZChhLmtleXMoKSl9IGI9e3NvcnRlZChiLmtleXMoKSl9IgogICAgICAgIGZvciBrIGluIGE6CiAgICAgICAgICAgIG9rLCBkaWFnID0gX2FwcHJveF9lcXVhbChhW2tdLCBiW2tdLCBhdG9sPWF0b2wsIHJ0b2w9cnRvbCkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImtleT17ayFyfToge2RpYWd9IgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgX2l0ZXJhYmxlKGEpIGFuZCBfaXRlcmFibGUoYik6CiAgICAgICAgaWYgbGVuKGEpICE9IGxlbihiKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImxlbiBhPXtsZW4oYSl9IGI9e2xlbihiKX0iCiAgICAgICAgZm9yIGksIChhaSwgYmkpIGluIGVudW1lcmF0ZSh6aXAoYSwgYikpOgogICAgICAgICAgICBvaywgZGlhZyA9IF9hcHByb3hfZXF1YWwoYWksIGJpLCBhdG9sPWF0b2wsIHJ0b2w9cnRvbCkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImlkeD17aX06IHtkaWFnfSIKICAgICAgICByZXR1cm4gVHJ1ZSwgIiIKICAgIG9rID0gYSA9PSBiCiAgICByZXR1cm4gb2ssIGYiYT17YSFyfSBiPXtiIXJ9IiBpZiBub3Qgb2sgZWxzZSAiIgpkZWYgX2V4YWN0X2VxdWFsKGE6IEFueSwgYjogQW55KSAtPiBUdXBsZVtib29sLCBzdHJdOgogICAgaWYgYSBpcyBiOgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgaXNpbnN0YW5jZShhLCBNYXBwaW5nKSBhbmQgaXNpbnN0YW5jZShiLCBNYXBwaW5nKToKICAgICAgICBpZiBzZXQoYS5rZXlzKCkpICE9IHNldChiLmtleXMoKSk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZiJkaWN0X2tleXMgYT17c29ydGVkKGEua2V5cygpKX0gYj17c29ydGVkKGIua2V5cygpKX0iCiAgICAgICAgZm9yIGsgaW4gYToKICAgICAgICAgICAgb2ssIGRpYWcgPSBfZXhhY3RfZXF1YWwoYVtrXSwgYltrXSkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImtleT17ayFyfToge2RpYWd9IgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgX2l0ZXJhYmxlKGEpIGFuZCBfaXRlcmFibGUoYik6CiAgICAgICAgaWYgbGVuKGEpICE9IGxlbihiKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImxlbiBhPXtsZW4oYSl9IGI9e2xlbihiKX0iCiAgICAgICAgZm9yIGksIChhaSwgYmkpIGluIGVudW1lcmF0ZSh6aXAoYSwgYikpOgogICAgICAgICAgICBvaywgZGlhZyA9IF9leGFjdF9lcXVhbChhaSwgYmkpCiAgICAgICAgICAgIGlmIG5vdCBvazoKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZiJpZHg9e2l9OiB7ZGlhZ30iCiAgICAgICAgcmV0dXJuIFRydWUsICIiCiAgICBvayA9IGEgPT0gYgogICAgcmV0dXJuIG9rLCBmImE9e2Ehcn0gYj17YiFyfSIgaWYgbm90IG9rIGVsc2UgIiIKZGVmIHZhbGlkYXRlX2NvbnRyYWN0KGNvbnRyYWN0OiBNYXBwaW5nW3N0ciwgQW55XSkgLT4gTGlzdFtzdHJdOgogICAgIiIiUmV0dXJuIGRpYWdub3N0aWNzIChlbXB0eSA9PiBzdHJ1Y3R1cmFsbHkgT0spLiIiIgogICAgcmVxdWlyZWQgPSBbImlkIiwgIm1ldGFkYXRhIiwgInJlZmVyZW5jZSIsICJpbnZhcmlhbnRzIiwgInRvbGVyYW5jZSIsICJ0ZXN0X3ZlY3RvciJdCiAgICBkaWFnczogTGlzdFtzdHJdID0gW10KICAgIGZvciBrIGluIHJlcXVpcmVkOgogICAgICAgIGlmIGsgbm90IGluIGNvbnRyYWN0OgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJtaXNzaW5nX3NlY3Rpb246e2t9IikKICAgIG1ldGFfcmVxID0gWyJuYW1lIiwgInZlcnNpb24iXQogICAgbWQgPSBjb250cmFjdC5nZXQoIm1ldGFkYXRhIikgaWYgaXNpbnN0YW5jZShjb250cmFjdC5nZXQoIm1ldGFkYXRhIiksIE1hcHBpbmcpIGVsc2Uge30KICAgIGZvciBrIGluIG1ldGFfcmVxOgogICAgICAgIGlmIGsgbm90IGluIG1kOgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJtaXNzaW5nX21ldGFkYXRhOntrfSIpCiAgICB0diA9IGNvbnRyYWN0LmdldCgidGVzdF92ZWN0b3IiKQogICAgaWYgdHYgaXMgTm9uZSBvciBub3QgaXNpbnN0YW5jZSh0diwgTWFwcGluZyk6CiAgICAgICAgZGlhZ3MuYXBwZW5kKCJpbnZhbGlkX3Rlc3RfdmVjdG9yIikKICAgIGVsc2U6CiAgICAgICAgaWYgbm90IGFueShrIGluIHR2IGZvciBrIGluICgiYXJncyIsICJrd2FyZ3MiLCAiaW5wdXQiKSk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZCgidGVzdF92ZWN0b3JfbWlzc2luZ19pbnB1dHMiKQogICAgICAgIGlmICJleHBlY3RlZCIgbm90IGluIHR2OgogICAgICAgICAgICBkaWFncy5hcHBlbmQoInRlc3RfdmVjdG9yX21pc3NpbmdfZXhwZWN0ZWQiKQogICAgdG9sID0gY29udHJhY3QuZ2V0KCJ0b2xlcmFuY2UiKQogICAgaWYgaXNpbnN0YW5jZSh0b2wsIE1hcHBpbmcpOgogICAgICAgIHBvbCA9IHRvbC5nZXQoInBvbGljeSIsICJleGFjdCIpCiAgICAgICAgaWYgcG9sIG5vdCBpbiAoImV4YWN0IiwgImFwcHJveCIpOgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhbGlkX3RvbGVyYW5jZV9wb2xpY3k6e3BvbH0iKQogICAgcmV0dXJuIGRpYWdzCmRlZiBfYXBwbHlfaW52YXJpYW50cyhpbnZhcmlhbnRzOiBNYXBwaW5nW3N0ciwgQW55XSwgb3V0cHV0OiBBbnkpIC0+IExpc3Rbc3RyXToKICAgIGRpYWdzOiBMaXN0W3N0cl0gPSBbXQogICAgaWYgbm90IGlzaW5zdGFuY2UoaW52YXJpYW50cywgTWFwcGluZyk6CiAgICAgICAgcmV0dXJuIGRpYWdzCiAgICB0ID0gaW52YXJpYW50cy5nZXQoIm91dHB1dF90eXBlIikKICAgIGlmIHQ6CiAgICAgICAgYWxsb3dlZCA9IHR1cGxlKGdldGF0dHIoX19idWlsdGluc19fLCB0LCBvYmplY3QpIGZvciB0IGluIChbdF0gaWYgaXNpbnN0YW5jZSh0LCBzdHIpIGVsc2UgdCkpCiAgICAgICAgaWYgYWxsb3dlZCBhbmQgbm90IGlzaW5zdGFuY2Uob3V0cHV0LCBhbGxvd2VkKToKICAgICAgICAgICAgZGlhZ3MuYXBwZW5kKGYiaW52YXJpYW50X291dHB1dF90eXBlX2ZhaWxlZDogZ290PXt0eXBlKG91dHB1dCkuX19uYW1lX199IikKICAgIGtleXMgPSBpbnZhcmlhbnRzLmdldCgiZGljdF9rZXlzIikKICAgIGlmIGtleXMgaXMgbm90IE5vbmU6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3V0cHV0LCBNYXBwaW5nKToKICAgICAgICAgICAgZGlhZ3MuYXBwZW5kKCJpbnZhcmlhbnRfZGljdF9rZXlzX2ZhaWxlZDpub3RfYV9kaWN0IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBtaXNzaW5nID0gW2sgZm9yIGsgaW4ga2V5cyBpZiBrIG5vdCBpbiBvdXRwdXRdCiAgICAgICAgICAgIGV4dHJhID0gW2sgZm9yIGsgaW4gb3V0cHV0LmtleXMoKSBpZiBrIG5vdCBpbiBzZXQoa2V5cyldCiAgICAgICAgICAgIGlmIG1pc3Npbmc6CiAgICAgICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhcmlhbnRfZGljdF9taXNzaW5nX2tleXM6e21pc3Npbmd9IikKICAgICAgICAgICAgaWYgZXh0cmE6CiAgICAgICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhcmlhbnRfZGljdF9leHRyYV9rZXlzOntzb3J0ZWQoZXh0cmEpfSIpCiAgICBsZW5ndGggPSBpbnZhcmlhbnRzLmdldCgibGVuZ3RoIikKICAgIGlmIGxlbmd0aCBpcyBub3QgTm9uZToKICAgICAgICBpZiBub3QgX2l0ZXJhYmxlKG91dHB1dCk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZCgiaW52YXJpYW50X2xlbmd0aF9mYWlsZWQ6bm90X2Ffc2VxdWVuY2UiKQogICAgICAgIGVsaWYgbGVuKG91dHB1dCkgIT0gaW50KGxlbmd0aCk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZChmImludmFyaWFudF9sZW5ndGhfZmFpbGVkOiBnb3Q9e2xlbihvdXRwdXQpfSBleHBlY3RlZD17aW50KGxlbmd0aCl9IikKICAgIHJldHVybiBkaWFncwpAZGF0YWNsYXNzCmNsYXNzIENvbXBsaWFuY2VSZXN1bHQ6CiAgICBiZW5jaG1hcmtfaWQ6IHN0cgogICAgcGFzc2VkOiBib29sCiAgICBkaWFnbm9zdGljczogTGlzdFtzdHJdCiAgICBleHBlY3RlZDogQW55ID0gTm9uZQogICAgYWN0dWFsOiBBbnkgPSBOb25lCgoKZGVmIHJ1bl9jb250cmFjdChjb250cmFjdDogTWFwcGluZ1tzdHIsIEFueV0sIGltcGw6IFVuaW9uW3N0ciwgQ2FsbGFibGVbLi4uLCBBbnldXSkgLT4gQ29tcGxpYW5jZVJlc3VsdDoKICAgIGJpZCA9IHN0cihjb250cmFjdC5nZXQoImlkIiwgIjx1bmtub3duPiIpKQogICAgZGlhZ3MgPSB2YWxpZGF0ZV9jb250cmFjdChjb250cmFjdCkKICAgIGlmIGRpYWdzOgogICAgICAgIHJldHVybiBDb21wbGlhbmNlUmVzdWx0KGJpZCwgRmFsc2UsIGRpYWdzKQoKICAgIGZuID0gX2xvYWRfaW1wbChpbXBsKQogICAgdHYgPSBjb250cmFjdFsidGVzdF92ZWN0b3IiXQogICAgYXJncyA9IHR2LmdldCgiYXJncyIpCiAgICBrd2FyZ3MgPSB0di5nZXQoImt3YXJncyIpCiAgICBpZiAiaW5wdXQiIGluIHR2IGFuZCBhcmdzIGlzIE5vbmUgYW5kIGt3YXJncyBpcyBOb25lOgogICAgICAgIGlucCA9IHR2WyJpbnB1dCJdCiAgICAgICAgYXJncyA9IGlucC5nZXQoImFyZ3MiLCBbXSkgaWYgaXNpbnN0YW5jZShpbnAsIE1hcHBpbmcpIGVsc2UgW2lucF0KICAgICAgICBrd2FyZ3MgPSBpbnAuZ2V0KCJrd2FyZ3MiLCB7fSkgaWYgaXNpbnN0YW5jZShpbnAsIE1hcHBpbmcpIGVsc2Uge30KICAgIGFyZ3MgPSBsaXN0KGFyZ3MpIGlmIGFyZ3MgaXMgbm90IE5vbmUgZWxzZSBbXQogICAga3dhcmdzID0gZGljdChrd2FyZ3MpIGlmIGt3YXJncyBpcyBub3QgTm9uZSBlbHNlIHt9CiAgICBleHBlY3RlZCA9IHR2LmdldCgiZXhwZWN0ZWQiKQoKICAgIHRyeToKICAgICAgICBhY3R1YWwgPSBmbigqYXJncywgKiprd2FyZ3MpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6ICAjIG5vcWE6IEJMRTAwMQogICAgICAgIHJldHVybiBDb21wbGlhbmNlUmVzdWx0KGJpZCwgRmFsc2UsIFtmImV4Y2VwdGlvbjp7dHlwZShlKS5fX25hbWVfX306e2V9Il0sIGV4cGVjdGVkPWV4cGVjdGVkKQoKICAgIGRpYWdzLmV4dGVuZChfYXBwbHlfaW52YXJpYW50cyhjb250cmFjdC5nZXQoImludmFyaWFudHMiLCB7fSksIGFjdHVhbCkpCgogICAgdG9sID0gY29udHJhY3QuZ2V0KCJ0b2xlcmFuY2UiLCB7fSkgaWYgaXNpbnN0YW5jZShjb250cmFjdC5nZXQoInRvbGVyYW5jZSIpLCBNYXBwaW5nKSBlbHNlIHt9CiAgICBwb2xpY3kgPSB0b2wuZ2V0KCJwb2xpY3kiLCAiZXhhY3QiKQogICAgaWYgcG9saWN5ID09ICJhcHByb3giOgogICAgICAgIGF0b2wgPSBmbG9hdCh0b2wuZ2V0KCJhdG9sIiwgMC4wKSkKICAgICAgICBydG9sID0gZmxvYXQodG9sLmdldCgicnRvbCIsIDAuMCkpCiAgICAgICAgb2ssIGRpYWcgPSBfYXBwcm94X2VxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIGF0b2w9YXRvbCwgcnRvbD1ydG9sKQogICAgZWxzZToKICAgICAgICBvaywgZGlhZyA9IF9leGFjdF9lcXVhbChhY3R1YWwsIGV4cGVjdGVkKQogICAgaWYgbm90IG9rOgogICAgICAgIGRpYWdzLmFwcGVuZChmIm1pc21hdGNoOntkaWFnfSIpCiAgICBwYXNzZWQgPSBvayBhbmQgbm90IGRpYWdzCiAgICByZXR1cm4gQ29tcGxpYW5jZVJlc3VsdChiaWQsIHBhc3NlZCwgZGlhZ3MsIGV4cGVjdGVkPWV4cGVjdGVkLCBhY3R1YWw9YWN0dWFsKQpkZWYgcnVuX2NvbXBsaWFuY2UoCiAgICBjb250cmFjdHM6IEl0ZXJhYmxlW01hcHBpbmdbc3RyLCBBbnldXSwKICAgIGltcGxlbWVudGF0aW9uczogTWFwcGluZ1tzdHIsIFVuaW9uW3N0ciwgQ2FsbGFibGVbLi4uLCBBbnldXV0sCikgLT4gRGljdFtzdHIsIEFueV06CiAgICAiIiJSdW4gYWxsIGNvbnRyYWN0cyBhZ2FpbnN0IHByb3ZpZGVkIGltcGxlbWVudGF0aW9ucy4KCiAgICBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgZGljdCBrZXllZCBieSBiZW5jaG1hcmsgaWQ6CiAgICB7aWQ6IHtwYXNzZWQ6IGJvb2wsIGRpYWdub3N0aWNzOiBbLi4uXSwgZXhwZWN0ZWQ6IC4uLiwgYWN0dWFsOiAuLi59fQogICAgIiIiCiAgICByZXBvcnQ6IERpY3Rbc3RyLCBBbnldID0ge30KICAgIGZvciBjIGluIGNvbnRyYWN0czoKICAgICAgICBiaWQgPSBzdHIoYy5nZXQoImlkIiwgIjx1bmtub3duPiIpKQogICAgICAgIGltcGwgPSBpbXBsZW1lbnRhdGlvbnMuZ2V0KGJpZCkKICAgICAgICBpZiBpbXBsIGlzIE5vbmU6CiAgICAgICAgICAgIHJlcG9ydFtiaWRdID0geyJwYXNzZWQiOiBGYWxzZSwgImRpYWdub3N0aWNzIjogWyJtaXNzaW5nX2ltcGxlbWVudGF0aW9uIl19CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmVzID0gcnVuX2NvbnRyYWN0KGMsIGltcGwpCiAgICAgICAgcmVwb3J0W2JpZF0gPSB7CiAgICAgICAgICAgICJwYXNzZWQiOiBib29sKHJlcy5wYXNzZWQpLAogICAgICAgICAgICAiZGlhZ25vc3RpY3MiOiBsaXN0KHJlcy5kaWFnbm9zdGljcyksCiAgICAgICAgfQogICAgICAgIGlmIG5vdCByZXMucGFzc2VkOgogICAgICAgICAgICByZXBvcnRbYmlkXVsiZXhwZWN0ZWQiXSA9IHJlcy5leHBlY3RlZAogICAgICAgICAgICByZXBvcnRbYmlkXVsiYWN0dWFsIl0gPSByZXMuYWN0dWFsCiAgICByZXR1cm4gcmVwb3J0Cg==\"}\nDIR_STATE:[\"src/cosmo_contracts/__init__.py\",\"src/cosmo_contracts/__main__.py\",\"src/cosmo_contracts/cli.py\",\"src/cosmo_contracts/contracts.py\",\"src/cosmo_contracts/markdown.py\",\"src/cosmo_contracts/runner.py\",\"src/cosmo_contracts/schema.py\"]",
  "reasoning": "",
  "responseId": "resp_009afc5fbbe4ba33006949a4e60adc8193b7651cdbd614d416",
  "model": "gpt-5.2-2025-12-11",
  "usage": {
    "input_tokens": 8297,
    "input_tokens_details": {
      "cached_tokens": 0
    },
    "output_tokens": 7255,
    "output_tokens_details": {
      "reasoning_tokens": 47
    },
    "total_tokens": 15552
  },
  "hadError": false,
  "errorType": null,
  "webSearchSources": [],
  "citations": [],
  "output": [
    {
      "id": "rs_009afc5fbbe4ba33006949a4e6c4fc8193a696b1de0914c2ac",
      "type": "reasoning",
      "summary": []
    },
    {
      "id": "ci_009afc5fbbe4ba33006949a4e7bfc88193aa0fd3cc861d0014",
      "type": "code_interpreter_call",
      "status": "completed",
      "code": "from pathlib import Path\nimport base64, json, hashlib, gzip\n\ntarget_path = Path('/mnt/data').joinpath('src/cosmo_contracts/runner.py')\nassert target_path.is_file(), 'Expected src/cosmo_contracts/runner.py to exist before export'\ndata = target_path.read_bytes()\n\npayload = {\n    'path': 'src/cosmo_contracts/runner.py',\n    'size': len(data),\n    'encoding': 'base64',\n    'sha256': hashlib.sha256(data).hexdigest(),\n    'content': None\n}\n\nif len(data) > 20000:\n    compressed = gzip.compress(data)\n    payload['encoding'] = 'gzip+base64'\n    payload['content'] = base64.b64encode(compressed).decode('ascii')\nelse:\n    payload['content'] = base64.b64encode(data).decode('ascii')\n\nprint('FILE_EXPORT:' + json.dumps(payload, separators=(',', ':')))\nprint('DIR_STATE:' + json.dumps(sorted(str(p.relative_to(Path(\"/mnt/data\"))) for p in target_path.parent.glob('*') if p.is_file())))",
      "container_id": "cntr_6949a1d5445881908092d2723527a8b207f782e9910e8fd5",
      "outputs": [
        {
          "type": "logs",
          "logs": "FILE_EXPORT:{\"path\":\"src/cosmo_contracts/runner.py\",\"size\":8470,\"encoding\":\"base64\",\"sha256\":\"e689c221fa7a29887e1859ce68b9278624d56d507f7c2597c82fcae0523a1651\",\"content\":\"IiIiY29zbW9fY29udHJhY3RzLnJ1bm5lcgoKUnVucyBjb250cmlidXRlZCBiZW5jaG1hcmsgaW1wbGVtZW50YXRpb25zIGFnYWluc3QgY2Fub25pY2FsIGNvbnRyYWN0IHRlc3QgdmVjdG9ycwphbmQgcHJvZHVjZXMgYSBwZXItY29udHJhY3QgY29tcGxpYW5jZSByZXBvcnQgKHBhc3MvZmFpbCArIGRpYWdub3N0aWNzKS4KClRoaXMgbW9kdWxlIGlzIGludGVudGlvbmFsbHkgc2VsZi1jb250YWluZWQgc28gaXQgY2FuIGJlIHVzZWQgZXZlbiB3aGVuIG9ubHkKY29udHJhY3RzIChkaWN0cykgYW5kIGltcGxlbWVudGF0aW9ucyAoY2FsbGFibGVzL2ltcG9ydCBwYXRocykgYXJlIGF2YWlsYWJsZS4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSBpbXBvcnRsaWIgaW1wb3J0IGltcG9ydF9tb2R1bGUKZnJvbSB0eXBpbmcgaW1wb3J0IEFueSwgQ2FsbGFibGUsIERpY3QsIEl0ZXJhYmxlLCBMaXN0LCBNYXBwaW5nLCBPcHRpb25hbCwgVHVwbGUsIFVuaW9uCk51bWJlciA9IFVuaW9uW2ludCwgZmxvYXRdCgoKZGVmIF9pc19udW1iZXIoeDogQW55KSAtPiBib29sOgogICAgcmV0dXJuIGlzaW5zdGFuY2UoeCwgKGludCwgZmxvYXQpKSBhbmQgbm90IGlzaW5zdGFuY2UoeCwgYm9vbCkKCgpkZWYgX2l0ZXJhYmxlKHg6IEFueSkgLT4gYm9vbDoKICAgIHJldHVybiBpc2luc3RhbmNlKHgsIChsaXN0LCB0dXBsZSkpCgoKZGVmIF9sb2FkX2ltcGwoc3BlYzogVW5pb25bc3RyLCBDYWxsYWJsZVsuLi4sIEFueV1dKSAtPiBDYWxsYWJsZVsuLi4sIEFueV06CiAgICAiIiJMb2FkIGFuIGltcGxlbWVudGF0aW9uIGZyb20gYSBjYWxsYWJsZSBvciBhICdtb2R1bGU6YXR0cicgc3RyaW5nLiIiIgogICAgaWYgY2FsbGFibGUoc3BlYyk6CiAgICAgICAgcmV0dXJuIHNwZWMKICAgIGlmIG5vdCBpc2luc3RhbmNlKHNwZWMsIHN0cikgb3IgIjoiIG5vdCBpbiBzcGVjOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiSW1wbGVtZW50YXRpb24gc3BlYyBtdXN0IGJlIGNhbGxhYmxlIG9yICdtb2R1bGU6YXR0cicgc3RyaW5nIikKICAgIG1vZCwgYXR0ciA9IHNwZWMuc3BsaXQoIjoiLCAxKQogICAgZm4gPSBnZXRhdHRyKGltcG9ydF9tb2R1bGUobW9kKSwgYXR0cikKICAgIGlmIG5vdCBjYWxsYWJsZShmbik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKGYiTG9hZGVkIG9iamVjdCB7c3BlYyFyfSBpcyBub3QgY2FsbGFibGUiKQogICAgcmV0dXJuIGZuCmRlZiBfYXBwcm94X2VxdWFsKGE6IEFueSwgYjogQW55LCAqLCBhdG9sOiBmbG9hdCwgcnRvbDogZmxvYXQpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiJEZWVwIGFwcHJveGltYXRlIGVxdWFsaXR5IHdpdGggdXNlZnVsIGRpYWdub3N0aWNzIChubyBudW1weSByZXF1aXJlZCkuIiIiCiAgICBpZiBhIGlzIGI6CiAgICAgICAgcmV0dXJuIFRydWUsICIiCiAgICBpZiBfaXNfbnVtYmVyKGEpIGFuZCBfaXNfbnVtYmVyKGIpOgogICAgICAgIGRpZmYgPSBhYnMoYSAtIGIpCiAgICAgICAgdG9sID0gYXRvbCArIHJ0b2wgKiBhYnMoYikKICAgICAgICBvayA9IGRpZmYgPD0gdG9sCiAgICAgICAgcmV0dXJuIG9rLCBmImFic19kaWZmPXtkaWZmfSB0b2w9e3RvbH0gYT17YX0gYj17Yn0iIGlmIG5vdCBvayBlbHNlICIiCiAgICBpZiBpc2luc3RhbmNlKGEsIHN0cikgb3IgaXNpbnN0YW5jZShiLCBzdHIpOgogICAgICAgIG9rID0gYSA9PSBiCiAgICAgICAgcmV0dXJuIG9rLCBmImE9e2Ehcn0gYj17YiFyfSIgaWYgbm90IG9rIGVsc2UgIiIKICAgIGlmIGlzaW5zdGFuY2UoYSwgTWFwcGluZykgYW5kIGlzaW5zdGFuY2UoYiwgTWFwcGluZyk6CiAgICAgICAgaWYgc2V0KGEua2V5cygpKSAhPSBzZXQoYi5rZXlzKCkpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGYiZGljdF9rZXlzIGE9e3NvcnRlZChhLmtleXMoKSl9IGI9e3NvcnRlZChiLmtleXMoKSl9IgogICAgICAgIGZvciBrIGluIGE6CiAgICAgICAgICAgIG9rLCBkaWFnID0gX2FwcHJveF9lcXVhbChhW2tdLCBiW2tdLCBhdG9sPWF0b2wsIHJ0b2w9cnRvbCkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImtleT17ayFyfToge2RpYWd9IgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgX2l0ZXJhYmxlKGEpIGFuZCBfaXRlcmFibGUoYik6CiAgICAgICAgaWYgbGVuKGEpICE9IGxlbihiKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImxlbiBhPXtsZW4oYSl9IGI9e2xlbihiKX0iCiAgICAgICAgZm9yIGksIChhaSwgYmkpIGluIGVudW1lcmF0ZSh6aXAoYSwgYikpOgogICAgICAgICAgICBvaywgZGlhZyA9IF9hcHByb3hfZXF1YWwoYWksIGJpLCBhdG9sPWF0b2wsIHJ0b2w9cnRvbCkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImlkeD17aX06IHtkaWFnfSIKICAgICAgICByZXR1cm4gVHJ1ZSwgIiIKICAgIG9rID0gYSA9PSBiCiAgICByZXR1cm4gb2ssIGYiYT17YSFyfSBiPXtiIXJ9IiBpZiBub3Qgb2sgZWxzZSAiIgpkZWYgX2V4YWN0X2VxdWFsKGE6IEFueSwgYjogQW55KSAtPiBUdXBsZVtib29sLCBzdHJdOgogICAgaWYgYSBpcyBiOgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgaXNpbnN0YW5jZShhLCBNYXBwaW5nKSBhbmQgaXNpbnN0YW5jZShiLCBNYXBwaW5nKToKICAgICAgICBpZiBzZXQoYS5rZXlzKCkpICE9IHNldChiLmtleXMoKSk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZiJkaWN0X2tleXMgYT17c29ydGVkKGEua2V5cygpKX0gYj17c29ydGVkKGIua2V5cygpKX0iCiAgICAgICAgZm9yIGsgaW4gYToKICAgICAgICAgICAgb2ssIGRpYWcgPSBfZXhhY3RfZXF1YWwoYVtrXSwgYltrXSkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImtleT17ayFyfToge2RpYWd9IgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgX2l0ZXJhYmxlKGEpIGFuZCBfaXRlcmFibGUoYik6CiAgICAgICAgaWYgbGVuKGEpICE9IGxlbihiKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImxlbiBhPXtsZW4oYSl9IGI9e2xlbihiKX0iCiAgICAgICAgZm9yIGksIChhaSwgYmkpIGluIGVudW1lcmF0ZSh6aXAoYSwgYikpOgogICAgICAgICAgICBvaywgZGlhZyA9IF9leGFjdF9lcXVhbChhaSwgYmkpCiAgICAgICAgICAgIGlmIG5vdCBvazoKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZiJpZHg9e2l9OiB7ZGlhZ30iCiAgICAgICAgcmV0dXJuIFRydWUsICIiCiAgICBvayA9IGEgPT0gYgogICAgcmV0dXJuIG9rLCBmImE9e2Ehcn0gYj17YiFyfSIgaWYgbm90IG9rIGVsc2UgIiIKZGVmIHZhbGlkYXRlX2NvbnRyYWN0KGNvbnRyYWN0OiBNYXBwaW5nW3N0ciwgQW55XSkgLT4gTGlzdFtzdHJdOgogICAgIiIiUmV0dXJuIGRpYWdub3N0aWNzIChlbXB0eSA9PiBzdHJ1Y3R1cmFsbHkgT0spLiIiIgogICAgcmVxdWlyZWQgPSBbImlkIiwgIm1ldGFkYXRhIiwgInJlZmVyZW5jZSIsICJpbnZhcmlhbnRzIiwgInRvbGVyYW5jZSIsICJ0ZXN0X3ZlY3RvciJdCiAgICBkaWFnczogTGlzdFtzdHJdID0gW10KICAgIGZvciBrIGluIHJlcXVpcmVkOgogICAgICAgIGlmIGsgbm90IGluIGNvbnRyYWN0OgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJtaXNzaW5nX3NlY3Rpb246e2t9IikKICAgIG1ldGFfcmVxID0gWyJuYW1lIiwgInZlcnNpb24iXQogICAgbWQgPSBjb250cmFjdC5nZXQoIm1ldGFkYXRhIikgaWYgaXNpbnN0YW5jZShjb250cmFjdC5nZXQoIm1ldGFkYXRhIiksIE1hcHBpbmcpIGVsc2Uge30KICAgIGZvciBrIGluIG1ldGFfcmVxOgogICAgICAgIGlmIGsgbm90IGluIG1kOgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJtaXNzaW5nX21ldGFkYXRhOntrfSIpCiAgICB0diA9IGNvbnRyYWN0LmdldCgidGVzdF92ZWN0b3IiKQogICAgaWYgdHYgaXMgTm9uZSBvciBub3QgaXNpbnN0YW5jZSh0diwgTWFwcGluZyk6CiAgICAgICAgZGlhZ3MuYXBwZW5kKCJpbnZhbGlkX3Rlc3RfdmVjdG9yIikKICAgIGVsc2U6CiAgICAgICAgaWYgbm90IGFueShrIGluIHR2IGZvciBrIGluICgiYXJncyIsICJrd2FyZ3MiLCAiaW5wdXQiKSk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZCgidGVzdF92ZWN0b3JfbWlzc2luZ19pbnB1dHMiKQogICAgICAgIGlmICJleHBlY3RlZCIgbm90IGluIHR2OgogICAgICAgICAgICBkaWFncy5hcHBlbmQoInRlc3RfdmVjdG9yX21pc3NpbmdfZXhwZWN0ZWQiKQogICAgdG9sID0gY29udHJhY3QuZ2V0KCJ0b2xlcmFuY2UiKQogICAgaWYgaXNpbnN0YW5jZSh0b2wsIE1hcHBpbmcpOgogICAgICAgIHBvbCA9IHRvbC5nZXQoInBvbGljeSIsICJleGFjdCIpCiAgICAgICAgaWYgcG9sIG5vdCBpbiAoImV4YWN0IiwgImFwcHJveCIpOgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhbGlkX3RvbGVyYW5jZV9wb2xpY3k6e3BvbH0iKQogICAgcmV0dXJuIGRpYWdzCmRlZiBfYXBwbHlfaW52YXJpYW50cyhpbnZhcmlhbnRzOiBNYXBwaW5nW3N0ciwgQW55XSwgb3V0cHV0OiBBbnkpIC0+IExpc3Rbc3RyXToKICAgIGRpYWdzOiBMaXN0W3N0cl0gPSBbXQogICAgaWYgbm90IGlzaW5zdGFuY2UoaW52YXJpYW50cywgTWFwcGluZyk6CiAgICAgICAgcmV0dXJuIGRpYWdzCiAgICB0ID0gaW52YXJpYW50cy5nZXQoIm91dHB1dF90eXBlIikKICAgIGlmIHQ6CiAgICAgICAgYWxsb3dlZCA9IHR1cGxlKGdldGF0dHIoX19idWlsdGluc19fLCB0LCBvYmplY3QpIGZvciB0IGluIChbdF0gaWYgaXNpbnN0YW5jZSh0LCBzdHIpIGVsc2UgdCkpCiAgICAgICAgaWYgYWxsb3dlZCBhbmQgbm90IGlzaW5zdGFuY2Uob3V0cHV0LCBhbGxvd2VkKToKICAgICAgICAgICAgZGlhZ3MuYXBwZW5kKGYiaW52YXJpYW50X291dHB1dF90eXBlX2ZhaWxlZDogZ290PXt0eXBlKG91dHB1dCkuX19uYW1lX199IikKICAgIGtleXMgPSBpbnZhcmlhbnRzLmdldCgiZGljdF9rZXlzIikKICAgIGlmIGtleXMgaXMgbm90IE5vbmU6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3V0cHV0LCBNYXBwaW5nKToKICAgICAgICAgICAgZGlhZ3MuYXBwZW5kKCJpbnZhcmlhbnRfZGljdF9rZXlzX2ZhaWxlZDpub3RfYV9kaWN0IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBtaXNzaW5nID0gW2sgZm9yIGsgaW4ga2V5cyBpZiBrIG5vdCBpbiBvdXRwdXRdCiAgICAgICAgICAgIGV4dHJhID0gW2sgZm9yIGsgaW4gb3V0cHV0LmtleXMoKSBpZiBrIG5vdCBpbiBzZXQoa2V5cyldCiAgICAgICAgICAgIGlmIG1pc3Npbmc6CiAgICAgICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhcmlhbnRfZGljdF9taXNzaW5nX2tleXM6e21pc3Npbmd9IikKICAgICAgICAgICAgaWYgZXh0cmE6CiAgICAgICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhcmlhbnRfZGljdF9leHRyYV9rZXlzOntzb3J0ZWQoZXh0cmEpfSIpCiAgICBsZW5ndGggPSBpbnZhcmlhbnRzLmdldCgibGVuZ3RoIikKICAgIGlmIGxlbmd0aCBpcyBub3QgTm9uZToKICAgICAgICBpZiBub3QgX2l0ZXJhYmxlKG91dHB1dCk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZCgiaW52YXJpYW50X2xlbmd0aF9mYWlsZWQ6bm90X2Ffc2VxdWVuY2UiKQogICAgICAgIGVsaWYgbGVuKG91dHB1dCkgIT0gaW50KGxlbmd0aCk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZChmImludmFyaWFudF9sZW5ndGhfZmFpbGVkOiBnb3Q9e2xlbihvdXRwdXQpfSBleHBlY3RlZD17aW50KGxlbmd0aCl9IikKICAgIHJldHVybiBkaWFncwpAZGF0YWNsYXNzCmNsYXNzIENvbXBsaWFuY2VSZXN1bHQ6CiAgICBiZW5jaG1hcmtfaWQ6IHN0cgogICAgcGFzc2VkOiBib29sCiAgICBkaWFnbm9zdGljczogTGlzdFtzdHJdCiAgICBleHBlY3RlZDogQW55ID0gTm9uZQogICAgYWN0dWFsOiBBbnkgPSBOb25lCgoKZGVmIHJ1bl9jb250cmFjdChjb250cmFjdDogTWFwcGluZ1tzdHIsIEFueV0sIGltcGw6IFVuaW9uW3N0ciwgQ2FsbGFibGVbLi4uLCBBbnldXSkgLT4gQ29tcGxpYW5jZVJlc3VsdDoKICAgIGJpZCA9IHN0cihjb250cmFjdC5nZXQoImlkIiwgIjx1bmtub3duPiIpKQogICAgZGlhZ3MgPSB2YWxpZGF0ZV9jb250cmFjdChjb250cmFjdCkKICAgIGlmIGRpYWdzOgogICAgICAgIHJldHVybiBDb21wbGlhbmNlUmVzdWx0KGJpZCwgRmFsc2UsIGRpYWdzKQoKICAgIGZuID0gX2xvYWRfaW1wbChpbXBsKQogICAgdHYgPSBjb250cmFjdFsidGVzdF92ZWN0b3IiXQogICAgYXJncyA9IHR2LmdldCgiYXJncyIpCiAgICBrd2FyZ3MgPSB0di5nZXQoImt3YXJncyIpCiAgICBpZiAiaW5wdXQiIGluIHR2IGFuZCBhcmdzIGlzIE5vbmUgYW5kIGt3YXJncyBpcyBOb25lOgogICAgICAgIGlucCA9IHR2WyJpbnB1dCJdCiAgICAgICAgYXJncyA9IGlucC5nZXQoImFyZ3MiLCBbXSkgaWYgaXNpbnN0YW5jZShpbnAsIE1hcHBpbmcpIGVsc2UgW2lucF0KICAgICAgICBrd2FyZ3MgPSBpbnAuZ2V0KCJrd2FyZ3MiLCB7fSkgaWYgaXNpbnN0YW5jZShpbnAsIE1hcHBpbmcpIGVsc2Uge30KICAgIGFyZ3MgPSBsaXN0KGFyZ3MpIGlmIGFyZ3MgaXMgbm90IE5vbmUgZWxzZSBbXQogICAga3dhcmdzID0gZGljdChrd2FyZ3MpIGlmIGt3YXJncyBpcyBub3QgTm9uZSBlbHNlIHt9CiAgICBleHBlY3RlZCA9IHR2LmdldCgiZXhwZWN0ZWQiKQoKICAgIHRyeToKICAgICAgICBhY3R1YWwgPSBmbigqYXJncywgKiprd2FyZ3MpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6ICAjIG5vcWE6IEJMRTAwMQogICAgICAgIHJldHVybiBDb21wbGlhbmNlUmVzdWx0KGJpZCwgRmFsc2UsIFtmImV4Y2VwdGlvbjp7dHlwZShlKS5fX25hbWVfX306e2V9Il0sIGV4cGVjdGVkPWV4cGVjdGVkKQoKICAgIGRpYWdzLmV4dGVuZChfYXBwbHlfaW52YXJpYW50cyhjb250cmFjdC5nZXQoImludmFyaWFudHMiLCB7fSksIGFjdHVhbCkpCgogICAgdG9sID0gY29udHJhY3QuZ2V0KCJ0b2xlcmFuY2UiLCB7fSkgaWYgaXNpbnN0YW5jZShjb250cmFjdC5nZXQoInRvbGVyYW5jZSIpLCBNYXBwaW5nKSBlbHNlIHt9CiAgICBwb2xpY3kgPSB0b2wuZ2V0KCJwb2xpY3kiLCAiZXhhY3QiKQogICAgaWYgcG9saWN5ID09ICJhcHByb3giOgogICAgICAgIGF0b2wgPSBmbG9hdCh0b2wuZ2V0KCJhdG9sIiwgMC4wKSkKICAgICAgICBydG9sID0gZmxvYXQodG9sLmdldCgicnRvbCIsIDAuMCkpCiAgICAgICAgb2ssIGRpYWcgPSBfYXBwcm94X2VxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIGF0b2w9YXRvbCwgcnRvbD1ydG9sKQogICAgZWxzZToKICAgICAgICBvaywgZGlhZyA9IF9leGFjdF9lcXVhbChhY3R1YWwsIGV4cGVjdGVkKQogICAgaWYgbm90IG9rOgogICAgICAgIGRpYWdzLmFwcGVuZChmIm1pc21hdGNoOntkaWFnfSIpCiAgICBwYXNzZWQgPSBvayBhbmQgbm90IGRpYWdzCiAgICByZXR1cm4gQ29tcGxpYW5jZVJlc3VsdChiaWQsIHBhc3NlZCwgZGlhZ3MsIGV4cGVjdGVkPWV4cGVjdGVkLCBhY3R1YWw9YWN0dWFsKQpkZWYgcnVuX2NvbXBsaWFuY2UoCiAgICBjb250cmFjdHM6IEl0ZXJhYmxlW01hcHBpbmdbc3RyLCBBbnldXSwKICAgIGltcGxlbWVudGF0aW9uczogTWFwcGluZ1tzdHIsIFVuaW9uW3N0ciwgQ2FsbGFibGVbLi4uLCBBbnldXV0sCikgLT4gRGljdFtzdHIsIEFueV06CiAgICAiIiJSdW4gYWxsIGNvbnRyYWN0cyBhZ2FpbnN0IHByb3ZpZGVkIGltcGxlbWVudGF0aW9ucy4KCiAgICBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgZGljdCBrZXllZCBieSBiZW5jaG1hcmsgaWQ6CiAgICB7aWQ6IHtwYXNzZWQ6IGJvb2wsIGRpYWdub3N0aWNzOiBbLi4uXSwgZXhwZWN0ZWQ6IC4uLiwgYWN0dWFsOiAuLi59fQogICAgIiIiCiAgICByZXBvcnQ6IERpY3Rbc3RyLCBBbnldID0ge30KICAgIGZvciBjIGluIGNvbnRyYWN0czoKICAgICAgICBiaWQgPSBzdHIoYy5nZXQoImlkIiwgIjx1bmtub3duPiIpKQogICAgICAgIGltcGwgPSBpbXBsZW1lbnRhdGlvbnMuZ2V0KGJpZCkKICAgICAgICBpZiBpbXBsIGlzIE5vbmU6CiAgICAgICAgICAgIHJlcG9ydFtiaWRdID0geyJwYXNzZWQiOiBGYWxzZSwgImRpYWdub3N0aWNzIjogWyJtaXNzaW5nX2ltcGxlbWVudGF0aW9uIl19CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmVzID0gcnVuX2NvbnRyYWN0KGMsIGltcGwpCiAgICAgICAgcmVwb3J0W2JpZF0gPSB7CiAgICAgICAgICAgICJwYXNzZWQiOiBib29sKHJlcy5wYXNzZWQpLAogICAgICAgICAgICAiZGlhZ25vc3RpY3MiOiBsaXN0KHJlcy5kaWFnbm9zdGljcyksCiAgICAgICAgfQogICAgICAgIGlmIG5vdCByZXMucGFzc2VkOgogICAgICAgICAgICByZXBvcnRbYmlkXVsiZXhwZWN0ZWQiXSA9IHJlcy5leHBlY3RlZAogICAgICAgICAgICByZXBvcnRbYmlkXVsiYWN0dWFsIl0gPSByZXMuYWN0dWFsCiAgICByZXR1cm4gcmVwb3J0Cg==\"}\nDIR_STATE:[\"src/cosmo_contracts/__init__.py\", \"src/cosmo_contracts/__main__.py\", \"src/cosmo_contracts/cli.py\", \"src/cosmo_contracts/contracts.py\", \"src/cosmo_contracts/markdown.py\", \"src/cosmo_contracts/runner.py\", \"src/cosmo_contracts/schema.py\"]\n"
        }
      ]
    },
    {
      "id": "msg_009afc5fbbe4ba33006949a4ec11dc8193bb742e2764dedfe2",
      "type": "message",
      "status": "completed",
      "content": [
        {
          "type": "output_text",
          "annotations": [],
          "logprobs": [],
          "text": "FILE_EXPORT:{\"path\":\"src/cosmo_contracts/runner.py\",\"size\":8470,\"encoding\":\"base64\",\"sha256\":\"e689c221fa7a29887e1859ce68b9278624d56d507f7c2597c82fcae0523a1651\",\"content\":\"IiIiY29zbW9fY29udHJhY3RzLnJ1bm5lcgoKUnVucyBjb250cmlidXRlZCBiZW5jaG1hcmsgaW1wbGVtZW50YXRpb25zIGFnYWluc3QgY2Fub25pY2FsIGNvbnRyYWN0IHRlc3QgdmVjdG9ycwphbmQgcHJvZHVjZXMgYSBwZXItY29udHJhY3QgY29tcGxpYW5jZSByZXBvcnQgKHBhc3MvZmFpbCArIGRpYWdub3N0aWNzKS4KClRoaXMgbW9kdWxlIGlzIGludGVudGlvbmFsbHkgc2VsZi1jb250YWluZWQgc28gaXQgY2FuIGJlIHVzZWQgZXZlbiB3aGVuIG9ubHkKY29udHJhY3RzIChkaWN0cykgYW5kIGltcGxlbWVudGF0aW9ucyAoY2FsbGFibGVzL2ltcG9ydCBwYXRocykgYXJlIGF2YWlsYWJsZS4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSBpbXBvcnRsaWIgaW1wb3J0IGltcG9ydF9tb2R1bGUKZnJvbSB0eXBpbmcgaW1wb3J0IEFueSwgQ2FsbGFibGUsIERpY3QsIEl0ZXJhYmxlLCBMaXN0LCBNYXBwaW5nLCBPcHRpb25hbCwgVHVwbGUsIFVuaW9uCk51bWJlciA9IFVuaW9uW2ludCwgZmxvYXRdCgoKZGVmIF9pc19udW1iZXIoeDogQW55KSAtPiBib29sOgogICAgcmV0dXJuIGlzaW5zdGFuY2UoeCwgKGludCwgZmxvYXQpKSBhbmQgbm90IGlzaW5zdGFuY2UoeCwgYm9vbCkKCgpkZWYgX2l0ZXJhYmxlKHg6IEFueSkgLT4gYm9vbDoKICAgIHJldHVybiBpc2luc3RhbmNlKHgsIChsaXN0LCB0dXBsZSkpCgoKZGVmIF9sb2FkX2ltcGwoc3BlYzogVW5pb25bc3RyLCBDYWxsYWJsZVsuLi4sIEFueV1dKSAtPiBDYWxsYWJsZVsuLi4sIEFueV06CiAgICAiIiJMb2FkIGFuIGltcGxlbWVudGF0aW9uIGZyb20gYSBjYWxsYWJsZSBvciBhICdtb2R1bGU6YXR0cicgc3RyaW5nLiIiIgogICAgaWYgY2FsbGFibGUoc3BlYyk6CiAgICAgICAgcmV0dXJuIHNwZWMKICAgIGlmIG5vdCBpc2luc3RhbmNlKHNwZWMsIHN0cikgb3IgIjoiIG5vdCBpbiBzcGVjOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiSW1wbGVtZW50YXRpb24gc3BlYyBtdXN0IGJlIGNhbGxhYmxlIG9yICdtb2R1bGU6YXR0cicgc3RyaW5nIikKICAgIG1vZCwgYXR0ciA9IHNwZWMu c3BsaXQoIjoiLCAxKQogICAgZm4gPSBnZXRhdHRyKGltcG9ydF9tb2R1bGUobW9kKSwgYXR0cikKICAgIGlmIG5vdCBjYWxsYWJsZShmbik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKGYiTG9hZGVkIG9iamVjdCB7c3BlYyFyfSBpcyBub3QgY2FsbGFibGUiKQogICAgcmV0dXJuIGZuCmRlZiBfYXBwcm94X2VxdWFsKGE6IEFueSwgYjogQW55LCAqLCBhdG9sOiBmbG9hdCwgcnRvbDogZmxvYXQpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiJEZWVwIGFwcHJveGltYXRlIGVxdWFsaXR5IHdpdGggdXNlZnVsIGRpYWdub3N0aWNzIChubyBudW1weSByZXF1aXJlZCkuIiIiCiAgICBpZiBhIGlzIGI6CiAgICAgICAgcmV0dXJuIFRydWUsICIiCiAgICBpZiBfaXNfbnVtYmVyKGEpIGFuZCBfaXNfbnVtYmVyKGIpOgogICAgICAgIGRpZmYgPSBhYnMoYSAtIGIpCiAgICAgICAgdG9sID0gYXRvbCArIHJ0b2wgKiBhYnMoYikKICAgICAgICBvayA9IGRpZmYgPD0gdG9sCiAgICAgICAgcmV0dXJuIG9rLCBmImFic19kaWZmPXtkaWZmfSB0b2w9e3RvbH0gYT17YX0gYj17Yn0iIGlmIG5vdCBvayBlbHNlICIiCiAgICBpZiBpc2luc3RhbmNlKGEsIHN0cikgb3IgaXNpbnN0YW5jZShiLCBzdHIpOgogICAgICAgIG9rID0gYSA9PSBiCiAgICAgICAgcmV0dXJuIG9rLCBmImE9e2Ehcn0gYj17YiFyfSIgaWYgbm90IG9rIGVsc2UgIiIKICAgIGlmIGlzaW5zdGFuY2UoYSwgTWFwcGluZykgYW5kIGlzaW5zdGFuY2UoYiwgTWFwcGluZyk6CiAgICAgICAgaWYgc2V0KGEua2V5cygpKSAhPSBzZXQoYi5rZXlzKCkpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGYiZGljdF9rZXlzIGE9e3NvcnRlZChhLmtleXMoKSl9IGI9e3NvcnRlZChiLmtleXMoKSl9IgogICAgICAgIGZvciBrIGluIGE6CiAgICAgICAgICAgIG9rLCBkaWFnID0gX2FwcHJveF9lcXVhbChhW2tdLCBiW2tdLCBhdG9sPWF0b2wsIHJ0b2w9cnRvbCkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImtleT17ayFyfToge2RpYWd9IgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgX2l0ZXJhYmxlKGEpIGFuZCBfaXRlcmFibGUoYik6CiAgICAgICAgaWYgbGVuKGEpICE9IGxlbihiKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImxlbiBhPXtsZW4oYSl9IGI9e2xlbihiKX0iCiAgICAgICAgZm9yIGksIChhaSwgYmkpIGluIGVudW1lcmF0ZSh6aXAoYSwgYikpOgogICAgICAgICAgICBvaywgZGlhZyA9IF9hcHByb3hfZXF1YWwoYWksIGJpLCBhdG9sPWF0b2wsIHJ0b2w9cnRvbCkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImlkeD17aX06IHtkaWFnfSIKICAgICAgICByZXR1cm4gVHJ1ZSwgIiIKICAgIG9rID0gYSA9PSBiCiAgICByZXR1cm4gb2ssIGYiYT17YSFyfSBiPXtiIXJ9IiBpZiBub3Qgb2sgZWxzZSAiIgpkZWYgX2V4YWN0X2VxdWFsKGE6IEFueSwgYjogQW55KSAtPiBUdXBsZVtib29sLCBzdHJdOgogICAgaWYgYSBpcyBiOgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgaXNpbnN0YW5jZShhLCBNYXBwaW5nKSBhbmQgaXNpbnN0YW5jZShiLCBNYXBwaW5nKToKICAgICAgICBpZiBzZXQoYS5rZXlzKCkpICE9IHNldChiLmtleXMoKSk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZiJkaWN0X2tleXMgYT17c29ydGVkKGEua2V5cygpKX0gYj17c29ydGVkKGIua2V5cygpKX0iCiAgICAgICAgZm9yIGsgaW4gYToKICAgICAgICAgICAgb2ssIGRpYWcgPSBfZXhhY3RfZXF1YWwoYVtrXSwgYltrXSkKICAgICAgICAgICAgaWYgbm90IG9rOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImtleT17ayFyfToge2RpYWd9IgogICAgICAgIHJldHVybiBUcnVlLCAiIgogICAgaWYgX2l0ZXJhYmxlKGEpIGFuZCBfaXRlcmFibGUoYik6CiAgICAgICAgaWYgbGVuKGEpICE9IGxlbihiKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmImxlbiBhPXtsZW4oYSl9IGI9e2xlbihiKX0iCiAgICAgICAgZm9yIGksIChhaSwgYmkpIGluIGVudW1lcmF0ZSh6aXAoYSwgYikpOgogICAgICAgICAgICBvaywgZGlhZyA9IF9leGFjdF9lcXVhbChhaSwgYmkpCiAgICAgICAgICAgIGlmIG5vdCBvazoKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZiJpZHg9e2l9OiB7ZGlhZ30iCiAgICAgICAgcmV0dXJuIFRydWUsICIiCiAgICBvayA9IGEgPT0gYgogICAgcmV0dXJuIG9rLCBmImE9e2Ehcn0gYj17YiFyfSIgaWYgbm90IG9rIGVsc2UgIiIKZGVmIHZhbGlkYXRlX2NvbnRyYWN0KGNvbnRyYWN0OiBNYXBwaW5nW3N0ciwgQW55XSkgLT4gTGlzdFtzdHJdOgogICAgIiIiUmV0dXJuIGRpYWdub3N0aWNzIChlbXB0eSA9PiBzdHJ1Y3R1cmFsbHkgT0spLiIiIgogICAgcmVxdWlyZWQgPSBbImlkIiwgIm1ldGFkYXRhIiwgInJlZmVyZW5jZSIsICJpbnZhcmlhbnRzIiwgInRvbGVyYW5jZSIsICJ0ZXN0X3ZlY3RvciJdCiAgICBkaWFnczogTGlzdFtzdHJdID0gW10KICAgIGZvciBrIGluIHJlcXVpcmVkOgogICAgICAgIGlmIGsgbm90IGluIGNvbnRyYWN0OgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJtaXNzaW5nX3NlY3Rpb246e2t9IikKICAgIG1ldGFfcmVxID0gWyJuYW1lIiwgInZlcnNpb24iXQogICAgbWQgPSBjb250cmFjdC5nZXQoIm1ldGFkYXRhIikgaWYgaXNpbnN0YW5jZShjb250cmFjdC5nZXQoIm1ldGFkYXRhIiksIE1hcHBpbmcpIGVsc2Uge30KICAgIGZvciBrIGluIG1ldGFfcmVxOgogICAgICAgIGlmIGsgbm90IGluIG1kOgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJtaXNzaW5nX21ldGFkYXRhOntrfSIpCiAgICB0diA9IGNvbnRyYWN0LmdldCgidGVzdF92ZWN0b3IiKQogICAgaWYgdHYgaXMgTm9uZSBvciBub3QgaXNpbnN0YW5jZSh0diwgTWFwcGluZyk6CiAgICAgICAgZGlhZ3MuYXBwZW5kKCJpbnZhbGlkX3Rlc3RfdmVjdG9yIikKICAgIGVsc2U6CiAgICAgICAgaWYgbm90IGFueShrIGluIHR2IGZvciBrIGluICgiYXJncyIsICJrd2FyZ3MiLCAiaW5wdXQiKSk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZCgidGVzdF92ZWN0b3JfbWlzc2luZ19pbnB1dHMiKQogICAgICAgIGlmICJleHBlY3RlZCIgbm90IGluIHR2OgogICAgICAgICAgICBkaWFncy5hcHBlbmQoInRlc3RfdmVjdG9yX21pc3NpbmdfZXhwZWN0ZWQiKQogICAgdG9sID0gY29udHJhY3QuZ2V0KCJ0b2xlcmFuY2UiKQogICAgaWYgaXNpbnN0YW5jZSh0b2wsIE1hcHBpbmcpOgogICAgICAgIHBvbCA9IHRvbC5nZXQoInBvbGljeSIsICJleGFjdCIpCiAgICAgICAgaWYgcG9sIG5vdCBpbiAoImV4YWN0IiwgImFwcHJveCIpOgogICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhbGlkX3RvbGVyYW5jZV9wb2xpY3k6e3BvbH0iKQogICAgcmV0dXJuIGRpYWdzCmRlZiBfYXBwbHlfaW52YXJpYW50cyhpbnZhcmlhbnRzOiBNYXBwaW5nW3N0ciwgQW55XSwgb3V0cHV0OiBBbnkpIC0+IExpc3Rbc3RyXToKICAgIGRpYWdzOiBMaXN0W3N0cl0gPSBbXQogICAgaWYgbm90IGlzaW5zdGFuY2UoaW52YXJpYW50cywgTWFwcGluZyk6CiAgICAgICAgcmV0dXJuIGRpYWdzCiAgICB0ID0gaW52YXJpYW50cy5nZXQoIm91dHB1dF90eXBlIikKICAgIGlmIHQ6CiAgICAgICAgYWxsb3dlZCA9IHR1cGxlKGdldGF0dHIoX19idWlsdGluc19fLCB0LCBvYmplY3QpIGZvciB0IGluIChbdF0gaWYgaXNpbnN0YW5jZSh0LCBzdHIpIGVsc2UgdCkpCiAgICAgICAgaWYgYWxsb3dlZCBhbmQgbm90IGlzaW5zdGFuY2Uob3V0cHV0LCBhbGxvd2VkKToKICAgICAgICAgICAgZGlhZ3MuYXBwZW5kKGYiaW52YXJpYW50X291dHB1dF90eXBlX2ZhaWxlZDogZ290PXt0eXBlKG91dHB1dCkuX19uYW1lX199IikKICAgIGtleXMgPSBpbnZhcmlhbnRzLmdldCgiZGljdF9rZXlzIikKICAgIGlmIGtleXMgaXMgbm90IE5vbmU6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3V0cHV0LCBNYXBwaW5nKToKICAgICAgICAgICAgZGlhZ3MuYXBwZW5kKCJpbnZhcmlhbnRfZGljdF9rZXlzX2ZhaWxlZDpub3RfYV9kaWN0IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBtaXNzaW5nID0gW2sgZm9yIGsgaW4ga2V5cyBpZiBrIG5vdCBpbiBvdXRwdXRdCiAgICAgICAgICAgIGV4dHJhID0gW2sgZm9yIGsgaW4gb3V0cHV0LmtleXMoKSBpZiBrIG5vdCBpbiBzZXQoa2V5cyldCiAgICAgICAgICAgIGlmIG1pc3Npbmc6CiAgICAgICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhcmlhbnRfZGljdF9taXNzaW5nX2tleXM6e21pc3Npbmd9IikKICAgICAgICAgICAgaWYgZXh0cmE6CiAgICAgICAgICAgICAgICBkaWFncy5hcHBlbmQoZiJpbnZhcmlhbnRfZGljdF9leHRyYV9rZXlzOntzb3J0ZWQoZXh0cmEpfSIpCiAgICBsZW5ndGggPSBpbnZhcmlhbnRzLmdldCgibGVuZ3RoIikKICAgIGlmIGxlbmd0aCBpcyBub3QgTm9uZToKICAgICAgICBpZiBub3QgX2l0ZXJhYmxlKG91dHB1dCk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZCgiaW52YXJpYW50X2xlbmd0aF9mYWlsZWQ6bm90X2Ffc2VxdWVuY2UiKQogICAgICAgIGVsaWYgbGVuKG91dHB1dCkgIT0gaW50KGxlbmd0aCk6CiAgICAgICAgICAgIGRpYWdzLmFwcGVuZChmImludmFyaWFudF9sZW5ndGhfZmFpbGVkOiBnb3Q9e2xlbihvdXRwdXQpfSBleHBlY3RlZD17aW50KGxlbmd0aCl9IikKICAgIHJldHVybiBkaWFncwpAZGF0YWNsYXNzCmNsYXNzIENvbXBsaWFuY2VSZXN1bHQ6CiAgICBiZW5jaG1hcmtfaWQ6IHN0cgogICAgcGFzc2VkOiBib29sCiAgICBkaWFnbm9zdGljczogTGlzdFtzdHJdCiAgICBleHBlY3RlZDogQW55ID0gTm9uZQogICAgYWN0dWFsOiBBbnkgPSBOb25lCgoKZGVmIHJ1bl9jb250cmFjdChjb250cmFjdDogTWFwcGluZ1tzdHIsIEFueV0sIGltcGw6IFVuaW9uW3N0ciwgQ2FsbGFibGVbLi4uLCBBbnldXSkgLT4gQ29tcGxpYW5jZVJlc3VsdDoKICAgIGJpZCA9IHN0cihjb250cmFjdC5nZXQoImlkIiwgIjx1bmtub3duPiIpKQogICAgZGlhZ3MgPSB2YWxpZGF0ZV9jb250cmFjdChjb250cmFjdCkKICAgIGlmIGRpYWdzOgogICAgICAgIHJldHVybiBDb21wbGlhbmNlUmVzdWx0KGJpZCwgRmFsc2UsIGRpYWdzKQoKICAgIGZuID0gX2xvYWRfaW1wbChpbXBsKQogICAgdHYgPSBjb250cmFjdFsidGVzdF92ZWN0b3IiXQogICAgYXJncyA9IHR2LmdldCgiYXJncyIpCiAgICBrd2FyZ3MgPSB0di5nZXQoImt3YXJncyIpCiAgICBpZiAiaW5wdXQiIGluIHR2IGFuZCBhcmdzIGlzIE5vbmUgYW5kIGt3YXJncyBpcyBOb25lOgogICAgICAgIGlucCA9IHR2WyJpbnB1dCJdCiAgICAgICAgYXJncyA9IGlucC5nZXQoImFyZ3MiLCBbXSkgaWYgaXNpbnN0YW5jZShpbnAsIE1hcHBpbmcpIGVsc2UgW2lucF0KICAgICAgICBrd2FyZ3MgPSBpbnAuZ2V0KCJrd2FyZ3MiLCB7fSkgaWYgaXNpbnN0YW5jZShpbnAsIE1hcHBpbmcpIGVsc2Uge30KICAgIGFyZ3MgPSBsaXN0KGFyZ3MpIGlmIGFyZ3MgaXMgbm90IE5vbmUgZWxzZSBbXQogICAga3dhcmdzID0gZGljdChrd2FyZ3MpIGlmIGt3YXJncyBpcyBub3QgTm9uZSBlbHNlIHt9CiAgICBleHBlY3RlZCA9IHR2LmdldCgiZXhwZWN0ZWQiKQoKICAgIHRyeToKICAgICAgICBhY3R1YWwgPSBmbigqYXJncywgKiprd2FyZ3MpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6ICAjIG5vcWE6IEJMRTAwMQogICAgICAgIHJldHVybiBDb21wbGlhbmNlUmVzdWx0KGJpZCwgRmFsc2UsIFtmImV4Y2VwdGlvbjp7dHlwZShlKS5fX25hbWVfX306e2V9Il0sIGV4cGVjdGVkPWV4cGVjdGVkKQoKICAgIGRpYWdzLmV4dGVuZChfYXBwbHlfaW52YXJpYW50cyhjb250cmFjdC5nZXQoImludmFyaWFudHMiLCB7fSksIGFjdHVhbCkpCgogICAgdG9sID0gY29udHJhY3QuZ2V0KCJ0b2xlcmFuY2UiLCB7fSkgaWYgaXNpbnN0YW5jZShjb250cmFjdC5nZXQoInRvbGVyYW5jZSIpLCBNYXBwaW5nKSBlbHNlIHt9CiAgICBwb2xpY3kgPSB0b2wuZ2V0KCJwb2xpY3kiLCAiZXhhY3QiKQogICAgaWYgcG9saWN5ID09ICJhcHByb3giOgogICAgICAgIGF0b2wgPSBmbG9hdCh0b2wuZ2V0KCJhdG9sIiwgMC4wKSkKICAgICAgICBydG9sID0gZmxvYXQodG9sLmdldCgicnRvbCIsIDAuMCkpCiAgICAgICAgb2ssIGRpYWcgPSBfYXBwcm94X2VxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIGF0b2w9YXRvbCwgcnRvbD1ydG9sKQogICAgZWxzZToKICAgICAgICBvaywgZGlhZyA9IF9leGFjdF9lcXVhbChhY3R1YWwsIGV4cGVjdGVkKQogICAgaWYgbm90IG9rOgogICAgICAgIGRpYWdzLmFwcGVuZChmIm1pc21hdGNoOntkaWFnfSIpCiAgICBwYXNzZWQgPSBvayBhbmQgbm90IGRpYWdzCiAgICByZXR1cm4gQ29tcGxpYW5jZVJlc3VsdChiaWQsIHBhc3NlZCwgZGlhZ3MsIGV4cGVjdGVkPWV4cGVjdGVkLCBhY3R1YWw9YWN0dWFsKQpkZWYgcnVuX2NvbXBsaWFuY2UoCiAgICBjb250cmFjdHM6IEl0ZXJhYmxlW01hcHBpbmdbc3RyLCBBbnldXSwKICAgIGltcGxlbWVudGF0aW9uczogTWFwcGluZ1tzdHIsIFVuaW9uW3N0ciwgQ2FsbGFibGVbLi4uLCBBbnldXV0sCikgLT4gRGljdFtzdHIsIEFueV06CiAgICAiIiJSdW4gYWxsIGNvbnRyYWN0cyBhZ2FpbnN0IHByb3ZpZGVkIGltcGxlbWVudGF0aW9ucy4KCiAgICBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgZGljdCBrZXllZCBieSBiZW5jaG1hcmsgaWQ6CiAgICB7aWQ6IHtwYXNzZWQ6IGJvb2wsIGRpYWdub3N0aWNzOiBbLi4uXSwgZXhwZWN0ZWQ6IC4uLiwgYWN0dWFsOiAuLi59fQogICAgIiIiCiAgICByZXBvcnQ6IERpY3Rbc3RyLCBBbnldID0ge30KICAgIGZvciBjIGluIGNvbnRyYWN0czoKICAgICAgICBiaWQgPSBzdHIoYy5nZXQoImlkIiwgIjx1bmtub3duPiIpKQogICAgICAgIGltcGwgPSBpbXBsZW1lbnRhdGlvbnMuZ2V0KGJpZCkKICAgICAgICBpZiBpbXBsIGlzIE5vbmU6CiAgICAgICAgICAgIHJlcG9ydFtiaWRdID0geyJwYXNzZWQiOiBGYWxzZSwgImRpYWdub3N0aWNzIjogWyJtaXNzaW5nX2ltcGxlbWVudGF0aW9uIl19CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmVzID0gcnVuX2NvbnRyYWN0KGMsIGltcGwpCiAgICAgICAgcmVwb3J0W2JpZF0gPSB7CiAgICAgICAgICAgICJwYXNzZWQiOiBib29sKHJlcy5wYXNzZWQpLAogICAgICAgICAgICAiZGlhZ25vc3RpY3MiOiBsaXN0KHJlcy5kaWFnbm9zdGljcyksCiAgICAgICAgfQogICAgICAgIGlmIG5vdCByZXMucGFzc2VkOgogICAgICAgICAgICByZXBvcnRbYmlkXVsiZXhwZWN0ZWQiXSA9IHJlcy5leHBlY3RlZAogICAgICAgICAgICByZXBvcnRbYmlkXVsiYWN0dWFsIl0gPSByZXMuYWN0dWFsCiAgICByZXR1cm4gcmVwb3J0Cg==\"}\nDIR_STATE:[\"src/cosmo_contracts/__init__.py\",\"src/cosmo_contracts/__main__.py\",\"src/cosmo_contracts/cli.py\",\"src/cosmo_contracts/contracts.py\",\"src/cosmo_contracts/markdown.py\",\"src/cosmo_contracts/runner.py\",\"src/cosmo_contracts/schema.py\"]"
        }
      ],
      "role": "assistant"
    }
  ],
  "codeResults": []
}