{
  "content": "FILE_EXPORT:{\"path\":\"src/dgpipe/inference.py\",\"size\":7095,\"encoding\":\"base64\",\"sha256\":\"0f8795dcde695703b742e6dbb9bdc46d3e542a0afbf7731f65f2c3298c9f3306\",\"content\":\"IiIiZGdwaXBlLmluZmVyZW5jZQoKTGlnaHR3ZWlnaHQgc3RhdGlzdGljYWwgaW5mZXJlbmNlIHV0aWxpdGllcyB0byB0cmFuc2xhdGUgbWVhc3VyZWQgY29ycmVsYXRvciAvCmVudGFuZ2xlbWVudCBkYXRhIGludG8gY29uc3RyYWludHMgb24gZGlzY3JldGUtc3RydWN0dXJlIHBhcmFtZXRlcnMuCgpEZXNpZ24gZ29hbHM6IG1pbmltYWwgZGVwZW5kZW5jaWVzIChudW1weSBvbmx5KSwgc3VwcG9ydCBmb3IgR2F1c3NpYW4KbGlrZWxpaG9vZHMsIGFkZGl0aXZlIGxpbmVhciBzeXN0ZW1hdGljcyB3aXRoIGFuYWx5dGljIG1hcmdpbmFsaXphdGlvbiwgYW5kIGEKYmFzaWMgTWV0cm9wb2xpcy1IYXN0aW5ncyBwb3N0ZXJpb3Igc2FtcGxlci4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBEaWN0LCBJdGVyYWJsZSwgTWFwcGluZywgT3B0aW9uYWwsIFNlcXVlbmNlLCBUdXBsZSwgVW5pb24KCmltcG9ydCBudW1weSBhcyBucAoKQXJyYXkgPSBucC5uZGFycmF5ClByaW9yU3BlYyA9IFVuaW9uW1R1cGxlW3N0ciwgZmxvYXQsIGZsb2F0XSwgVHVwbGVbc3RyLCBBcnJheSwgQXJyYXldXSAgIyB1bmlmb3JtL2dhdXNzaWFuCmRlZiBfYXNfMWQoeDogVW5pb25bQXJyYXksIFNlcXVlbmNlW2Zsb2F0XV0pIC0+IEFycmF5OgogICAgeCA9IG5wLmFzYXJyYXkoeCwgZHR5cGU9ZmxvYXQpCiAgICByZXR1cm4geC5yZXNoYXBlKC0xKQoKCmRlZiBfY292X2Zyb21fc2lnbWEoc2lnbWE6IFVuaW9uW2Zsb2F0LCBBcnJheV0sIG46IGludCkgLT4gQXJyYXk6CiAgICBzID0gbnAuYXNhcnJheShzaWdtYSwgZHR5cGU9ZmxvYXQpCiAgICBpZiBzLm5kaW0gPT0gMDoKICAgICAgICByZXR1cm4gbnAuZXllKG4pICogZmxvYXQocykgKiogMgogICAgcyA9IHMucmVzaGFwZSgtMSkKICAgIGlmIHMuc2l6ZSAhPSBuOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJzaWdtYSBoYXMgc2l6ZSB7cy5zaXplfSwgZXhwZWN0ZWQge259IikKICAgIHJldHVybiBucC5kaWFnKHMgKiogMikKCgpkZWYgX2xvZ2xpa2VfZ2F1c3NpYW4ocmVzaWQ6IEFycmF5LCBjb3Y6IEFycmF5KSAtPiBmbG9hdDoKICAgIGNvdiA9IG5wLmFzYXJyYXkoY292LCBkdHlwZT1mbG9hdCkKICAgIG4gPSByZXNpZC5zaXplCiAgICB0cnk6CiAgICAgICAgTCA9IG5wLmxpbmFsZy5jaG9sZXNreShjb3YpCiAgICAgICAgc29sID0gbnAubGluYWxnLnNvbHZlKEwsIHJlc2lkKQogICAgICAgIHF1YWQgPSBmbG9hdChzb2wgQCBzb2wpCiAgICAgICAgbG9nZGV0ID0gMi4wICogZmxvYXQobnAubG9nKG5wLmRpYWcoTCkpLnN1bSgpKQogICAgZXhjZXB0IG5wLmxpbmFsZy5MaW5BbGdFcnJvcjoKICAgICAgICBjb3ZpID0gbnAubGluYWxnLnBpbnYoY292KQogICAgICAgIHF1YWQgPSBmbG9hdChyZXNpZCBAIGNvdmkgQCByZXNpZCkKICAgICAgICBzaWduLCBsb2dkZXQgPSBucC5saW5hbGcuc2xvZ2RldChjb3YgKyAxZS0xMiAqIG5wLmV5ZShuKSkKICAgICAgICBsb2dkZXQgPSBmbG9hdChsb2dkZXQpIGlmIHNpZ24gPiAwIGVsc2UgZmxvYXQobnAubG9nKG5wLmFicyhucC5saW5hbGcuZGV0KGNvdikgKyAxZS0zMCkpKQogICAgcmV0dXJuIC0wLjUgKiAocXVhZCArIGxvZ2RldCArIG4gKiBucC5sb2coMi4wICogbnAucGkpKQpkZWYgbWFyZ2luYWxfbG9nbGlrZV9hZGRpdGl2ZV9saW5lYXIoCiAgICB5OiBBcnJheSwKICAgIG11OiBBcnJheSwKICAgIGNvdl95OiBBcnJheSwKICAgIEE6IE9wdGlvbmFsW0FycmF5XSA9IE5vbmUsCiAgICBudV9tZWFuOiBPcHRpb25hbFtBcnJheV0gPSBOb25lLAogICAgbnVfY292OiBPcHRpb25hbFtBcnJheV0gPSBOb25lLAopIC0+IGZsb2F0OgogICAgIiIiR2F1c3NpYW4gbG9nLWxpa2VsaWhvb2Qgd2l0aCBhbmFseXRpYyBtYXJnaW5hbGl6YXRpb24gb3ZlciBudWlzYW5jZS4KCiAgICBNb2RlbDogeSA9IG11KHRoZXRhKSArIEEgbnUgKyBlcHMsICBlcHN+TigwLGNvdl95KSwgIG51fk4obnVfbWVhbixudV9jb3YpLgogICAgVGhlIG1hcmdpbmFsaXplZCBkaXN0cmlidXRpb24gaXMgR2F1c3NpYW4gd2l0aCBtZWFuIG11ICsgQSBudV9tZWFuIGFuZAogICAgY292YXJpYW5jZSBjb3ZfeSArIEEgbnVfY292IEFeVC4KICAgICIiIgogICAgeSA9IF9hc18xZCh5KQogICAgbXUgPSBfYXNfMWQobXUpCiAgICBpZiB5LnNpemUgIT0gbXUuc2l6ZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ5IGFuZCBtdSBtdXN0IGhhdmUgc2FtZSBsZW5ndGgiKQogICAgY292X2VmZiA9IG5wLmFzYXJyYXkoY292X3ksIGR0eXBlPWZsb2F0KQogICAgbWVhbl9lZmYgPSBtdQogICAgaWYgQSBpcyBub3QgTm9uZSBhbmQgbnVfY292IGlzIG5vdCBOb25lOgogICAgICAgIEEgPSBucC5hc2FycmF5KEEsIGR0eXBlPWZsb2F0KQogICAgICAgIG51X21lYW4gPSBucC56ZXJvcyhBLnNoYXBlWzFdKSBpZiBudV9tZWFuIGlzIE5vbmUgZWxzZSBfYXNfMWQobnVfbWVhbikKICAgICAgICBudV9jb3YgPSBucC5hc2FycmF5KG51X2NvdiwgZHR5cGU9ZmxvYXQpCiAgICAgICAgbWVhbl9lZmYgPSBtdSArIEEgQCBudV9tZWFuCiAgICAgICAgY292X2VmZiA9IGNvdl9lZmYgKyBBIEAgbnVfY292IEAgQS5UCiAgICByZXR1cm4gX2xvZ2xpa2VfZ2F1c3NpYW4oeSAtIG1lYW5fZWZmLCBjb3ZfZWZmKQpkZWYgbG9ncHJpb3IodGhldGE6IEFycmF5LCBwcmlvcnM6IE9wdGlvbmFsW01hcHBpbmdbc3RyLCBQcmlvclNwZWNdXSA9IE5vbmUsIG5hbWVzOiBPcHRpb25hbFtTZXF1ZW5jZVtzdHJdXSA9IE5vbmUpIC0+IGZsb2F0OgogICAgIiIiQ29tcHV0ZSBsb2cgcHJpb3IgZm9yIHBhcmFtZXRlciB2ZWN0b3IgdGhldGEuCgogICAgcHJpb3JzIG1hcHMgcGFyYW1ldGVyIG5hbWUgLT4gKCd1bmlmb3JtJywgbG93LCBoaWdoKSBvciAoJ2dhdXNzaWFuJywgbWVhbiwgY292KS4KICAgIEZvciBnYXVzc2lhbjogbWVhbiBhbmQgY292IGNhbiBiZSBzY2FsYXJzIChpbnRlcnByZXRlZCBhcyBkaWFnb25hbCB2YXJpYW5jZSkgb3IgYXJyYXlzLgogICAgIiIiCiAgICBpZiBub3QgcHJpb3JzOgogICAgICAgIHJldHVybiAwLjAKICAgIHRoZXRhID0gX2FzXzFkKHRoZXRhKQogICAgaWYgbmFtZXMgaXMgTm9uZToKICAgICAgICBuYW1lcyA9IFtmInB7aX0iIGZvciBpIGluIHJhbmdlKHRoZXRhLnNpemUpXQogICAgbHAgPSAwLjAKICAgIGZvciBpLCBubSBpbiBlbnVtZXJhdGUobmFtZXMpOgogICAgICAgIGlmIG5tIG5vdCBpbiBwcmlvcnM6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgc3BlYyA9IHByaW9yc1tubV0KICAgICAgICBpZiBzcGVjWzBdID09ICJ1bmlmb3JtIjoKICAgICAgICAgICAgbG8sIGhpID0gZmxvYXQoc3BlY1sxXSksIGZsb2F0KHNwZWNbMl0pCiAgICAgICAgICAgIGlmIG5vdCAobG8gPD0gdGhldGFbaV0gPD0gaGkpOgogICAgICAgICAgICAgICAgcmV0dXJuIC1ucC5pbmYKICAgICAgICBlbGlmIHNwZWNbMF0gPT0gImdhdXNzaWFuIjoKICAgICAgICAgICAgbWVhbiA9IG5wLmFzYXJyYXkoc3BlY1sxXSwgZHR5cGU9ZmxvYXQpCiAgICAgICAgICAgIGNvdiA9IG5wLmFzYXJyYXkoc3BlY1syXSwgZHR5cGU9ZmxvYXQpCiAgICAgICAgICAgIG0gPSBmbG9hdChtZWFuKSBpZiBtZWFuLm5kaW0gPT0gMCBlbHNlIGZsb2F0KG1lYW4ucmVzaGFwZSgtMSlbMF0pCiAgICAgICAgICAgIHYgPSBmbG9hdChjb3YpIGlmIGNvdi5uZGltID09IDAgZWxzZSBmbG9hdChucC5kaWFnKGNvdikucmVzaGFwZSgtMSlbMF0pCiAgICAgICAgICAgIGxwICs9IC0wLjUgKiAoKHRoZXRhW2ldIC0gbSkgKiogMiAvIHYgKyBucC5sb2coMi4wICogbnAucGkgKiB2KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiVW5rbm93biBwcmlvciB0eXBlOiB7c3BlY1swXX0iKQogICAgcmV0dXJuIGZsb2F0KGxwKQpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmZlcmVuY2VQcm9ibGVtOgogICAgIiIiQnVuZGxlIGEgZGF0YXNldCwgYSBmb3J3YXJkIG1vZGVsLCBhbmQgc3lzdGVtYXRpY3MgZm9yIGluZmVyZW5jZS4iIiIKCiAgICB4OiBBcnJheQogICAgeTogQXJyYXkKICAgIHNpZ21hOiBVbmlvbltmbG9hdCwgQXJyYXldCiAgICBtb2RlbDogQ2FsbGFibGVbW0FycmF5LCBBcnJheV0sIEFycmF5XSAgIyBtb2RlbCh0aGV0YSwgeCktPm11CiAgICBwYXJhbV9uYW1lczogVHVwbGVbc3RyLCAuLi5dID0gKCkKICAgIHByaW9yczogT3B0aW9uYWxbRGljdFtzdHIsIFByaW9yU3BlY11dID0gTm9uZQogICAgQV9udWlzYW5jZTogT3B0aW9uYWxbQXJyYXldID0gTm9uZQogICAgbnVpc2FuY2VfbWVhbjogT3B0aW9uYWxbQXJyYXldID0gTm9uZQogICAgbnVpc2FuY2VfY292OiBPcHRpb25hbFtBcnJheV0gPSBOb25lCgogICAgZGVmIGxvZ2xpa2Uoc2VsZiwgdGhldGE6IEFycmF5KSAtPiBmbG9hdDoKICAgICAgICBtdSA9IF9hc18xZChzZWxmLm1vZGVsKF9hc18xZCh0aGV0YSksIG5wLmFzYXJyYXkoc2VsZi54KSkpCiAgICAgICAgeSA9IF9hc18xZChzZWxmLnkpCiAgICAgICAgY292X3kgPSBfY292X2Zyb21fc2lnbWEoc2VsZi5zaWdtYSwgeS5zaXplKQogICAgICAgIHJldHVybiBtYXJnaW5hbF9sb2dsaWtlX2FkZGl0aXZlX2xpbmVhcigKICAgICAgICAgICAgeT15LCBtdT1tdSwgY292X3k9Y292X3ksIEE9c2VsZi5BX251aXNhbmNlLCBudV9tZWFuPXNlbGYubnVpc2FuY2VfbWVhbiwgbnVfY292PXNlbGYubnVpc2FuY2VfY292CiAgICAgICAgKQoKICAgIGRlZiBsb2dwb3N0KHNlbGYsIHRoZXRhOiBBcnJheSkgLT4gZmxvYXQ6CiAgICAgICAgbHAgPSBsb2dwcmlvcih0aGV0YSwgc2VsZi5wcmlvcnMsIHNlbGYucGFyYW1fbmFtZXMgb3IgTm9uZSkKICAgICAgICBpZiBub3QgbnAuaXNmaW5pdGUobHApOgogICAgICAgICAgICByZXR1cm4gLW5wLmluZgogICAgICAgIHJldHVybiBscCArIHNlbGYubG9nbGlrZSh0aGV0YSkKZGVmIG1ldHJvcG9saXNfaGFzdGluZ3MoCiAgICBsb2dwOiBDYWxsYWJsZVtbQXJyYXldLCBmbG9hdF0sCiAgICB4MDogQXJyYXksCiAgICBuc3RlcHM6IGludCwKICAgIHByb3Bvc2FsX3NjYWxlOiBVbmlvbltmbG9hdCwgQXJyYXldID0gMC4xLAogICAgcm5nOiBPcHRpb25hbFtucC5yYW5kb20uR2VuZXJhdG9yXSA9IE5vbmUsCikgLT4gVHVwbGVbQXJyYXksIEFycmF5LCBmbG9hdF06CiAgICAiIiJSYW5kb20td2FsayBNZXRyb3BvbGlzLUhhc3RpbmdzIHNhbXBsZXIgKEdhdXNzaWFuIHByb3Bvc2FscykuIiIiCiAgICBybmcgPSBucC5yYW5kb20uZGVmYXVsdF9ybmcoKSBpZiBybmcgaXMgTm9uZSBlbHNlIHJuZwogICAgeCA9IF9hc18xZCh4MCkuY29weSgpCiAgICBkID0geC5zaXplCiAgICBzID0gbnAuYXNhcnJheShwcm9wb3NhbF9zY2FsZSwgZHR5cGU9ZmxvYXQpCiAgICBzdGVwID0gKG5wLm9uZXMoZCkgKiBmbG9hdChzKSkgaWYgcy5uZGltID09IDAgZWxzZSBzLnJlc2hhcGUoLTEpCiAgICBpZiBzdGVwLnNpemUgIT0gZDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJwcm9wb3NhbF9zY2FsZSBoYXMgd3JvbmcgZGltZW5zaW9uIikKICAgIGNoYWluID0gbnAuZW1wdHkoKG5zdGVwcywgZCksIGR0eXBlPWZsb2F0KQogICAgbHBzID0gbnAuZW1wdHkobnN0ZXBzLCBkdHlwZT1mbG9hdCkKICAgIGxwID0gZmxvYXQobG9ncCh4KSkKICAgIGFjYyA9IDAKICAgIGZvciB0IGluIHJhbmdlKG5zdGVwcyk6CiAgICAgICAgcHJvcCA9IHggKyBybmcubm9ybWFsKHNjYWxlPXN0ZXAsIHNpemU9ZCkKICAgICAgICBscHAgPSBmbG9hdChsb2dwKHByb3ApKQogICAgICAgIGlmIG5wLmlzZmluaXRlKGxwcCkgYW5kIG5wLmxvZyhybmcucmFuZG9tKCkpIDwgKGxwcCAtIGxwKToKICAgICAgICAgICAgeCwgbHAgPSBwcm9wLCBscHAKICAgICAgICAgICAgYWNjICs9IDEKICAgICAgICBjaGFpblt0XSwgbHBzW3RdID0geCwgbHAKICAgIHJldHVybiBjaGFpbiwgbHBzLCBhY2MgLyBtYXgoMSwgbnN0ZXBzKQpkZWYgc3VtbWFyaXplX2NoYWluKGNoYWluOiBBcnJheSwgcXM6IFNlcXVlbmNlW2Zsb2F0XSA9ICgwLjE2LCAwLjUsIDAuODQpKSAtPiBEaWN0W3N0ciwgQXJyYXldOgogICAgY2hhaW4gPSBucC5hc2FycmF5KGNoYWluLCBkdHlwZT1mbG9hdCkKICAgIGlmIGNoYWluLm5kaW0gIT0gMjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJjaGFpbiBtdXN0IGJlIChuc3RlcHMsIG5kaW0pIikKICAgIG1lYW4gPSBjaGFpbi5tZWFuKGF4aXM9MCkKICAgIGNvdiA9IG5wLmNvdihjaGFpbi5UKQogICAgcXVhbnQgPSBucC5xdWFudGlsZShjaGFpbiwgcXMsIGF4aXM9MCkKICAgIHJldHVybiB7Im1lYW4iOiBtZWFuLCAiY292IjogY292LCAicXVhbnRpbGVzIjogcXVhbnR9CgoKZGVmIG1hcF9maXRfcmFuZG9tKAogICAgbG9ncG9zdDogQ2FsbGFibGVbW0FycmF5XSwgZmxvYXRdLAogICAgYm91bmRzOiBTZXF1ZW5jZVtUdXBsZVtmbG9hdCwgZmxvYXRdXSwKICAgIG5zYW1wbGVzOiBpbnQgPSAyMDAwLAogICAgcm5nOiBPcHRpb25hbFtucC5yYW5kb20uR2VuZXJhdG9yXSA9IE5vbmUsCikgLT4gVHVwbGVbQXJyYXksIGZsb2F0XToKICAgICIiIkNydWRlIGZyZXF1ZW50aXN0L01BUCBmaXQgYnkgcmFuZG9tIHNlYXJjaCB3aXRoaW4gYm91bmRzLiIiIgogICAgcm5nID0gbnAucmFuZG9tLmRlZmF1bHRfcm5nKCkgaWYgcm5nIGlzIE5vbmUgZWxzZSBybmcKICAgIGxvID0gbnAuYXJyYXkoW2JbMF0gZm9yIGIgaW4gYm91bmRzXSwgZHR5cGU9ZmxvYXQpCiAgICBoaSA9IG5wLmFycmF5KFtiWzFdIGZvciBiIGluIGJvdW5kc10sIGR0eXBlPWZsb2F0KQogICAgYmVzdF94ID0gbG8uY29weSgpCiAgICBiZXN0X2xwID0gLW5wLmluZgogICAgZm9yIF8gaW4gcmFuZ2UoaW50KG5zYW1wbGVzKSk6CiAgICAgICAgeCA9IGxvICsgKGhpIC0gbG8pICogcm5nLnJhbmRvbShzaXplPWxvLnNpemUpCiAgICAgICAgbHAgPSBmbG9hdChsb2dwb3N0KHgpKQogICAgICAgIGlmIGxwID4gYmVzdF9scDoKICAgICAgICAgICAgYmVzdF94LCBiZXN0X2xwID0geCwgbHAKICAgIHJldHVybiBiZXN0X3gsIGJlc3RfbHAK\"}\nDIR_STATE:[\"src/dgpipe/__init__.py\",\"src/dgpipe/cli.py\",\"src/dgpipe/inference.py\",\"src/dgpipe/io.py\",\"src/dgpipe/models.py\",\"src/dgpipe/protocols.py\",\"src/dgpipe/simulations.py\"]",
  "reasoning": "",
  "responseId": "resp_0fb92075272002ab006949b65a96388195b117fff75602a288",
  "model": "gpt-5.2-2025-12-11",
  "usage": {
    "input_tokens": 7310,
    "input_tokens_details": {
      "cached_tokens": 0
    },
    "output_tokens": 6262,
    "output_tokens_details": {
      "reasoning_tokens": 26
    },
    "total_tokens": 13572
  },
  "hadError": false,
  "errorType": null,
  "webSearchSources": [],
  "citations": [],
  "output": [
    {
      "id": "rs_0fb92075272002ab006949b65b375c8195a541958be1878ee7",
      "type": "reasoning",
      "summary": []
    },
    {
      "id": "ci_0fb92075272002ab006949b65c3b548195885193a35a7db3c0",
      "type": "code_interpreter_call",
      "status": "completed",
      "code": "from pathlib import Path\nimport base64, json, hashlib, gzip\n\ntarget_path = Path('/mnt/data').joinpath('src/dgpipe/inference.py')\nassert target_path.is_file(), 'Expected src/dgpipe/inference.py to exist before export'\ndata = target_path.read_bytes()\n\npayload = {\n    'path': 'src/dgpipe/inference.py',\n    'size': len(data),\n    'encoding': 'base64',\n    'sha256': hashlib.sha256(data).hexdigest(),\n    'content': None\n}\n\nif len(data) > 20000:\n    compressed = gzip.compress(data)\n    payload['encoding'] = 'gzip+base64'\n    payload['content'] = base64.b64encode(compressed).decode('ascii')\nelse:\n    payload['content'] = base64.b64encode(data).decode('ascii')\n\nprint('FILE_EXPORT:' + json.dumps(payload, separators=(',', ':')))\nprint('DIR_STATE:' + json.dumps(sorted(str(p.relative_to(Path(\"/mnt/data\"))) for p in target_path.parent.glob('*') if p.is_file())))",
      "container_id": "cntr_6949aff88f24819097f165c497ce475e074f2320f5d510c4",
      "outputs": [
        {
          "type": "logs",
          "logs": "FILE_EXPORT:{\"path\":\"src/dgpipe/inference.py\",\"size\":7095,\"encoding\":\"base64\",\"sha256\":\"0f8795dcde695703b742e6dbb9bdc46d3e542a0afbf7731f65f2c3298c9f3306\",\"content\":\"IiIiZGdwaXBlLmluZmVyZW5jZQoKTGlnaHR3ZWlnaHQgc3RhdGlzdGljYWwgaW5mZXJlbmNlIHV0aWxpdGllcyB0byB0cmFuc2xhdGUgbWVhc3VyZWQgY29ycmVsYXRvciAvCmVudGFuZ2xlbWVudCBkYXRhIGludG8gY29uc3RyYWludHMgb24gZGlzY3JldGUtc3RydWN0dXJlIHBhcmFtZXRlcnMuCgpEZXNpZ24gZ29hbHM6IG1pbmltYWwgZGVwZW5kZW5jaWVzIChudW1weSBvbmx5KSwgc3VwcG9ydCBmb3IgR2F1c3NpYW4KbGlrZWxpaG9vZHMsIGFkZGl0aXZlIGxpbmVhciBzeXN0ZW1hdGljcyB3aXRoIGFuYWx5dGljIG1hcmdpbmFsaXphdGlvbiwgYW5kIGEKYmFzaWMgTWV0cm9wb2xpcy1IYXN0aW5ncyBwb3N0ZXJpb3Igc2FtcGxlci4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBEaWN0LCBJdGVyYWJsZSwgTWFwcGluZywgT3B0aW9uYWwsIFNlcXVlbmNlLCBUdXBsZSwgVW5pb24KCmltcG9ydCBudW1weSBhcyBucAoKQXJyYXkgPSBucC5uZGFycmF5ClByaW9yU3BlYyA9IFVuaW9uW1R1cGxlW3N0ciwgZmxvYXQsIGZsb2F0XSwgVHVwbGVbc3RyLCBBcnJheSwgQXJyYXldXSAgIyB1bmlmb3JtL2dhdXNzaWFuCmRlZiBfYXNfMWQoeDogVW5pb25bQXJyYXksIFNlcXVlbmNlW2Zsb2F0XV0pIC0+IEFycmF5OgogICAgeCA9IG5wLmFzYXJyYXkoeCwgZHR5cGU9ZmxvYXQpCiAgICByZXR1cm4geC5yZXNoYXBlKC0xKQoKCmRlZiBfY292X2Zyb21fc2lnbWEoc2lnbWE6IFVuaW9uW2Zsb2F0LCBBcnJheV0sIG46IGludCkgLT4gQXJyYXk6CiAgICBzID0gbnAuYXNhcnJheShzaWdtYSwgZHR5cGU9ZmxvYXQpCiAgICBpZiBzLm5kaW0gPT0gMDoKICAgICAgICByZXR1cm4gbnAuZXllKG4pICogZmxvYXQocykgKiogMgogICAgcyA9IHMucmVzaGFwZSgtMSkKICAgIGlmIHMuc2l6ZSAhPSBuOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJzaWdtYSBoYXMgc2l6ZSB7cy5zaXplfSwgZXhwZWN0ZWQge259IikKICAgIHJldHVybiBucC5kaWFnKHMgKiogMikKCgpkZWYgX2xvZ2xpa2VfZ2F1c3NpYW4ocmVzaWQ6IEFycmF5LCBjb3Y6IEFycmF5KSAtPiBmbG9hdDoKICAgIGNvdiA9IG5wLmFzYXJyYXkoY292LCBkdHlwZT1mbG9hdCkKICAgIG4gPSByZXNpZC5zaXplCiAgICB0cnk6CiAgICAgICAgTCA9IG5wLmxpbmFsZy5jaG9sZXNreShjb3YpCiAgICAgICAgc29sID0gbnAubGluYWxnLnNvbHZlKEwsIHJlc2lkKQogICAgICAgIHF1YWQgPSBmbG9hdChzb2wgQCBzb2wpCiAgICAgICAgbG9nZGV0ID0gMi4wICogZmxvYXQobnAubG9nKG5wLmRpYWcoTCkpLnN1bSgpKQogICAgZXhjZXB0IG5wLmxpbmFsZy5MaW5BbGdFcnJvcjoKICAgICAgICBjb3ZpID0gbnAubGluYWxnLnBpbnYoY292KQogICAgICAgIHF1YWQgPSBmbG9hdChyZXNpZCBAIGNvdmkgQCByZXNpZCkKICAgICAgICBzaWduLCBsb2dkZXQgPSBucC5saW5hbGcuc2xvZ2RldChjb3YgKyAxZS0xMiAqIG5wLmV5ZShuKSkKICAgICAgICBsb2dkZXQgPSBmbG9hdChsb2dkZXQpIGlmIHNpZ24gPiAwIGVsc2UgZmxvYXQobnAubG9nKG5wLmFicyhucC5saW5hbGcuZGV0KGNvdikgKyAxZS0zMCkpKQogICAgcmV0dXJuIC0wLjUgKiAocXVhZCArIGxvZ2RldCArIG4gKiBucC5sb2coMi4wICogbnAucGkpKQpkZWYgbWFyZ2luYWxfbG9nbGlrZV9hZGRpdGl2ZV9saW5lYXIoCiAgICB5OiBBcnJheSwKICAgIG11OiBBcnJheSwKICAgIGNvdl95OiBBcnJheSwKICAgIEE6IE9wdGlvbmFsW0FycmF5XSA9IE5vbmUsCiAgICBudV9tZWFuOiBPcHRpb25hbFtBcnJheV0gPSBOb25lLAogICAgbnVfY292OiBPcHRpb25hbFtBcnJheV0gPSBOb25lLAopIC0+IGZsb2F0OgogICAgIiIiR2F1c3NpYW4gbG9nLWxpa2VsaWhvb2Qgd2l0aCBhbmFseXRpYyBtYXJnaW5hbGl6YXRpb24gb3ZlciBudWlzYW5jZS4KCiAgICBNb2RlbDogeSA9IG11KHRoZXRhKSArIEEgbnUgKyBlcHMsICBlcHN+TigwLGNvdl95KSwgIG51fk4obnVfbWVhbixudV9jb3YpLgogICAgVGhlIG1hcmdpbmFsaXplZCBkaXN0cmlidXRpb24gaXMgR2F1c3NpYW4gd2l0aCBtZWFuIG11ICsgQSBudV9tZWFuIGFuZAogICAgY292YXJpYW5jZSBjb3ZfeSArIEEgbnVfY292IEFeVC4KICAgICIiIgogICAgeSA9IF9hc18xZCh5KQogICAgbXUgPSBfYXNfMWQobXUpCiAgICBpZiB5LnNpemUgIT0gbXUuc2l6ZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ5IGFuZCBtdSBtdXN0IGhhdmUgc2FtZSBsZW5ndGgiKQogICAgY292X2VmZiA9IG5wLmFzYXJyYXkoY292X3ksIGR0eXBlPWZsb2F0KQogICAgbWVhbl9lZmYgPSBtdQogICAgaWYgQSBpcyBub3QgTm9uZSBhbmQgbnVfY292IGlzIG5vdCBOb25lOgogICAgICAgIEEgPSBucC5hc2FycmF5KEEsIGR0eXBlPWZsb2F0KQogICAgICAgIG51X21lYW4gPSBucC56ZXJvcyhBLnNoYXBlWzFdKSBpZiBudV9tZWFuIGlzIE5vbmUgZWxzZSBfYXNfMWQobnVfbWVhbikKICAgICAgICBudV9jb3YgPSBucC5hc2FycmF5KG51X2NvdiwgZHR5cGU9ZmxvYXQpCiAgICAgICAgbWVhbl9lZmYgPSBtdSArIEEgQCBudV9tZWFuCiAgICAgICAgY292X2VmZiA9IGNvdl9lZmYgKyBBIEAgbnVfY292IEAgQS5UCiAgICByZXR1cm4gX2xvZ2xpa2VfZ2F1c3NpYW4oeSAtIG1lYW5fZWZmLCBjb3ZfZWZmKQpkZWYgbG9ncHJpb3IodGhldGE6IEFycmF5LCBwcmlvcnM6IE9wdGlvbmFsW01hcHBpbmdbc3RyLCBQcmlvclNwZWNdXSA9IE5vbmUsIG5hbWVzOiBPcHRpb25hbFtTZXF1ZW5jZVtzdHJdXSA9IE5vbmUpIC0+IGZsb2F0OgogICAgIiIiQ29tcHV0ZSBsb2cgcHJpb3IgZm9yIHBhcmFtZXRlciB2ZWN0b3IgdGhldGEuCgogICAgcHJpb3JzIG1hcHMgcGFyYW1ldGVyIG5hbWUgLT4gKCd1bmlmb3JtJywgbG93LCBoaWdoKSBvciAoJ2dhdXNzaWFuJywgbWVhbiwgY292KS4KICAgIEZvciBnYXVzc2lhbjogbWVhbiBhbmQgY292IGNhbiBiZSBzY2FsYXJzIChpbnRlcnByZXRlZCBhcyBkaWFnb25hbCB2YXJpYW5jZSkgb3IgYXJyYXlzLgogICAgIiIiCiAgICBpZiBub3QgcHJpb3JzOgogICAgICAgIHJldHVybiAwLjAKICAgIHRoZXRhID0gX2FzXzFkKHRoZXRhKQogICAgaWYgbmFtZXMgaXMgTm9uZToKICAgICAgICBuYW1lcyA9IFtmInB7aX0iIGZvciBpIGluIHJhbmdlKHRoZXRhLnNpemUpXQogICAgbHAgPSAwLjAKICAgIGZvciBpLCBubSBpbiBlbnVtZXJhdGUobmFtZXMpOgogICAgICAgIGlmIG5tIG5vdCBpbiBwcmlvcnM6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgc3BlYyA9IHByaW9yc1tubV0KICAgICAgICBpZiBzcGVjWzBdID09ICJ1bmlmb3JtIjoKICAgICAgICAgICAgbG8sIGhpID0gZmxvYXQoc3BlY1sxXSksIGZsb2F0KHNwZWNbMl0pCiAgICAgICAgICAgIGlmIG5vdCAobG8gPD0gdGhldGFbaV0gPD0gaGkpOgogICAgICAgICAgICAgICAgcmV0dXJuIC1ucC5pbmYKICAgICAgICBlbGlmIHNwZWNbMF0gPT0gImdhdXNzaWFuIjoKICAgICAgICAgICAgbWVhbiA9IG5wLmFzYXJyYXkoc3BlY1sxXSwgZHR5cGU9ZmxvYXQpCiAgICAgICAgICAgIGNvdiA9IG5wLmFzYXJyYXkoc3BlY1syXSwgZHR5cGU9ZmxvYXQpCiAgICAgICAgICAgIG0gPSBmbG9hdChtZWFuKSBpZiBtZWFuLm5kaW0gPT0gMCBlbHNlIGZsb2F0KG1lYW4ucmVzaGFwZSgtMSlbMF0pCiAgICAgICAgICAgIHYgPSBmbG9hdChjb3YpIGlmIGNvdi5uZGltID09IDAgZWxzZSBmbG9hdChucC5kaWFnKGNvdikucmVzaGFwZSgtMSlbMF0pCiAgICAgICAgICAgIGxwICs9IC0wLjUgKiAoKHRoZXRhW2ldIC0gbSkgKiogMiAvIHYgKyBucC5sb2coMi4wICogbnAucGkgKiB2KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiVW5rbm93biBwcmlvciB0eXBlOiB7c3BlY1swXX0iKQogICAgcmV0dXJuIGZsb2F0KGxwKQpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmZlcmVuY2VQcm9ibGVtOgogICAgIiIiQnVuZGxlIGEgZGF0YXNldCwgYSBmb3J3YXJkIG1vZGVsLCBhbmQgc3lzdGVtYXRpY3MgZm9yIGluZmVyZW5jZS4iIiIKCiAgICB4OiBBcnJheQogICAgeTogQXJyYXkKICAgIHNpZ21hOiBVbmlvbltmbG9hdCwgQXJyYXldCiAgICBtb2RlbDogQ2FsbGFibGVbW0FycmF5LCBBcnJheV0sIEFycmF5XSAgIyBtb2RlbCh0aGV0YSwgeCktPm11CiAgICBwYXJhbV9uYW1lczogVHVwbGVbc3RyLCAuLi5dID0gKCkKICAgIHByaW9yczogT3B0aW9uYWxbRGljdFtzdHIsIFByaW9yU3BlY11dID0gTm9uZQogICAgQV9udWlzYW5jZTogT3B0aW9uYWxbQXJyYXldID0gTm9uZQogICAgbnVpc2FuY2VfbWVhbjogT3B0aW9uYWxbQXJyYXldID0gTm9uZQogICAgbnVpc2FuY2VfY292OiBPcHRpb25hbFtBcnJheV0gPSBOb25lCgogICAgZGVmIGxvZ2xpa2Uoc2VsZiwgdGhldGE6IEFycmF5KSAtPiBmbG9hdDoKICAgICAgICBtdSA9IF9hc18xZChzZWxmLm1vZGVsKF9hc18xZCh0aGV0YSksIG5wLmFzYXJyYXkoc2VsZi54KSkpCiAgICAgICAgeSA9IF9hc18xZChzZWxmLnkpCiAgICAgICAgY292X3kgPSBfY292X2Zyb21fc2lnbWEoc2VsZi5zaWdtYSwgeS5zaXplKQogICAgICAgIHJldHVybiBtYXJnaW5hbF9sb2dsaWtlX2FkZGl0aXZlX2xpbmVhcigKICAgICAgICAgICAgeT15LCBtdT1tdSwgY292X3k9Y292X3ksIEE9c2VsZi5BX251aXNhbmNlLCBudV9tZWFuPXNlbGYubnVpc2FuY2VfbWVhbiwgbnVfY292PXNlbGYubnVpc2FuY2VfY292CiAgICAgICAgKQoKICAgIGRlZiBsb2dwb3N0KHNlbGYsIHRoZXRhOiBBcnJheSkgLT4gZmxvYXQ6CiAgICAgICAgbHAgPSBsb2dwcmlvcih0aGV0YSwgc2VsZi5wcmlvcnMsIHNlbGYucGFyYW1fbmFtZXMgb3IgTm9uZSkKICAgICAgICBpZiBub3QgbnAuaXNmaW5pdGUobHApOgogICAgICAgICAgICByZXR1cm4gLW5wLmluZgogICAgICAgIHJldHVybiBscCArIHNlbGYubG9nbGlrZSh0aGV0YSkKZGVmIG1ldHJvcG9saXNfaGFzdGluZ3MoCiAgICBsb2dwOiBDYWxsYWJsZVtbQXJyYXldLCBmbG9hdF0sCiAgICB4MDogQXJyYXksCiAgICBuc3RlcHM6IGludCwKICAgIHByb3Bvc2FsX3NjYWxlOiBVbmlvbltmbG9hdCwgQXJyYXldID0gMC4xLAogICAgcm5nOiBPcHRpb25hbFtucC5yYW5kb20uR2VuZXJhdG9yXSA9IE5vbmUsCikgLT4gVHVwbGVbQXJyYXksIEFycmF5LCBmbG9hdF06CiAgICAiIiJSYW5kb20td2FsayBNZXRyb3BvbGlzLUhhc3RpbmdzIHNhbXBsZXIgKEdhdXNzaWFuIHByb3Bvc2FscykuIiIiCiAgICBybmcgPSBucC5yYW5kb20uZGVmYXVsdF9ybmcoKSBpZiBybmcgaXMgTm9uZSBlbHNlIHJuZwogICAgeCA9IF9hc18xZCh4MCkuY29weSgpCiAgICBkID0geC5zaXplCiAgICBzID0gbnAuYXNhcnJheShwcm9wb3NhbF9zY2FsZSwgZHR5cGU9ZmxvYXQpCiAgICBzdGVwID0gKG5wLm9uZXMoZCkgKiBmbG9hdChzKSkgaWYgcy5uZGltID09IDAgZWxzZSBzLnJlc2hhcGUoLTEpCiAgICBpZiBzdGVwLnNpemUgIT0gZDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJwcm9wb3NhbF9zY2FsZSBoYXMgd3JvbmcgZGltZW5zaW9uIikKICAgIGNoYWluID0gbnAuZW1wdHkoKG5zdGVwcywgZCksIGR0eXBlPWZsb2F0KQogICAgbHBzID0gbnAuZW1wdHkobnN0ZXBzLCBkdHlwZT1mbG9hdCkKICAgIGxwID0gZmxvYXQobG9ncCh4KSkKICAgIGFjYyA9IDAKICAgIGZvciB0IGluIHJhbmdlKG5zdGVwcyk6CiAgICAgICAgcHJvcCA9IHggKyBybmcubm9ybWFsKHNjYWxlPXN0ZXAsIHNpemU9ZCkKICAgICAgICBscHAgPSBmbG9hdChsb2dwKHByb3ApKQogICAgICAgIGlmIG5wLmlzZmluaXRlKGxwcCkgYW5kIG5wLmxvZyhybmcucmFuZG9tKCkpIDwgKGxwcCAtIGxwKToKICAgICAgICAgICAgeCwgbHAgPSBwcm9wLCBscHAKICAgICAgICAgICAgYWNjICs9IDEKICAgICAgICBjaGFpblt0XSwgbHBzW3RdID0geCwgbHAKICAgIHJldHVybiBjaGFpbiwgbHBzLCBhY2MgLyBtYXgoMSwgbnN0ZXBzKQpkZWYgc3VtbWFyaXplX2NoYWluKGNoYWluOiBBcnJheSwgcXM6IFNlcXVlbmNlW2Zsb2F0XSA9ICgwLjE2LCAwLjUsIDAuODQpKSAtPiBEaWN0W3N0ciwgQXJyYXldOgogICAgY2hhaW4gPSBucC5hc2FycmF5KGNoYWluLCBkdHlwZT1mbG9hdCkKICAgIGlmIGNoYWluLm5kaW0gIT0gMjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJjaGFpbiBtdXN0IGJlIChuc3RlcHMsIG5kaW0pIikKICAgIG1lYW4gPSBjaGFpbi5tZWFuKGF4aXM9MCkKICAgIGNvdiA9IG5wLmNvdihjaGFpbi5UKQogICAgcXVhbnQgPSBucC5xdWFudGlsZShjaGFpbiwgcXMsIGF4aXM9MCkKICAgIHJldHVybiB7Im1lYW4iOiBtZWFuLCAiY292IjogY292LCAicXVhbnRpbGVzIjogcXVhbnR9CgoKZGVmIG1hcF9maXRfcmFuZG9tKAogICAgbG9ncG9zdDogQ2FsbGFibGVbW0FycmF5XSwgZmxvYXRdLAogICAgYm91bmRzOiBTZXF1ZW5jZVtUdXBsZVtmbG9hdCwgZmxvYXRdXSwKICAgIG5zYW1wbGVzOiBpbnQgPSAyMDAwLAogICAgcm5nOiBPcHRpb25hbFtucC5yYW5kb20uR2VuZXJhdG9yXSA9IE5vbmUsCikgLT4gVHVwbGVbQXJyYXksIGZsb2F0XToKICAgICIiIkNydWRlIGZyZXF1ZW50aXN0L01BUCBmaXQgYnkgcmFuZG9tIHNlYXJjaCB3aXRoaW4gYm91bmRzLiIiIgogICAgcm5nID0gbnAucmFuZG9tLmRlZmF1bHRfcm5nKCkgaWYgcm5nIGlzIE5vbmUgZWxzZSBybmcKICAgIGxvID0gbnAuYXJyYXkoW2JbMF0gZm9yIGIgaW4gYm91bmRzXSwgZHR5cGU9ZmxvYXQpCiAgICBoaSA9IG5wLmFycmF5KFtiWzFdIGZvciBiIGluIGJvdW5kc10sIGR0eXBlPWZsb2F0KQogICAgYmVzdF94ID0gbG8uY29weSgpCiAgICBiZXN0X2xwID0gLW5wLmluZgogICAgZm9yIF8gaW4gcmFuZ2UoaW50KG5zYW1wbGVzKSk6CiAgICAgICAgeCA9IGxvICsgKGhpIC0gbG8pICogcm5nLnJhbmRvbShzaXplPWxvLnNpemUpCiAgICAgICAgbHAgPSBmbG9hdChsb2dwb3N0KHgpKQogICAgICAgIGlmIGxwID4gYmVzdF9scDoKICAgICAgICAgICAgYmVzdF94LCBiZXN0X2xwID0geCwgbHAKICAgIHJldHVybiBiZXN0X3gsIGJlc3RfbHAK\"}\nDIR_STATE:[\"src/dgpipe/__init__.py\", \"src/dgpipe/cli.py\", \"src/dgpipe/inference.py\", \"src/dgpipe/io.py\", \"src/dgpipe/models.py\", \"src/dgpipe/protocols.py\", \"src/dgpipe/simulations.py\"]\n"
        }
      ]
    },
    {
      "id": "msg_0fb92075272002ab006949b661c6648195963daf514374e1bd",
      "type": "message",
      "status": "completed",
      "content": [
        {
          "type": "output_text",
          "annotations": [],
          "logprobs": [],
          "text": "FILE_EXPORT:{\"path\":\"src/dgpipe/inference.py\",\"size\":7095,\"encoding\":\"base64\",\"sha256\":\"0f8795dcde695703b742e6dbb9bdc46d3e542a0afbf7731f65f2c3298c9f3306\",\"content\":\"IiIiZGdwaXBlLmluZmVyZW5jZQoKTGlnaHR3ZWlnaHQgc3RhdGlzdGljYWwgaW5mZXJlbmNlIHV0aWxpdGllcyB0byB0cmFuc2xhdGUgbWVhc3VyZWQgY29ycmVsYXRvciAvCmVudGFuZ2xlbWVudCBkYXRhIGludG8gY29uc3RyYWludHMgb24gZGlzY3JldGUtc3RydWN0dXJlIHBhcmFtZXRlcnMuCgpEZXNpZ24gZ29hbHM6IG1pbmltYWwgZGVwZW5kZW5jaWVzIChudW1weSBvbmx5KSwgc3VwcG9ydCBmb3IgR2F1c3NpYW4KbGlrZWxpaG9vZHMsIGFkZGl0aXZlIGxpbmVhciBzeXN0ZW1hdGljcyB3aXRoIGFuYWx5dGljIG1hcmdpbmFsaXphdGlvbiwgYW5kIGEKYmFzaWMgTWV0cm9wb2xpcy1IYXN0aW5ncyBwb3N0ZXJpb3Igc2FtcGxlci4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBEaWN0LCBJdGVyYWJsZSwgTWFwcGluZywgT3B0aW9uYWwsIFNlcXVlbmNlLCBUdXBsZSwgVW5pb24KCmltcG9ydCBudW1weSBhcyBucAoKQXJyYXkgPSBucC5uZGFycmF5ClByaW9yU3BlYyA9IFVuaW9uW1R1cGxlW3N0ciwgZmxvYXQsIGZsb2F0XSwgVHVwbGVbc3RyLCBBcnJheSwgQXJyYXldXSAgIyB1bmlmb3JtL2dhdXNzaWFuCmRlZiBfYXNfMWQoeDogVW5pb25bQXJyYXksIFNlcXVlbmNlW2Zsb2F0XV0pIC0+IEFycmF5OgogICAgeCA9IG5wLmFzYXJyYXkoeCwgZHR5cGU9ZmxvYXQpCiAgICByZXR1cm4geC5yZXNoYXBlKC0xKQoKCmRlZiBfY292X2Zyb21fc2lnbWEoc2lnbWE6IFVuaW9uW2Zsb2F0LCBBcnJheV0sIG46IGludCkgLT4gQXJyYXk6CiAgICBzID0gbnAuYXNhcnJheShzaWdtYSwgZHR5cGU9ZmxvYXQpCiAgICBpZiBzLm5kaW0gPT0gMDoKICAgICAgICByZXR1cm4gbnAuZXllKG4pICogZmxvYXQocykgKiogMgogICAgcyA9IHMucmVzaGFwZSgtMSkKICAgIGlmIHMuc2l6ZSAhPSBuOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJzaWdtYSBoYXMgc2l6ZSB7cy5zaXplfSwgZXhwZWN0ZWQge259IikKICAgIHJldHVybiBucC5kaWFnKHMgKiogMikKCgpkZWYgX2xvZ2xpa2VfZ2F1c3NpYW4ocmVzaWQ6IEFycmF5LCBjb3Y6IEFycmF5KSAtPiBmbG9hdDoKICAgIGNvdiA9IG5wLmFzYXJyYXkoY292LCBkdHlwZT1mbG9hdCkKICAgIG4gPSByZXNpZC5zaXplCiAgICB0cnk6CiAgICAgICAgTCA9IG5wLmxpbmFsZy5jaG9sZXNreShjb3YpCiAgICAgICAgc29sID0gbnAubGluYWxnLnNvbHZlKEwsIHJlc2lkKQogICAgICAgIHF1YWQgPSBmbG9hdChzb2wgQCBzb2wpCiAgICAgICAgbG9nZGV0ID0gMi4wICogZmxvYXQobnAubG9nKG5wLmRpYWcoTCkpLnN1bSgpKQogICAgZXhjZXB0IG5wLmxpbmFsZy5MaW5BbGdFcnJvcjoKICAgICAgICBjb3ZpID0gbnAubGluYWxnLnBpbnYoY292KQogICAgICAgIHF1YWQgPSBmbG9hdChyZXNpZCBAIGNvdmkgQCByZXNpZCkKICAgICAgICBzaWduLCBsb2dkZXQgPSBucC5saW5hbGcuc2xvZ2RldChjb3YgKyAxZS0xMiAqIG5wLmV5ZShuKSkKICAgICAgICBsb2dkZXQgPSBmbG9hdChsb2dkZXQpIGlmIHNpZ24gPiAwIGVsc2UgZmxvYXQobnAubG9nKG5wLmFicyhucC5saW5hbGcuZGV0KGNvdikgKyAxZS0zMCkpKQogICAgcmV0dXJuIC0wLjUgKiAocXVhZCArIGxvZ2RldCArIG4gKiBucC5sb2coMi4wICogbnAucGkpKQpkZWYgbWFyZ2luYWxfbG9nbGlrZV9hZGRpdGl2ZV9saW5lYXIoCiAgICB5OiBBcnJheSwKICAgIG11OiBBcnJheSwKICAgIGNvdl95OiBBcnJheSwKICAgIEE6IE9wdGlvbmFsW0FycmF5XSA9IE5vbmUsCiAgICBudV9tZWFuOiBPcHRpb25hbFtBcnJheV0gPSBOb25lLAogICAgbnVfY292OiBPcHRpb25hbFtBcnJheV0gPSBOb25lLAopIC0+IGZsb2F0OgogICAgIiIiR2F1c3NpYW4gbG9nLWxpa2VsaWhvb2Qgd2l0aCBhbmFseXRpYyBtYXJnaW5hbGl6YXRpb24gb3ZlciBudWlzYW5jZS4KCiAgICBNb2RlbDogeSA9IG11KHRoZXRhKSArIEEgbnUgKyBlcHMsICBlcHN+TigwLGNvdl95KSwgIG51fk4obnVfbWVhbixudV9jb3YpLgogICAgVGhlIG1hcmdpbmFsaXplZCBkaXN0cmlidXRpb24gaXMgR2F1c3NpYW4gd2l0aCBtZWFuIG11ICsgQSBudV9tZWFuIGFuZAogICAgY292YXJpYW5jZSBjb3ZfeSArIEEgbnVfY292IEFeVC4KICAgICIiIgogICAgeSA9IF9hc18xZCh5KQogICAgbXUgPSBfYXNfMWQobXUpCiAgICBpZiB5LnNpemUgIT0gbXUuc2l6ZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ5IGFuZCBtdSBtdXN0IGhhdmUgc2FtZSBsZW5ndGgiKQogICAgY292X2VmZiA9IG5wLmFzYXJyYXkoY292X3ksIGR0eXBlPWZsb2F0KQogICAgbWVhbl9lZmYgPSBtdQogICAgaWYgQSBpcyBub3QgTm9uZSBhbmQgbnVfY292IGlzIG5vdCBOb25lOgogICAgICAgIEEgPSBucC5hc2FycmF5KEEsIGR0eXBlPWZsb2F0KQogICAgICAgIG51X21lYW4gPSBucC56ZXJvcyhBLnNoYXBlWzFdKSBpZiBudV9tZWFuIGlzIE5vbmUgZWxzZSBfYXNfMWQobnVfbWVhbikKICAgICAgICBudV9jb3YgPSBucC5hc2FycmF5KG51X2NvdiwgZHR5cGU9ZmxvYXQpCiAgICAgICAgbWVhbl9lZmYgPSBtdSArIEEgQCBudV9tZWFuCiAgICAgICAgY292X2VmZiA9IGNvdl9lZmYgKyBBIEAgbnVfY292IEAgQS5UCiAgICByZXR1cm4gX2xvZ2xpa2VfZ2F1c3NpYW4oeSAtIG1lYW5fZWZmLCBjb3ZfZWZmKQpkZWYgbG9ncHJpb3IodGhldGE6IEFycmF5LCBwcmlvcnM6IE9wdGlvbmFsW01hcHBpbmdbc3RyLCBQcmlvclNwZWNdXSA9IE5vbmUsIG5hbWVzOiBPcHRpb25hbFtTZXF1ZW5jZVtzdHJdXSA9IE5vbmUpIC0+IGZsb2F0OgogICAgIiIiQ29tcHV0ZSBsb2cgcHJpb3IgZm9yIHBhcmFtZXRlciB2ZWN0b3IgdGhldGEuCgogICAgcHJpb3JzIG1hcHMgcGFyYW1ldGVyIG5hbWUgLT4gKCd1bmlmb3JtJywgbG93LCBoaWdoKSBvciAoJ2dhdXNzaWFuJywgbWVhbiwgY292KS4KICAgIEZvciBnYXVzc2lhbjogbWVhbiBhbmQgY292IGNhbiBiZSBzY2FsYXJzIChpbnRlcnByZXRlZCBhcyBkaWFnb25hbCB2YXJpYW5jZSkgb3IgYXJyYXlzLgogICAgIiIiCiAgICBpZiBub3QgcHJpb3JzOgogICAgICAgIHJldHVybiAwLjAKICAgIHRoZXRhID0gX2FzXzFkKHRoZXRhKQogICAgaWYgbmFtZXMgaXMgTm9uZToKICAgICAgICBuYW1lcyA9IFtmInB7aX0iIGZvciBpIGluIHJhbmdlKHRoZXRhLnNpemUpXQogICAgbHAgPSAwLjAKICAgIGZvciBpLCBubSBpbiBlbnVtZXJhdGUobmFtZXMpOgogICAgICAgIGlmIG5tIG5vdCBpbiBwcmlvcnM6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgc3BlYyA9IHByaW9yc1tubV0KICAgICAgICBpZiBzcGVjWzBdID09ICJ1bmlmb3JtIjoKICAgICAgICAgICAgbG8sIGhpID0gZmxvYXQoc3BlY1sxXSksIGZsb2F0KHNwZWNbMl0pCiAgICAgICAgICAgIGlmIG5vdCAobG8gPD0gdGhldGFbaV0gPD0gaGkpOgogICAgICAgICAgICAgICAgcmV0dXJuIC1ucC5pbmYKICAgICAgICBlbGlmIHNwZWNbMF0gPT0gImdhdXNzaWFuIjoKICAgICAgICAgICAgbWVhbiA9IG5wLmFzYXJyYXkoc3BlY1sxXSwgZHR5cGU9ZmxvYXQpCiAgICAgICAgICAgIGNvdiA9IG5wLmFzYXJyYXkoc3BlY1syXSwgZHR5cGU9ZmxvYXQpCiAgICAgICAgICAgIG0gPSBmbG9hdChtZWFuKSBpZiBtZWFuLm5kaW0gPT0gMCBlbHNlIGZsb2F0KG1lYW4ucmVzaGFwZSgtMSlbMF0pCiAgICAgICAgICAgIHYgPSBmbG9hdChjb3YpIGlmIGNvdi5uZGltID09IDAgZWxzZSBmbG9hdChucC5kaWFnKGNvdikucmVzaGFwZSgtMSlbMF0pCiAgICAgICAgICAgIGxwICs9IC0wLjUgKiAoKHRoZXRhW2ldIC0gbSkgKiogMiAvIHYgKyBucC5sb2coMi4wICogbnAucGkgKiB2KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiVW5rbm93biBwcmlvciB0eXBlOiB7c3BlY1swXX0iKQogICAgcmV0dXJuIGZsb2F0KGxwKQpAZGF0YWNsYXNzKGZyb3plbj1UcnVlKQpjbGFzcyBJbmZlcmVuY2VQcm9ibGVtOgogICAgIiIiQnVuZGxlIGEgZGF0YXNldCwgYSBmb3J3YXJkIG1vZGVsLCBhbmQgc3lzdGVtYXRpY3MgZm9yIGluZmVyZW5jZS4iIiIKCiAgICB4OiBBcnJheQogICAgeTogQXJyYXkKICAgIHNpZ21hOiBVbmlvbltmbG9hdCwgQXJyYXldCiAgICBtb2RlbDogQ2FsbGFibGVbW0FycmF5LCBBcnJheV0sIEFycmF5XSAgIyBtb2RlbCh0aGV0YSwgeCktPm11CiAgICBwYXJhbV9uYW1lczogVHVwbGVbc3RyLCAuLi5dID0gKCkKICAgIHByaW9yczogT3B0aW9uYWxbRGljdFtzdHIsIFByaW9yU3BlY11dID0gTm9uZQogICAgQV9udWlzYW5jZTogT3B0aW9uYWxbQXJyYXldID0gTm9uZQogICAgbnVpc2FuY2VfbWVhbjogT3B0aW9uYWxbQXJyYXldID0gTm9uZQogICAgbnVpc2FuY2VfY292OiBPcHRpb25hbFtBcnJheV0gPSBOb25lCgogICAgZGVmIGxvZ2xpa2Uoc2VsZiwgdGhldGE6IEFycmF5KSAtPiBmbG9hdDoKICAgICAgICBtdSA9IF9hc18xZChzZWxmLm1vZGVsKF9hc18xZCh0aGV0YSksIG5wLmFzYXJyYXkoc2VsZi54KSkpCiAgICAgICAgeSA9IF9hc18xZChzZWxmLnkpCiAgICAgICAgY292X3kgPSBfY292X2Zyb21fc2lnbWEoc2VsZi5zaWdtYSwgeS5zaXplKQogICAgICAgIHJldHVybiBtYXJnaW5hbF9sb2dsaWtlX2FkZGl0aXZlX2xpbmVhcigKICAgICAgICAgICAgeT15LCBtdT1tdSwgY292X3k9Y292X3ksIEE9c2VsZi5BX251aXNhbmNlLCBudV9tZWFuPXNlbGYubnVpc2FuY2VfbWVhbiwgbnVfY292PXNlbGYubnVpc2FuY2VfY292CiAgICAgICAgKQoKICAgIGRlZiBsb2dwb3N0KHNlbGYsIHRoZXRhOiBBcnJheSkgLT4gZmxvYXQ6CiAgICAgICAgbHAgPSBsb2dwcmlvcih0aGV0YSwgc2VsZi5wcmlvcnMsIHNlbGYucGFyYW1fbmFtZXMgb3IgTm9uZSkKICAgICAgICBpZiBub3QgbnAuaXNmaW5pdGUobHApOgogICAgICAgICAgICByZXR1cm4gLW5wLmluZgogICAgICAgIHJldHVybiBscCArIHNlbGYubG9nbGlrZSh0aGV0YSkKZGVmIG1ldHJvcG9saXNfaGFzdGluZ3MoCiAgICBsb2dwOiBDYWxsYWJsZVtbQXJyYXldLCBmbG9hdF0sCiAgICB4MDogQXJyYXksCiAgICBuc3RlcHM6IGludCwKICAgIHByb3Bvc2FsX3NjYWxlOiBVbmlvbltmbG9hdCwgQXJyYXldID0gMC4xLAogICAgcm5nOiBPcHRpb25hbFtucC5yYW5kb20uR2VuZXJhdG9yXSA9IE5vbmUsCikgLT4gVHVwbGVbQXJyYXksIEFycmF5LCBmbG9hdF06CiAgICAiIiJSYW5kb20td2FsayBNZXRyb3BvbGlzLUhhc3RpbmdzIHNhbXBsZXIgKEdhdXNzaWFuIHByb3Bvc2FscykuIiIiCiAgICBybmcgPSBucC5yYW5kb20uZGVmYXVsdF9ybmcoKSBpZiBybmcgaXMgTm9uZSBlbHNlIHJuZwogICAgeCA9IF9hc18xZCh4MCkuY29weSgpCiAgICBkID0geC5zaXplCiAgICBzID0gbnAuYXNhcnJheShwcm9wb3NhbF9zY2FsZSwgZHR5cGU9ZmxvYXQpCiAgICBzdGVwID0gKG5wLm9uZXMoZCkgKiBmbG9hdChzKSkgaWYgcy5uZGltID09IDAgZWxzZSBzLnJlc2hhcGUoLTEpCiAgICBpZiBzdGVwLnNpemUgIT0gZDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJwcm9wb3NhbF9zY2FsZSBoYXMgd3JvbmcgZGltZW5zaW9uIikKICAgIGNoYWluID0gbnAuZW1wdHkoKG5zdGVwcywgZCksIGR0eXBlPWZsb2F0KQogICAgbHBzID0gbnAuZW1wdHkobnN0ZXBzLCBkdHlwZT1mbG9hdCkKICAgIGxwID0gZmxvYXQobG9ncCh4KSkKICAgIGFjYyA9IDAKICAgIGZvciB0IGluIHJhbmdlKG5zdGVwcyk6CiAgICAgICAgcHJvcCA9IHggKyBybmcubm9ybWFsKHNjYWxlPXN0ZXAsIHNpemU9ZCkKICAgICAgICBscHAgPSBmbG9hdChsb2dwKHByb3ApKQogICAgICAgIGlmIG5wLmlzZmluaXRlKGxwcCkgYW5kIG5wLmxvZyhybmcucmFuZG9tKCkpIDwgKGxwcCAtIGxwKToKICAgICAgICAgICAgeCwgbHAgPSBwcm9wLCBscHAKICAgICAgICAgICAgYWNjICs9IDEKICAgICAgICBjaGFpblt0XSwgbHBzW3RdID0geCwgbHAKICAgIHJldHVybiBjaGFpbiwgbHBzLCBhY2MgLyBtYXgoMSwgbnN0ZXBzKQpkZWYgc3VtbWFyaXplX2NoYWluKGNoYWluOiBBcnJheSwgcXM6IFNlcXVlbmNlW2Zsb2F0XSA9ICgwLjE2LCAwLjUsIDAuODQpKSAtPiBEaWN0W3N0ciwgQXJyYXldOgogICAgY2hhaW4gPSBucC5hc2FycmF5KGNoYWluLCBkdHlwZT1mbG9hdCkKICAgIGlmIGNoYWluLm5kaW0gIT0gMjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJjaGFpbiBtdXN0IGJlIChuc3RlcHMsIG5kaW0pIikKICAgIG1lYW4gPSBjaGFpbi5tZWFuKGF4aXM9MCkKICAgIGNvdiA9IG5wLmNvdihjaGFpbi5UKQogICAgcXVhbnQgPSBucC5xdWFudGlsZShjaGFpbiwgcXMsIGF4aXM9MCkKICAgIHJldHVybiB7Im1lYW4iOiBtZWFuLCAiY292IjogY292LCAicXVhbnRpbGVzIjogcXVhbnR9CgoKZGVmIG1hcF9maXRfcmFuZG9tKAogICAgbG9ncG9zdDogQ2FsbGFibGVbW0FycmF5XSwgZmxvYXRdLAogICAgYm91bmRzOiBTZXF1ZW5jZVtUdXBsZVtmbG9hdCwgZmxvYXRdXSwKICAgIG5zYW1wbGVzOiBpbnQgPSAyMDAwLAogICAgcm5nOiBPcHRpb25hbFtucC5yYW5kb20uR2VuZXJhdG9yXSA9IE5vbmUsCikgLT4gVHVwbGVbQXJyYXksIGZsb2F0XToKICAgICIiIkNydWRlIGZyZXF1ZW50aXN0L01BUCBmaXQgYnkgcmFuZG9tIHNlYXJjaCB3aXRoaW4gYm91bmRzLiIiIgogICAgcm5nID0gbnAucmFuZG9tLmRlZmF1bHRfcm5nKCkgaWYgcm5nIGlzIE5vbmUgZWxzZSBybmcKICAgIGxvID0gbnAuYXJyYXkoW2JbMF0gZm9yIGIgaW4gYm91bmRzXSwgZHR5cGU9ZmxvYXQpCiAgICBoaSA9IG5wLmFycmF5KFtiWzFdIGZvciBiIGluIGJvdW5kc10sIGR0eXBlPWZsb2F0KQogICAgYmVzdF94ID0gbG8uY29weSgpCiAgICBiZXN0X2xwID0gLW5wLmluZgogICAgZm9yIF8gaW4gcmFuZ2UoaW50KG5zYW1wbGVzKSk6CiAgICAgICAgeCA9IGxvICsgKGhpIC0gbG8pICogcm5nLnJhbmRvbShzaXplPWxvLnNpemUpCiAgICAgICAgbHAgPSBmbG9hdChsb2dwb3N0KHgpKQogICAgICAgIGlmIGxwID4gYmVzdF9scDoKICAgICAgICAgICAgYmVzdF94LCBiZXN0X2xwID0geCwgbHAKICAgIHJldHVybiBiZXN0X3gsIGJlc3RfbHAK\"}\nDIR_STATE:[\"src/dgpipe/__init__.py\",\"src/dgpipe/cli.py\",\"src/dgpipe/inference.py\",\"src/dgpipe/io.py\",\"src/dgpipe/models.py\",\"src/dgpipe/protocols.py\",\"src/dgpipe/simulations.py\"]"
        }
      ],
      "role": "assistant"
    }
  ],
  "codeResults": []
}