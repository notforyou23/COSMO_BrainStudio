{
  "content": "FILE_EXPORT:{\"path\":\"src/dgpipe/io.py\",\"size\":6356,\"encoding\":\"base64\",\"sha256\":\"778062ad0ff00ff8c46c899982ea22a71f824d7f4150c98fe22f54b0984bd8e4\",\"content\":\"IiIiZGdwaXBlLmlvCgpSb2J1c3QsIHJlcHJvZHVjaWJsZSBJL08gaGVscGVycyBmb3IgY29uZmlncywgZGF0YXNldHMsIHJlc3VsdHMsIGFuZCBwcm92ZW5hbmNlLgpTdXBwb3J0cyBKU09OIC8gQ1NWIC8gTlBaIHdpdGggbGlnaHR3ZWlnaHQgc2NoZW1hIHZhbGlkYXRpb24gYW5kIGRldGVybWluaXN0aWMgc2VlZGluZy4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIE1hcHBpbmcsIE11dGFibGVNYXBwaW5nLCBTZXF1ZW5jZQppbXBvcnQgY3N2CmltcG9ydCBoYXNobGliCmltcG9ydCBqc29uCmltcG9ydCBvcwppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHJhbmRvbQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCgppbXBvcnQgbnVtcHkgYXMgbnAKZGVmIF9hdG9taWNfd3JpdGVfdGV4dChwYXRoOiBQYXRoLCB0ZXh0OiBzdHIsIGVuY29kaW5nOiBzdHIgPSAidXRmLTgiKSAtPiBOb25lOgogICAgcGF0aCA9IFBhdGgocGF0aCkKICAgIHBhdGgucGFyZW50Lm1rZGlyKHBhcmVudHM9VHJ1ZSwgZXhpc3Rfb2s9VHJ1ZSkKICAgIHRtcCA9IHBhdGgud2l0aF9zdWZmaXgocGF0aC5zdWZmaXggKyAiLnRtcCIpCiAgICB0bXAud3JpdGVfdGV4dCh0ZXh0LCBlbmNvZGluZz1lbmNvZGluZykKICAgIG9zLnJlcGxhY2UodG1wLCBwYXRoKQoKCmRlZiBfanNvbl9kdW1wc19kZXRlcm1pbmlzdGljKG9iajogQW55KSAtPiBzdHI6CiAgICByZXR1cm4ganNvbi5kdW1wcyhvYmosIHNvcnRfa2V5cz1UcnVlLCBpbmRlbnQ9MiwgZW5zdXJlX2FzY2lpPUZhbHNlKSArICJcbiIKCgpkZWYgbG9hZF9qc29uKHBhdGg6IHN0ciB8IFBhdGgpIC0+IEFueToKICAgIHdpdGggUGF0aChwYXRoKS5vcGVuKCJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoKICAgICAgICByZXR1cm4ganNvbi5sb2FkKGYpCgoKZGVmIHNhdmVfanNvbihwYXRoOiBzdHIgfCBQYXRoLCBvYmo6IEFueSkgLT4gTm9uZToKICAgIF9hdG9taWNfd3JpdGVfdGV4dChQYXRoKHBhdGgpLCBfanNvbl9kdW1wc19kZXRlcm1pbmlzdGljKG9iaikpCgoKZGVmIGxvYWRfY3N2X2RpY3RzKHBhdGg6IHN0ciB8IFBhdGgpIC0+IGxpc3RbZGljdFtzdHIsIHN0cl1dOgogICAgd2l0aCBQYXRoKHBhdGgpLm9wZW4oInIiLCBlbmNvZGluZz0idXRmLTgiLCBuZXdsaW5lPSIiKSBhcyBmOgogICAgICAgIHJldHVybiBsaXN0KGNzdi5EaWN0UmVhZGVyKGYpKQoKCmRlZiBzYXZlX2Nzdl9kaWN0cyhwYXRoOiBzdHIgfCBQYXRoLCByb3dzOiBTZXF1ZW5jZVtNYXBwaW5nW3N0ciwgQW55XV0pIC0+IE5vbmU6CiAgICBwYXRoID0gUGF0aChwYXRoKQogICAgcGF0aC5wYXJlbnQubWtkaXIocGFyZW50cz1UcnVlLCBleGlzdF9vaz1UcnVlKQogICAgcm93cyA9IGxpc3Qocm93cykKICAgIGZpZWxkbmFtZXMgPSBzb3J0ZWQoe2sgZm9yIHIgaW4gcm93cyBmb3IgayBpbiByLmtleXMoKX0pCiAgICB0bXAgPSBwYXRoLndpdGhfc3VmZml4KHBhdGguc3VmZml4ICsgIi50bXAiKQogICAgd2l0aCB0bXAub3BlbigidyIsIGVuY29kaW5nPSJ1dGYtOCIsIG5ld2xpbmU9IiIpIGFzIGY6CiAgICAgICAgdyA9IGNzdi5EaWN0V3JpdGVyKGYsIGZpZWxkbmFtZXM9ZmllbGRuYW1lcykKICAgICAgICB3LndyaXRlaGVhZGVyKCkKICAgICAgICBmb3IgciBpbiByb3dzOgogICAgICAgICAgICB3LndyaXRlcm93KHtrOiByLmdldChrLCAiIikgZm9yIGsgaW4gZmllbGRuYW1lc30pCiAgICBvcy5yZXBsYWNlKHRtcCwgcGF0aCkKCgpkZWYgc2F2ZV9ucHoocGF0aDogc3RyIHwgUGF0aCwgKiphcnJheXM6IEFueSkgLT4gTm9uZToKICAgIHBhdGggPSBQYXRoKHBhdGgpCiAgICBwYXRoLnBhcmVudC5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICB0bXAgPSBwYXRoLndpdGhfc3VmZml4KHBhdGguc3VmZml4ICsgIi50bXAiKQogICAgbnAuc2F2ZXpfY29tcHJlc3NlZCh0bXAsICoqYXJyYXlzKQogICAgb3MucmVwbGFjZSh0bXAsIHBhdGgpCgoKZGVmIGxvYWRfbnB6KHBhdGg6IHN0ciB8IFBhdGgpIC0+IGRpY3Rbc3RyLCBucC5uZGFycmF5XToKICAgIHdpdGggbnAubG9hZChQYXRoKHBhdGgpLCBhbGxvd19waWNrbGU9RmFsc2UpIGFzIHo6CiAgICAgICAgcmV0dXJuIHtrOiB6W2tdIGZvciBrIGluIHouZmlsZXN9CkBkYXRhY2xhc3MoZnJvemVuPVRydWUpCmNsYXNzIFNjaGVtYToKICAgICIiIlZlcnkgc21hbGwgc2NoZW1hOiBtYXBwaW5nIGtleSAtPiB0eXBlIC8gbmVzdGVkIFNjaGVtYSAvICh0eXBlLCAuLi4pIC8gbGlzdFtTY2hlbWFdLiIiIgoKICAgIHNwZWM6IE1hcHBpbmdbc3RyLCBBbnldCgogICAgZGVmIHZhbGlkYXRlKHNlbGYsIG9iajogQW55LCAqLCB3aGVyZTogc3RyID0gInJvb3QiKSAtPiBOb25lOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9iaiwgTWFwcGluZyk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmInt3aGVyZX06IGV4cGVjdGVkIG1hcHBpbmcsIGdvdCB7dHlwZShvYmopLl9fbmFtZV9ffSIpCiAgICAgICAgZm9yIGtleSwgcnVsZSBpbiBzZWxmLnNwZWMuaXRlbXMoKToKICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBvYmo6CiAgICAgICAgICAgICAgICByYWlzZSBLZXlFcnJvcihmInt3aGVyZX06IG1pc3NpbmcgcmVxdWlyZWQga2V5ICd7a2V5fSciKQogICAgICAgICAgICBfdmFsaWRhdGVfcnVsZShvYmpba2V5XSwgcnVsZSwgd2hlcmU9ZiJ7d2hlcmV9LntrZXl9IikKCgpkZWYgX3ZhbGlkYXRlX3J1bGUodmFsOiBBbnksIHJ1bGU6IEFueSwgKiwgd2hlcmU6IHN0cikgLT4gTm9uZToKICAgIGlmIGlzaW5zdGFuY2UocnVsZSwgU2NoZW1hKToKICAgICAgICBydWxlLnZhbGlkYXRlKHZhbCwgd2hlcmU9d2hlcmUpCiAgICAgICAgcmV0dXJuCiAgICBpZiBpc2luc3RhbmNlKHJ1bGUsIGxpc3QpOgogICAgICAgIGlmIGxlbihydWxlKSAhPSAxIG9yIG5vdCBpc2luc3RhbmNlKHJ1bGVbMF0sICh0eXBlLCBTY2hlbWEsIHR1cGxlKSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmInt3aGVyZX06IGludmFsaWQgbGlzdCBydWxlIikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh2YWwsIFNlcXVlbmNlKSBvciBpc2luc3RhbmNlKHZhbCwgKHN0ciwgYnl0ZXMsIGJ5dGVhcnJheSkpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZiJ7d2hlcmV9OiBleHBlY3RlZCBzZXF1ZW5jZSwgZ290IHt0eXBlKHZhbCkuX19uYW1lX199IikKICAgICAgICBmb3IgaSwgdiBpbiBlbnVtZXJhdGUodmFsKToKICAgICAgICAgICAgX3ZhbGlkYXRlX3J1bGUodiwgcnVsZVswXSwgd2hlcmU9ZiJ7d2hlcmV9W3tpfV0iKQogICAgICAgIHJldHVybgogICAgaWYgaXNpbnN0YW5jZShydWxlLCB0dXBsZSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBydWxlKToKICAgICAgICAgICAgZXhwID0gIiwiLmpvaW4odC5fX25hbWVfXyBmb3IgdCBpbiBydWxlKQogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZiJ7d2hlcmV9OiBleHBlY3RlZCBvbmUgb2YgKHtleHB9KSwgZ290IHt0eXBlKHZhbCkuX19uYW1lX199IikKICAgICAgICByZXR1cm4KICAgIGlmIGlzaW5zdGFuY2UocnVsZSwgdHlwZSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBydWxlKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKGYie3doZXJlfTogZXhwZWN0ZWQge3J1bGUuX19uYW1lX199LCBnb3Qge3R5cGUodmFsKS5fX25hbWVfX30iKQogICAgICAgIHJldHVybgogICAgcmFpc2UgVHlwZUVycm9yKGYie3doZXJlfTogaW52YWxpZCBzY2hlbWEgcnVsZSB7cnVsZSFyfSIpCgoKZGVmIGxvYWRfY29uZmlnKHBhdGg6IHN0ciB8IFBhdGgsIHNjaGVtYTogU2NoZW1hIHwgTm9uZSA9IE5vbmUpIC0+IGRpY3Rbc3RyLCBBbnldOgogICAgY2ZnID0gbG9hZF9qc29uKHBhdGgpCiAgICBpZiBzY2hlbWEgaXMgbm90IE5vbmU6CiAgICAgICAgc2NoZW1hLnZhbGlkYXRlKGNmZykKICAgIGlmIG5vdCBpc2luc3RhbmNlKGNmZywgZGljdCk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjb25maWc6IGV4cGVjdGVkIEpTT04gb2JqZWN0IGF0IHRvcC1sZXZlbCIpCiAgICByZXR1cm4gY2ZnCmRlZiBzdGFibGVfaW50X2hhc2gob2JqOiBBbnksICosIHNhbHQ6IHN0ciA9ICIiKSAtPiBpbnQ6CiAgICBwYXlsb2FkID0gX2pzb25fZHVtcHNfZGV0ZXJtaW5pc3RpYyh7InNhbHQiOiBzYWx0LCAib2JqIjogb2JqfSkuZW5jb2RlKCJ1dGYtOCIpCiAgICBoID0gaGFzaGxpYi5zaGEyNTYocGF5bG9hZCkuZGlnZXN0KCkKICAgIHJldHVybiBpbnQuZnJvbV9ieXRlcyhoWzo4XSwgImJpZyIsIHNpZ25lZD1GYWxzZSkKCgpkZWYgc2V0X2dsb2JhbF9zZWVkKHNlZWQ6IGludCkgLT4gTm9uZToKICAgICIiIlNlZWQgUHl0aG9uICsgTnVtUHkgZGV0ZXJtaW5pc3RpY2FsbHkgKGNhbGwgZWFybHkgaW4gdGhlIHBpcGVsaW5lKS4iIiIKICAgIHJhbmRvbS5zZWVkKGludChzZWVkKSAmIDB4RkZGRkZGRkYpCiAgICBucC5yYW5kb20uc2VlZChpbnQoc2VlZCkgJiAweEZGRkZGRkZGKQoKCmRlZiBzZWVkX2Zyb21fY29uZmlnKGNmZzogTWFwcGluZ1tzdHIsIEFueV0sICosIHNhbHQ6IHN0ciA9ICJkZ3BpcGUiKSAtPiBpbnQ6CiAgICAiIiJEZXJpdmUgYSBkZXRlcm1pbmlzdGljIDY0LWJpdCBzZWVkIGZyb20gYSBjb25maWcgbWFwcGluZy4iIiIKICAgIHJldHVybiBzdGFibGVfaW50X2hhc2goY2ZnLCBzYWx0PXNhbHQpCgoKZGVmIHByb3ZlbmFuY2UoY2ZnOiBNYXBwaW5nW3N0ciwgQW55XSwgKiwgc2VlZDogaW50IHwgTm9uZSA9IE5vbmUsIGV4dHJhOiBNYXBwaW5nW3N0ciwgQW55XSB8IE5vbmUgPSBOb25lKSAtPiBkaWN0W3N0ciwgQW55XToKICAgIHByb3Y6IE11dGFibGVNYXBwaW5nW3N0ciwgQW55XSA9IHsKICAgICAgICAidGltZV91bml4IjogdGltZS50aW1lKCksCiAgICAgICAgInB5dGhvbiI6IHN5cy52ZXJzaW9uLnNwbGl0KClbMF0sCiAgICAgICAgInBsYXRmb3JtIjogcGxhdGZvcm0ucGxhdGZvcm0oKSwKICAgICAgICAiY3dkIjogb3MuZ2V0Y3dkKCksCiAgICB9CiAgICBpZiBzZWVkIGlzIG5vdCBOb25lOgogICAgICAgIHByb3ZbInNlZWQiXSA9IGludChzZWVkKQogICAgcHJvdlsiY29uZmlnX2hhc2g2NCJdID0gc3RhYmxlX2ludF9oYXNoKGNmZywgc2FsdD0iY29uZmlnIikKICAgIGlmIGV4dHJhOgogICAgICAgIHByb3ZbImV4dHJhIl0gPSBkaWN0KGV4dHJhKQogICAgcmV0dXJuIGRpY3QocHJvdikKCgpkZWYgd3JpdGVfYnVuZGxlKG91dGRpcjogc3RyIHwgUGF0aCwgKiwgY2ZnOiBNYXBwaW5nW3N0ciwgQW55XSwgcmVzdWx0czogTWFwcGluZ1tzdHIsIEFueV0gfCBOb25lID0gTm9uZSwKICAgICAgICAgICAgICAgICBhcnJheXM6IE1hcHBpbmdbc3RyLCBBbnldIHwgTm9uZSA9IE5vbmUsIHNlZWQ6IGludCB8IE5vbmUgPSBOb25lLAogICAgICAgICAgICAgICAgIGNmZ19zY2hlbWE6IFNjaGVtYSB8IE5vbmUgPSBOb25lLCBwcm92X2V4dHJhOiBNYXBwaW5nW3N0ciwgQW55XSB8IE5vbmUgPSBOb25lKSAtPiBkaWN0W3N0ciwgc3RyXToKICAgICIiIldyaXRlIGEgbWluaW1hbCwgcmVwcm9kdWNpYmxlIHJlc3VsdCBidW5kbGU6IGNvbmZpZy5qc29uLCBwcm92ZW5hbmNlLmpzb24sIHJlc3VsdHMuanNvbiwgYXJyYXlzLm5wei4iIiIKICAgIGlmIGNmZ19zY2hlbWEgaXMgbm90IE5vbmU6CiAgICAgICAgY2ZnX3NjaGVtYS52YWxpZGF0ZShjZmcpCiAgICBvdXQgPSBQYXRoKG91dGRpcikKICAgIG91dC5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICBzYXZlX2pzb24ob3V0IC8gImNvbmZpZy5qc29uIiwgZGljdChjZmcpKQogICAgc2F2ZV9qc29uKG91dCAvICJwcm92ZW5hbmNlLmpzb24iLCBwcm92ZW5hbmNlKGNmZywgc2VlZD1zZWVkLCBleHRyYT1wcm92X2V4dHJhKSkKICAgIGlmIHJlc3VsdHMgaXMgbm90IE5vbmU6CiAgICAgICAgc2F2ZV9qc29uKG91dCAvICJyZXN1bHRzLmpzb24iLCByZXN1bHRzKQogICAgaWYgYXJyYXlzOgogICAgICAgIHNhdmVfbnB6KG91dCAvICJhcnJheXMubnB6IiwgKipkaWN0KGFycmF5cykpCiAgICByZXR1cm4gewogICAgICAgICJjb25maWciOiBzdHIob3V0IC8gImNvbmZpZy5qc29uIiksCiAgICAgICAgInByb3ZlbmFuY2UiOiBzdHIob3V0IC8gInByb3ZlbmFuY2UuanNvbiIpLAogICAgICAgICJyZXN1bHRzIjogc3RyKG91dCAvICJyZXN1bHRzLmpzb24iKSBpZiByZXN1bHRzIGlzIG5vdCBOb25lIGVsc2UgIiIsCiAgICAgICAgImFycmF5cyI6IHN0cihvdXQgLyAiYXJyYXlzLm5weiIpIGlmIGFycmF5cyBlbHNlICIiLAogICAgfQo=\"}\nDIR_STATE:[\"src/dgpipe/__init__.py\",\"src/dgpipe/cli.py\",\"src/dgpipe/inference.py\",\"src/dgpipe/io.py\",\"src/dgpipe/models.py\",\"src/dgpipe/protocols.py\",\"src/dgpipe/simulations.py\"]",
  "reasoning": "",
  "responseId": "resp_03978301114c449f006949b66d8bcc8197bc2ce1de6fc60e7e",
  "model": "gpt-5.2-2025-12-11",
  "usage": {
    "input_tokens": 6695,
    "input_tokens_details": {
      "cached_tokens": 0
    },
    "output_tokens": 5655,
    "output_tokens_details": {
      "reasoning_tokens": 34
    },
    "total_tokens": 12350
  },
  "hadError": false,
  "errorType": null,
  "webSearchSources": [],
  "citations": [],
  "output": [
    {
      "id": "rs_03978301114c449f006949b66e53648197a1f25cb0876724f1",
      "type": "reasoning",
      "summary": []
    },
    {
      "id": "ci_03978301114c449f006949b66f0918819785e60d96823d005f",
      "type": "code_interpreter_call",
      "status": "completed",
      "code": "from pathlib import Path\nimport base64, json, hashlib, gzip\n\ntarget_path = Path('/mnt/data').joinpath('src/dgpipe/io.py')\nassert target_path.is_file(), 'Expected src/dgpipe/io.py to exist before export'\ndata = target_path.read_bytes()\npayload = {\n  'path': 'src/dgpipe/io.py',\n  'size': len(data),\n  'encoding': 'base64',\n  'sha256': hashlib.sha256(data).hexdigest(),\n  'content': None\n}\nif len(data) > 20000:\n    compressed = gzip.compress(data)\n    payload['encoding'] = 'gzip+base64'\n    payload['content'] = base64.b64encode(compressed).decode('ascii')\nelse:\n    payload['content'] = base64.b64encode(data).decode('ascii')\nprint('FILE_EXPORT:' + json.dumps(payload, separators=(',', ':')))\nprint('DIR_STATE:' + json.dumps(sorted(str(p.relative_to(Path(\"/mnt/data\"))) for p in target_path.parent.glob('*') if p.is_file())))",
      "container_id": "cntr_6949aff88f24819097f165c497ce475e074f2320f5d510c4",
      "outputs": [
        {
          "type": "logs",
          "logs": "FILE_EXPORT:{\"path\":\"src/dgpipe/io.py\",\"size\":6356,\"encoding\":\"base64\",\"sha256\":\"778062ad0ff00ff8c46c899982ea22a71f824d7f4150c98fe22f54b0984bd8e4\",\"content\":\"IiIiZGdwaXBlLmlvCgpSb2J1c3QsIHJlcHJvZHVjaWJsZSBJL08gaGVscGVycyBmb3IgY29uZmlncywgZGF0YXNldHMsIHJlc3VsdHMsIGFuZCBwcm92ZW5hbmNlLgpTdXBwb3J0cyBKU09OIC8gQ1NWIC8gTlBaIHdpdGggbGlnaHR3ZWlnaHQgc2NoZW1hIHZhbGlkYXRpb24gYW5kIGRldGVybWluaXN0aWMgc2VlZGluZy4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIE1hcHBpbmcsIE11dGFibGVNYXBwaW5nLCBTZXF1ZW5jZQppbXBvcnQgY3N2CmltcG9ydCBoYXNobGliCmltcG9ydCBqc29uCmltcG9ydCBvcwppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHJhbmRvbQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCgppbXBvcnQgbnVtcHkgYXMgbnAKZGVmIF9hdG9taWNfd3JpdGVfdGV4dChwYXRoOiBQYXRoLCB0ZXh0OiBzdHIsIGVuY29kaW5nOiBzdHIgPSAidXRmLTgiKSAtPiBOb25lOgogICAgcGF0aCA9IFBhdGgocGF0aCkKICAgIHBhdGgucGFyZW50Lm1rZGlyKHBhcmVudHM9VHJ1ZSwgZXhpc3Rfb2s9VHJ1ZSkKICAgIHRtcCA9IHBhdGgud2l0aF9zdWZmaXgocGF0aC5zdWZmaXggKyAiLnRtcCIpCiAgICB0bXAud3JpdGVfdGV4dCh0ZXh0LCBlbmNvZGluZz1lbmNvZGluZykKICAgIG9zLnJlcGxhY2UodG1wLCBwYXRoKQoKCmRlZiBfanNvbl9kdW1wc19kZXRlcm1pbmlzdGljKG9iajogQW55KSAtPiBzdHI6CiAgICByZXR1cm4ganNvbi5kdW1wcyhvYmosIHNvcnRfa2V5cz1UcnVlLCBpbmRlbnQ9MiwgZW5zdXJlX2FzY2lpPUZhbHNlKSArICJcbiIKCgpkZWYgbG9hZF9qc29uKHBhdGg6IHN0ciB8IFBhdGgpIC0+IEFueToKICAgIHdpdGggUGF0aChwYXRoKS5vcGVuKCJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoKICAgICAgICByZXR1cm4ganNvbi5sb2FkKGYpCgoKZGVmIHNhdmVfanNvbihwYXRoOiBzdHIgfCBQYXRoLCBvYmo6IEFueSkgLT4gTm9uZToKICAgIF9hdG9taWNfd3JpdGVfdGV4dChQYXRoKHBhdGgpLCBfanNvbl9kdW1wc19kZXRlcm1pbmlzdGljKG9iaikpCgoKZGVmIGxvYWRfY3N2X2RpY3RzKHBhdGg6IHN0ciB8IFBhdGgpIC0+IGxpc3RbZGljdFtzdHIsIHN0cl1dOgogICAgd2l0aCBQYXRoKHBhdGgpLm9wZW4oInIiLCBlbmNvZGluZz0idXRmLTgiLCBuZXdsaW5lPSIiKSBhcyBmOgogICAgICAgIHJldHVybiBsaXN0KGNzdi5EaWN0UmVhZGVyKGYpKQoKCmRlZiBzYXZlX2Nzdl9kaWN0cyhwYXRoOiBzdHIgfCBQYXRoLCByb3dzOiBTZXF1ZW5jZVtNYXBwaW5nW3N0ciwgQW55XV0pIC0+IE5vbmU6CiAgICBwYXRoID0gUGF0aChwYXRoKQogICAgcGF0aC5wYXJlbnQubWtkaXIocGFyZW50cz1UcnVlLCBleGlzdF9vaz1UcnVlKQogICAgcm93cyA9IGxpc3Qocm93cykKICAgIGZpZWxkbmFtZXMgPSBzb3J0ZWQoe2sgZm9yIHIgaW4gcm93cyBmb3IgayBpbiByLmtleXMoKX0pCiAgICB0bXAgPSBwYXRoLndpdGhfc3VmZml4KHBhdGguc3VmZml4ICsgIi50bXAiKQogICAgd2l0aCB0bXAub3BlbigidyIsIGVuY29kaW5nPSJ1dGYtOCIsIG5ld2xpbmU9IiIpIGFzIGY6CiAgICAgICAgdyA9IGNzdi5EaWN0V3JpdGVyKGYsIGZpZWxkbmFtZXM9ZmllbGRuYW1lcykKICAgICAgICB3LndyaXRlaGVhZGVyKCkKICAgICAgICBmb3IgciBpbiByb3dzOgogICAgICAgICAgICB3LndyaXRlcm93KHtrOiByLmdldChrLCAiIikgZm9yIGsgaW4gZmllbGRuYW1lc30pCiAgICBvcy5yZXBsYWNlKHRtcCwgcGF0aCkKCgpkZWYgc2F2ZV9ucHoocGF0aDogc3RyIHwgUGF0aCwgKiphcnJheXM6IEFueSkgLT4gTm9uZToKICAgIHBhdGggPSBQYXRoKHBhdGgpCiAgICBwYXRoLnBhcmVudC5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICB0bXAgPSBwYXRoLndpdGhfc3VmZml4KHBhdGguc3VmZml4ICsgIi50bXAiKQogICAgbnAuc2F2ZXpfY29tcHJlc3NlZCh0bXAsICoqYXJyYXlzKQogICAgb3MucmVwbGFjZSh0bXAsIHBhdGgpCgoKZGVmIGxvYWRfbnB6KHBhdGg6IHN0ciB8IFBhdGgpIC0+IGRpY3Rbc3RyLCBucC5uZGFycmF5XToKICAgIHdpdGggbnAubG9hZChQYXRoKHBhdGgpLCBhbGxvd19waWNrbGU9RmFsc2UpIGFzIHo6CiAgICAgICAgcmV0dXJuIHtrOiB6W2tdIGZvciBrIGluIHouZmlsZXN9CkBkYXRhY2xhc3MoZnJvemVuPVRydWUpCmNsYXNzIFNjaGVtYToKICAgICIiIlZlcnkgc21hbGwgc2NoZW1hOiBtYXBwaW5nIGtleSAtPiB0eXBlIC8gbmVzdGVkIFNjaGVtYSAvICh0eXBlLCAuLi4pIC8gbGlzdFtTY2hlbWFdLiIiIgoKICAgIHNwZWM6IE1hcHBpbmdbc3RyLCBBbnldCgogICAgZGVmIHZhbGlkYXRlKHNlbGYsIG9iajogQW55LCAqLCB3aGVyZTogc3RyID0gInJvb3QiKSAtPiBOb25lOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9iaiwgTWFwcGluZyk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmInt3aGVyZX06IGV4cGVjdGVkIG1hcHBpbmcsIGdvdCB7dHlwZShvYmopLl9fbmFtZV9ffSIpCiAgICAgICAgZm9yIGtleSwgcnVsZSBpbiBzZWxmLnNwZWMuaXRlbXMoKToKICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBvYmo6CiAgICAgICAgICAgICAgICByYWlzZSBLZXlFcnJvcihmInt3aGVyZX06IG1pc3NpbmcgcmVxdWlyZWQga2V5ICd7a2V5fSciKQogICAgICAgICAgICBfdmFsaWRhdGVfcnVsZShvYmpba2V5XSwgcnVsZSwgd2hlcmU9ZiJ7d2hlcmV9LntrZXl9IikKCgpkZWYgX3ZhbGlkYXRlX3J1bGUodmFsOiBBbnksIHJ1bGU6IEFueSwgKiwgd2hlcmU6IHN0cikgLT4gTm9uZToKICAgIGlmIGlzaW5zdGFuY2UocnVsZSwgU2NoZW1hKToKICAgICAgICBydWxlLnZhbGlkYXRlKHZhbCwgd2hlcmU9d2hlcmUpCiAgICAgICAgcmV0dXJuCiAgICBpZiBpc2luc3RhbmNlKHJ1bGUsIGxpc3QpOgogICAgICAgIGlmIGxlbihydWxlKSAhPSAxIG9yIG5vdCBpc2luc3RhbmNlKHJ1bGVbMF0sICh0eXBlLCBTY2hlbWEsIHR1cGxlKSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmInt3aGVyZX06IGludmFsaWQgbGlzdCBydWxlIikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh2YWwsIFNlcXVlbmNlKSBvciBpc2luc3RhbmNlKHZhbCwgKHN0ciwgYnl0ZXMsIGJ5dGVhcnJheSkpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZiJ7d2hlcmV9OiBleHBlY3RlZCBzZXF1ZW5jZSwgZ290IHt0eXBlKHZhbCkuX19uYW1lX199IikKICAgICAgICBmb3IgaSwgdiBpbiBlbnVtZXJhdGUodmFsKToKICAgICAgICAgICAgX3ZhbGlkYXRlX3J1bGUodiwgcnVsZVswXSwgd2hlcmU9ZiJ7d2hlcmV9W3tpfV0iKQogICAgICAgIHJldHVybgogICAgaWYgaXNpbnN0YW5jZShydWxlLCB0dXBsZSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBydWxlKToKICAgICAgICAgICAgZXhwID0gIiwiLmpvaW4odC5fX25hbWVfXyBmb3IgdCBpbiBydWxlKQogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZiJ7d2hlcmV9OiBleHBlY3RlZCBvbmUgb2YgKHtleHB9KSwgZ290IHt0eXBlKHZhbCkuX19uYW1lX199IikKICAgICAgICByZXR1cm4KICAgIGlmIGlzaW5zdGFuY2UocnVsZSwgdHlwZSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBydWxlKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKGYie3doZXJlfTogZXhwZWN0ZWQge3J1bGUuX19uYW1lX199LCBnb3Qge3R5cGUodmFsKS5fX25hbWVfX30iKQogICAgICAgIHJldHVybgogICAgcmFpc2UgVHlwZUVycm9yKGYie3doZXJlfTogaW52YWxpZCBzY2hlbWEgcnVsZSB7cnVsZSFyfSIpCgoKZGVmIGxvYWRfY29uZmlnKHBhdGg6IHN0ciB8IFBhdGgsIHNjaGVtYTogU2NoZW1hIHwgTm9uZSA9IE5vbmUpIC0+IGRpY3Rbc3RyLCBBbnldOgogICAgY2ZnID0gbG9hZF9qc29uKHBhdGgpCiAgICBpZiBzY2hlbWEgaXMgbm90IE5vbmU6CiAgICAgICAgc2NoZW1hLnZhbGlkYXRlKGNmZykKICAgIGlmIG5vdCBpc2luc3RhbmNlKGNmZywgZGljdCk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjb25maWc6IGV4cGVjdGVkIEpTT04gb2JqZWN0IGF0IHRvcC1sZXZlbCIpCiAgICByZXR1cm4gY2ZnCmRlZiBzdGFibGVfaW50X2hhc2gob2JqOiBBbnksICosIHNhbHQ6IHN0ciA9ICIiKSAtPiBpbnQ6CiAgICBwYXlsb2FkID0gX2pzb25fZHVtcHNfZGV0ZXJtaW5pc3RpYyh7InNhbHQiOiBzYWx0LCAib2JqIjogb2JqfSkuZW5jb2RlKCJ1dGYtOCIpCiAgICBoID0gaGFzaGxpYi5zaGEyNTYocGF5bG9hZCkuZGlnZXN0KCkKICAgIHJldHVybiBpbnQuZnJvbV9ieXRlcyhoWzo4XSwgImJpZyIsIHNpZ25lZD1GYWxzZSkKCgpkZWYgc2V0X2dsb2JhbF9zZWVkKHNlZWQ6IGludCkgLT4gTm9uZToKICAgICIiIlNlZWQgUHl0aG9uICsgTnVtUHkgZGV0ZXJtaW5pc3RpY2FsbHkgKGNhbGwgZWFybHkgaW4gdGhlIHBpcGVsaW5lKS4iIiIKICAgIHJhbmRvbS5zZWVkKGludChzZWVkKSAmIDB4RkZGRkZGRkYpCiAgICBucC5yYW5kb20uc2VlZChpbnQoc2VlZCkgJiAweEZGRkZGRkZGKQoKCmRlZiBzZWVkX2Zyb21fY29uZmlnKGNmZzogTWFwcGluZ1tzdHIsIEFueV0sICosIHNhbHQ6IHN0ciA9ICJkZ3BpcGUiKSAtPiBpbnQ6CiAgICAiIiJEZXJpdmUgYSBkZXRlcm1pbmlzdGljIDY0LWJpdCBzZWVkIGZyb20gYSBjb25maWcgbWFwcGluZy4iIiIKICAgIHJldHVybiBzdGFibGVfaW50X2hhc2goY2ZnLCBzYWx0PXNhbHQpCgoKZGVmIHByb3ZlbmFuY2UoY2ZnOiBNYXBwaW5nW3N0ciwgQW55XSwgKiwgc2VlZDogaW50IHwgTm9uZSA9IE5vbmUsIGV4dHJhOiBNYXBwaW5nW3N0ciwgQW55XSB8IE5vbmUgPSBOb25lKSAtPiBkaWN0W3N0ciwgQW55XToKICAgIHByb3Y6IE11dGFibGVNYXBwaW5nW3N0ciwgQW55XSA9IHsKICAgICAgICAidGltZV91bml4IjogdGltZS50aW1lKCksCiAgICAgICAgInB5dGhvbiI6IHN5cy52ZXJzaW9uLnNwbGl0KClbMF0sCiAgICAgICAgInBsYXRmb3JtIjogcGxhdGZvcm0ucGxhdGZvcm0oKSwKICAgICAgICAiY3dkIjogb3MuZ2V0Y3dkKCksCiAgICB9CiAgICBpZiBzZWVkIGlzIG5vdCBOb25lOgogICAgICAgIHByb3ZbInNlZWQiXSA9IGludChzZWVkKQogICAgcHJvdlsiY29uZmlnX2hhc2g2NCJdID0gc3RhYmxlX2ludF9oYXNoKGNmZywgc2FsdD0iY29uZmlnIikKICAgIGlmIGV4dHJhOgogICAgICAgIHByb3ZbImV4dHJhIl0gPSBkaWN0KGV4dHJhKQogICAgcmV0dXJuIGRpY3QocHJvdikKCgpkZWYgd3JpdGVfYnVuZGxlKG91dGRpcjogc3RyIHwgUGF0aCwgKiwgY2ZnOiBNYXBwaW5nW3N0ciwgQW55XSwgcmVzdWx0czogTWFwcGluZ1tzdHIsIEFueV0gfCBOb25lID0gTm9uZSwKICAgICAgICAgICAgICAgICBhcnJheXM6IE1hcHBpbmdbc3RyLCBBbnldIHwgTm9uZSA9IE5vbmUsIHNlZWQ6IGludCB8IE5vbmUgPSBOb25lLAogICAgICAgICAgICAgICAgIGNmZ19zY2hlbWE6IFNjaGVtYSB8IE5vbmUgPSBOb25lLCBwcm92X2V4dHJhOiBNYXBwaW5nW3N0ciwgQW55XSB8IE5vbmUgPSBOb25lKSAtPiBkaWN0W3N0ciwgc3RyXToKICAgICIiIldyaXRlIGEgbWluaW1hbCwgcmVwcm9kdWNpYmxlIHJlc3VsdCBidW5kbGU6IGNvbmZpZy5qc29uLCBwcm92ZW5hbmNlLmpzb24sIHJlc3VsdHMuanNvbiwgYXJyYXlzLm5wei4iIiIKICAgIGlmIGNmZ19zY2hlbWEgaXMgbm90IE5vbmU6CiAgICAgICAgY2ZnX3NjaGVtYS52YWxpZGF0ZShjZmcpCiAgICBvdXQgPSBQYXRoKG91dGRpcikKICAgIG91dC5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICBzYXZlX2pzb24ob3V0IC8gImNvbmZpZy5qc29uIiwgZGljdChjZmcpKQogICAgc2F2ZV9qc29uKG91dCAvICJwcm92ZW5hbmNlLmpzb24iLCBwcm92ZW5hbmNlKGNmZywgc2VlZD1zZWVkLCBleHRyYT1wcm92X2V4dHJhKSkKICAgIGlmIHJlc3VsdHMgaXMgbm90IE5vbmU6CiAgICAgICAgc2F2ZV9qc29uKG91dCAvICJyZXN1bHRzLmpzb24iLCByZXN1bHRzKQogICAgaWYgYXJyYXlzOgogICAgICAgIHNhdmVfbnB6KG91dCAvICJhcnJheXMubnB6IiwgKipkaWN0KGFycmF5cykpCiAgICByZXR1cm4gewogICAgICAgICJjb25maWciOiBzdHIob3V0IC8gImNvbmZpZy5qc29uIiksCiAgICAgICAgInByb3ZlbmFuY2UiOiBzdHIob3V0IC8gInByb3ZlbmFuY2UuanNvbiIpLAogICAgICAgICJyZXN1bHRzIjogc3RyKG91dCAvICJyZXN1bHRzLmpzb24iKSBpZiByZXN1bHRzIGlzIG5vdCBOb25lIGVsc2UgIiIsCiAgICAgICAgImFycmF5cyI6IHN0cihvdXQgLyAiYXJyYXlzLm5weiIpIGlmIGFycmF5cyBlbHNlICIiLAogICAgfQo=\"}\nDIR_STATE:[\"src/dgpipe/__init__.py\", \"src/dgpipe/cli.py\", \"src/dgpipe/inference.py\", \"src/dgpipe/io.py\", \"src/dgpipe/models.py\", \"src/dgpipe/protocols.py\", \"src/dgpipe/simulations.py\"]\n"
        }
      ]
    },
    {
      "id": "msg_03978301114c449f006949b6721d088197876c3d4916a8e3c7",
      "type": "message",
      "status": "completed",
      "content": [
        {
          "type": "output_text",
          "annotations": [],
          "logprobs": [],
          "text": "FILE_EXPORT:{\"path\":\"src/dgpipe/io.py\",\"size\":6356,\"encoding\":\"base64\",\"sha256\":\"778062ad0ff00ff8c46c899982ea22a71f824d7f4150c98fe22f54b0984bd8e4\",\"content\":\"IiIiZGdwaXBlLmlvCgpSb2J1c3QsIHJlcHJvZHVjaWJsZSBJL08gaGVscGVycyBmb3IgY29uZmlncywgZGF0YXNldHMsIHJlc3VsdHMsIGFuZCBwcm92ZW5hbmNlLgpTdXBwb3J0cyBKU09OIC8gQ1NWIC8gTlBaIHdpdGggbGlnaHR3ZWlnaHQgc2NoZW1hIHZhbGlkYXRpb24gYW5kIGRldGVybWluaXN0aWMgc2VlZGluZy4KIiIiCgpmcm9tIF9fZnV0dXJlX18gaW1wb3J0IGFubm90YXRpb25zCgpmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIE1hcHBpbmcsIE11dGFibGVNYXBwaW5nLCBTZXF1ZW5jZQppbXBvcnQgY3N2CmltcG9ydCBoYXNobGliCmltcG9ydCBqc29uCmltcG9ydCBvcwppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHJhbmRvbQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCgppbXBvcnQgbnVtcHkgYXMgbnAKZGVmIF9hdG9taWNfd3JpdGVfdGV4dChwYXRoOiBQYXRoLCB0ZXh0OiBzdHIsIGVuY29kaW5nOiBzdHIgPSAidXRmLTgiKSAtPiBOb25lOgogICAgcGF0aCA9IFBhdGgocGF0aCkKICAgIHBhdGgucGFyZW50Lm1rZGlyKHBhcmVudHM9VHJ1ZSwgZXhpc3Rfb2s9VHJ1ZSkKICAgIHRtcCA9IHBhdGgud2l0aF9zdWZmaXgocGF0aC5zdWZmaXggKyAiLnRtcCIpCiAgICB0bXAud3JpdGVfdGV4dCh0ZXh0LCBlbmNvZGluZz1lbmNvZGluZykKICAgIG9zLnJlcGxhY2UodG1wLCBwYXRoKQoKCmRlZiBfanNvbl9kdW1wc19kZXRlcm1pbmlzdGljKG9iajogQW55KSAtPiBzdHI6CiAgICByZXR1cm4ganNvbi5kdW1wcyhvYmosIHNvcnRfa2V5cz1UcnVlLCBpbmRlbnQ9MiwgZW5zdXJlX2FzY2lpPUZhbHNlKSArICJcbiIKCgpkZWYgbG9hZF9qc29uKHBhdGg6IHN0ciB8IFBhdGgpIC0+IEFueToKICAgIHdpdGggUGF0aChwYXRoKS5vcGVuKCJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoKICAgICAgICByZXR1cm4ganNvbi5sb2FkKGYpCgoKZGVmIHNhdmVfanNvbihwYXRoOiBzdHIgfCBQYXRoLCBvYmo6IEFueSkgLT4gTm9uZToKICAgIF9hdG9taWNfd3JpdGVfdGV4dChQYXRoKHBhdGgpLCBfanNvbl9kdW1wc19kZXRlcm1pbmlzdGljKG9iaikpCgoKZGVmIGxvYWRfY3N2X2RpY3RzKHBhdGg6IHN0ciB8IFBhdGgpIC0+IGxpc3RbZGljdFtzdHIsIHN0cl1dOgogICAgd2l0aCBQYXRoKHBhdGgpLm9wZW4oInIiLCBlbmNvZGluZz0idXRmLTgiLCBuZXdsaW5lPSIiKSBhcyBmOgogICAgICAgIHJldHVybiBsaXN0KGNzdi5EaWN0UmVhZGVyKGYpKQoKCmRlZiBzYXZlX2Nzdl9kaWN0cyhwYXRoOiBzdHIgfCBQYXRoLCByb3dzOiBTZXF1ZW5jZVtNYXBwaW5nW3N0ciwgQW55XV0pIC0+IE5vbmU6CiAgICBwYXRoID0gUGF0aChwYXRoKQogICAgcGF0aC5wYXJlbnQubWtkaXIocGFyZW50cz1UcnVlLCBleGlzdF9vaz1UcnVlKQogICAgcm93cyA9IGxpc3Qocm93cykKICAgIGZpZWxkbmFtZXMgPSBzb3J0ZWQoe2sgZm9yIHIgaW4gcm93cyBmb3IgayBpbiByLmtleXMoKX0pCiAgICB0bXAgPSBwYXRoLndpdGhfc3VmZml4KHBhdGguc3VmZml4ICsgIi50bXAiKQogICAgd2l0aCB0bXAub3BlbigidyIsIGVuY29kaW5nPSJ1dGYtOCIsIG5ld2xpbmU9IiIpIGFzIGY6CiAgICAgICAgdyA9IGNzdi5EaWN0V3JpdGVyKGYsIGZpZWxkbmFtZXM9ZmllbGRuYW1lcykKICAgICAgICB3LndyaXRlaGVhZGVyKCkKICAgICAgICBmb3IgciBpbiByb3dzOgogICAgICAgICAgICB3LndyaXRlcm93KHtrOiByLmdldChrLCAiIikgZm9yIGsgaW4gZmllbGRuYW1lc30pCiAgICBvcy5yZXBsYWNlKHRtcCwgcGF0aCkKCgpkZWYgc2F2ZV9ucHoocGF0aDogc3RyIHwgUGF0aCwgKiphcnJheXM6IEFueSkgLT4gTm9uZToKICAgIHBhdGggPSBQYXRoKHBhdGgpCiAgICBwYXRoLnBhcmVudC5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICB0bXAgPSBwYXRoLndpdGhfc3VmZml4KHBhdGguc3VmZml4ICsgIi50bXAiKQogICAgbnAuc2F2ZXpfY29tcHJlc3NlZCh0bXAsICoqYXJyYXlzKQogICAgb3MucmVwbGFjZSh0bXAsIHBhdGgpCgoKZGVmIGxvYWRfbnB6KHBhdGg6IHN0ciB8IFBhdGgpIC0+IGRpY3Rbc3RyLCBucC5uZGFycmF5XToKICAgIHdpdGggbnAubG9hZChQYXRoKHBhdGgpLCBhbGxvd19waWNrbGU9RmFsc2UpIGFzIHo6CiAgICAgICAgcmV0dXJuIHtrOiB6W2tdIGZvciBrIGluIHouZmlsZXN9CkBkYXRhY2xhc3MoZnJvemVuPVRydWUpCmNsYXNzIFNjaGVtYToKICAgICIiIlZlcnkgc21hbGwgc2NoZW1hOiBtYXBwaW5nIGtleSAtPiB0eXBlIC8gbmVzdGVkIFNjaGVtYSAvICh0eXBlLCAuLi4pIC8gbGlzdFtTY2hlbWFdLiIiIgoKICAgIHNwZWM6IE1hcHBpbmdbc3RyLCBBbnldCgogICAgZGVmIHZhbGlkYXRlKHNlbGYsIG9iajogQW55LCAqLCB3aGVyZTogc3RyID0gInJvb3QiKSAtPiBOb25lOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9iaiwgTWFwcGluZyk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmInt3aGVyZX06IGV4cGVjdGVkIG1hcHBpbmcsIGdvdCB7dHlwZShvYmopLl9fbmFtZV9ffSIpCiAgICAgICAgZm9yIGtleSwgcnVsZSBpbiBzZWxmLnNwZWMuaXRlbXMoKToKICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBvYmo6CiAgICAgICAgICAgICAgICByYWlzZSBLZXlFcnJvcihmInt3aGVyZX06IG1pc3NpbmcgcmVxdWlyZWQga2V5ICd7a2V5fSciKQogICAgICAgICAgICBfdmFsaWRhdGVfcnVsZShvYmpba2V5XSwgcnVsZSwgd2hlcmU9ZiJ7d2hlcmV9LntrZXl9IikKCgpkZWYgX3ZhbGlkYXRlX3J1bGUodmFsOiBBbnksIHJ1bGU6IEFueSwgKiwgd2hlcmU6IHN0cikgLT4gTm9uZToKICAgIGlmIGlzaW5zdGFuY2UocnVsZSwgU2NoZW1hKToKICAgICAgICBydWxlLnZhbGlkYXRlKHZhbCwgd2hlcmU9d2hlcmUpCiAgICAgICAgcmV0dXJuCiAgICBpZiBpc2luc3RhbmNlKHJ1bGUsIGxpc3QpOgogICAgICAgIGlmIGxlbihydWxlKSAhPSAxIG9yIG5vdCBpc2luc3RhbmNlKHJ1bGVbMF0sICh0eXBlLCBTY2hlbWEsIHR1cGxlKSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmInt3aGVyZX06IGludmFsaWQgbGlzdCBydWxlIikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh2YWwsIFNlcXVlbmNlKSBvciBpc2luc3RhbmNlKHZhbCwgKHN0ciwgYnl0ZXMsIGJ5dGVhcnJheSkpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZiJ7d2hlcmV9OiBleHBlY3RlZCBzZXF1ZW5jZSwgZ290IHt0eXBlKHZhbCkuX19uYW1lX199IikKICAgICAgICBmb3IgaSwgdiBpbiBlbnVtZXJhdGUodmFsKToKICAgICAgICAgICAgX3ZhbGlkYXRlX3J1bGUodiwgcnVsZVswXSwgd2hlcmU9ZiJ7d2hlcmV9W3tpfV0iKQogICAgICAgIHJldHVybgogICAgaWYgaXNpbnN0YW5jZShydWxlLCB0dXBsZSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBydWxlKToKICAgICAgICAgICAgZXhwID0gIiwiLmpvaW4odC5fX25hbWVfXyBmb3IgdCBpbiBydWxlKQogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZiJ7d2hlcmV9OiBleHBlY3RlZCBvbmUgb2YgKHtleHB9KSwgZ290IHt0eXBlKHZhbCkuX19uYW1lX199IikKICAgICAgICByZXR1cm4KICAgIGlmIGlzaW5zdGFuY2UocnVsZSwgdHlwZSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBydWxlKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKGYie3doZXJlfTogZXhwZWN0ZWQge3J1bGUuX19uYW1lX199LCBnb3Qge3R5cGUodmFsKS5fX25hbWVfX30iKQogICAgICAgIHJldHVybgogICAgcmFpc2UgVHlwZUVycm9yKGYie3doZXJlfTogaW52YWxpZCBzY2hlbWEgcnVsZSB7cnVsZSFyfSIpCgoKZGVmIGxvYWRfY29uZmlnKHBhdGg6IHN0ciB8IFBhdGgsIHNjaGVtYTogU2NoZW1hIHwgTm9uZSA9IE5vbmUpIC0+IGRpY3Rbc3RyLCBBbnldOgogICAgY2ZnID0gbG9hZF9qc29uKHBhdGgpCiAgICBpZiBzY2hlbWEgaXMgbm90IE5vbmU6CiAgICAgICAgc2NoZW1hLnZhbGlkYXRlKGNmZykKICAgIGlmIG5vdCBpc2luc3RhbmNlKGNmZywgZGljdCk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjb25maWc6IGV4cGVjdGVkIEpTT04gb2JqZWN0IGF0IHRvcC1sZXZlbCIpCiAgICByZXR1cm4gY2ZnCmRlZiBzdGFibGVfaW50X2hhc2gob2JqOiBBbnksICosIHNhbHQ6IHN0ciA9ICIiKSAtPiBpbnQ6CiAgICBwYXlsb2FkID0gX2pzb25fZHVtcHNfZGV0ZXJtaW5pc3RpYyh7InNhbHQiOiBzYWx0LCAib2JqIjogb2JqfSkuZW5jb2RlKCJ1dGYtOCIpCiAgICBoID0gaGFzaGxpYi5zaGEyNTYocGF5bG9hZCkuZGlnZXN0KCkKICAgIHJldHVybiBpbnQuZnJvbV9ieXRlcyhoWzo4XSwgImJpZyIsIHNpZ25lZD1GYWxzZSkKCgpkZWYgc2V0X2dsb2JhbF9zZWVkKHNlZWQ6IGludCkgLT4gTm9uZToKICAgICIiIlNlZWQgUHl0aG9uICsgTnVtUHkgZGV0ZXJtaW5pc3RpY2FsbHkgKGNhbGwgZWFybHkgaW4gdGhlIHBpcGVsaW5lKS4iIiIKICAgIHJhbmRvbS5zZWVkKGludChzZWVkKSAmIDB4RkZGRkZGRkYpCiAgICBucC5yYW5kb20uc2VlZChpbnQoc2VlZCkgJiAweEZGRkZGRkZGKQoKCmRlZiBzZWVkX2Zyb21fY29uZmlnKGNmZzogTWFwcGluZ1tzdHIsIEFueV0sICosIHNhbHQ6IHN0ciA9ICJkZ3BpcGUiKSAtPiBpbnQ6CiAgICAiIiJEZXJpdmUgYSBkZXRlcm1pbmlzdGljIDY0LWJpdCBzZWVkIGZyb20gYSBjb25maWcgbWFwcGluZy4iIiIKICAgIHJldHVybiBzdGFibGVfaW50X2hhc2goY2ZnLCBzYWx0PXNhbHQpCgoKZGVmIHByb3ZlbmFuY2UoY2ZnOiBNYXBwaW5nW3N0ciwgQW55XSwgKiwgc2VlZDogaW50IHwgTm9uZSA9IE5vbmUsIGV4dHJhOiBNYXBwaW5nW3N0ciwgQW55XSB8IE5vbmUgPSBOb25lKSAtPiBkaWN0W3N0ciwgQW55XToKICAgIHByb3Y6IE11dGFibGVNYXBwaW5nW3N0ciwgQW55XSA9IHsKICAgICAgICAidGltZV91bml4IjogdGltZS50aW1lKCksCiAgICAgICAgInB5dGhvbiI6IHN5cy52ZXJzaW9uLnNwbGl0KClbMF0sCiAgICAgICAgInBsYXRmb3JtIjogcGxhdGZvcm0ucGxhdGZvcm0oKSwKICAgICAgICAiY3dkIjogb3MuZ2V0Y3dkKCksCiAgICB9CiAgICBpZiBzZWVkIGlzIG5vdCBOb25lOgogICAgICAgIHByb3ZbInNlZWQiXSA9IGludChzZWVkKQogICAgcHJvdlsiY29uZmlnX2hhc2g2NCJdID0gc3RhYmxlX2ludF9oYXNoKGNmZywgc2FsdD0iY29uZmlnIikKICAgIGlmIGV4dHJhOgogICAgICAgIHByb3ZbImV4dHJhIl0gPSBkaWN0KGV4dHJhKQogICAgcmV0dXJuIGRpY3QocHJvdikKCgpkZWYgd3JpdGVfYnVuZGxlKG91dGRpcjogc3RyIHwgUGF0aCwgKiwgY2ZnOiBNYXBwaW5nW3N0ciwgQW55XSwgcmVzdWx0czogTWFwcGluZ1tzdHIsIEFueV0gfCBOb25lID0gTm9uZSwKICAgICAgICAgICAgICAgICBhcnJheXM6IE1hcHBpbmdbc3RyLCBBbnldIHwgTm9uZSA9IE5vbmUsIHNlZWQ6IGludCB8IE5vbmUgPSBOb25lLAogICAgICAgICAgICAgICAgIGNmZ19zY2hlbWE6IFNjaGVtYSB8IE5vbmUgPSBOb25lLCBwcm92X2V4dHJhOiBNYXBwaW5nW3N0ciwgQW55XSB8IE5vbmUgPSBOb25lKSAtPiBkaWN0W3N0ciwgc3RyXToKICAgICIiIldyaXRlIGEgbWluaW1hbCwgcmVwcm9kdWNpYmxlIHJlc3VsdCBidW5kbGU6IGNvbmZpZy5qc29uLCBwcm92ZW5hbmNlLmpzb24sIHJlc3VsdHMuanNvbiwgYXJyYXlzLm5wei4iIiIKICAgIGlmIGNmZ19zY2hlbWEgaXMgbm90IE5vbmU6CiAgICAgICAgY2ZnX3NjaGVtYS52YWxpZGF0ZShjZmcpCiAgICBvdXQgPSBQYXRoKG91dGRpcikKICAgIG91dC5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICBzYXZlX2pzb24ob3V0IC8gImNvbmZpZy5qc29uIiwgZGljdChjZmcpKQogICAgc2F2ZV9qc29uKG91dCAvICJwcm92ZW5hbmNlLmpzb24iLCBwcm92ZW5hbmNlKGNmZywgc2VlZD1zZWVkLCBleHRyYT1wcm92X2V4dHJhKSkKICAgIGlmIHJlc3VsdHMgaXMgbm90IE5vbmU6CiAgICAgICAgc2F2ZV9qc29uKG91dCAvICJyZXN1bHRzLmpzb24iLCByZXN1bHRzKQogICAgaWYgYXJyYXlzOgogICAgICAgIHNhdmVfbnB6KG91dCAvICJhcnJheXMubnB6IiwgKipkaWN0KGFycmF5cykpCiAgICByZXR1cm4gewogICAgICAgICJjb25maWciOiBzdHIob3V0IC8gImNvbmZpZy5qc29uIiksCiAgICAgICAgInByb3ZlbmFuY2UiOiBzdHIob3V0IC8gInByb3ZlbmFuY2UuanNvbiIpLAogICAgICAgICJyZXN1bHRzIjogc3RyKG91dCAvICJyZXN1bHRzLmpzb24iKSBpZiByZXN1bHRzIGlzIG5vdCBOb25lIGVsc2UgIiIsCiAgICAgICAgImFycmF5cyI6IHN0cihvdXQgLyAiYXJyYXlzLm5weiIpIGlmIGFycmF5cyBlbHNlICIiLAogICAgfQo=\"}\nDIR_STATE:[\"src/dgpipe/__init__.py\",\"src/dgpipe/cli.py\",\"src/dgpipe/inference.py\",\"src/dgpipe/io.py\",\"src/dgpipe/models.py\",\"src/dgpipe/protocols.py\",\"src/dgpipe/simulations.py\"]"
        }
      ],
      "role": "assistant"
    }
  ],
  "codeResults": []
}